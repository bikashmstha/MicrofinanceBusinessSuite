/*
 * File: app/view/DayEndProcess.js
 *
 * This file was generated by Sencha Architect version 4.2.2.
 * http://www.sencha.com/products/architect/
 *
 * This file requires use of the Ext JS 4.1.x library, under independent license.
 * License of Sencha Architect does not include license for Ext JS 4.1.x. For more
 * details see http://www.sencha.com/license or contact license@sencha.com.
 *
 * This file will be auto-generated each and everytime you save your project.
 *
 * Do NOT hand edit this file.
 */

Ext.define('MyApp.view.DayEndProcess', {
    extend: 'Ext.panel.Panel',

    requires: [
        'Ext.form.field.Text',
        'Ext.tab.Panel',
        'Ext.tab.Tab',
        'Ext.grid.Panel',
        'Ext.grid.View',
        'Ext.grid.column.Column'
    ],

    frame: true,
    title: 'Day End Process',

    layout: {
        type: 'table',
        columns: 2
    },

    initComponent: function() {
        var me = this;

        Ext.applyIf(me, {
            items: [
                {
                    xtype: 'textfield',
                    itemId: 'txtDateBS',
                    margin: '0 0 0 200',
                    fieldLabel: 'Date(B.S.)',
                    fieldStyle: 'background-color:#D2D2D2;background-image:none;'
                },
                {
                    xtype: 'textfield',
                    itemId: 'txtDateAD',
                    margin: '',
                    fieldLabel: '(A.D.)',
                    labelWidth: 50,
                    fieldStyle: 'background-color:#D2D2D2;background-image:none;'
                },
                {
                    xtype: 'container',
                    colspan: 2,
                    height: 35,
                    margin: '10 0 0 0 ',
                    padding: 5,
                    layout: {
                        type: 'hbox',
                        align: 'stretch',
                        pack: 'center'
                    },
                    items: [
                        {
                            xtype: 'button',
                            height: 26,
                            itemId: 'btnABBSAdjustment',
                            text: 'ABBS Adjustment',
                            listeners: {
                                click: {
                                    fn: me.onBtnABBSAdjustmentClick,
                                    scope: me
                                }
                            }
                        },
                        {
                            xtype: 'button',
                            margins: '0 0 0 300',
                            height: 26,
                            itemId: 'btnCloseBookForTheDay',
                            text: 'Close Book For The Day',
                            listeners: {
                                click: {
                                    fn: me.onBtnCloseBookForTheDayClick,
                                    scope: me
                                }
                            }
                        }
                    ]
                },
                {
                    xtype: 'tabpanel',
                    colspan: 2,
                    frame: true,
                    margin: '10 0 0 0 ',
                    width: 1250,
                    activeTab: 0,
                    items: [
                        {
                            xtype: 'panel',
                            frame: true,
                            title: 'Loan Disbursement',
                            items: [
                                {
                                    xtype: 'gridpanel',
                                    frame: true,
                                    itemId: 'grdLoanDisbursement',
                                    store: 'LoanDisbursementStore',
                                    columns: [
                                        {
                                            xtype: 'gridcolumn',
                                            width: 298,
                                            dataIndex: 'MemberName',
                                            text: 'Member Name'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            dataIndex: 'LoanDno',
                                            text: 'Loan No'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            dataIndex: 'Sno',
                                            text: 'SNO'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            dataIndex: 'LoanAmount',
                                            text: 'Loan Amount'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            dataIndex: 'DeductionAmount',
                                            text: 'Deduction Amount'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            dataIndex: 'ContraAcDesc',
                                            text: 'Contra Account'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            dataIndex: 'DisburseType',
                                            text: 'Disbursement Type'
                                        }
                                    ]
                                },
                                {
                                    xtype: 'container',
                                    padding: 10,
                                    layout: {
                                        type: 'table',
                                        columns: 2
                                    },
                                    items: [
                                        {
                                            xtype: 'textfield',
                                            itemId: 'txtTotalDisbursedAmount',
                                            fieldLabel: 'Total Disbursed Amount',
                                            labelWidth: 140,
                                            fieldStyle: 'background-color:#D2D2D2;background-image:none;'
                                        },
                                        {
                                            xtype: 'textfield',
                                            itemId: 'txtTotalDeductionAmount',
                                            margin: '0 0 0 050',
                                            fieldLabel: 'Total Deduction Amount',
                                            labelWidth: 140,
                                            fieldStyle: 'background-color:#D2D2D2;background-image:none;'
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            xtype: 'panel',
                            frame: true,
                            title: 'Loan Repayment',
                            items: [
                                {
                                    xtype: 'gridpanel',
                                    frame: true,
                                    itemId: 'grdLoanRepayment',
                                    title: 'My Grid Panel',
                                    store: 'LoanRepaymentDayEndStore',
                                    columns: [
                                        {
                                            xtype: 'gridcolumn',
                                            width: 299,
                                            dataIndex: 'MemberName',
                                            text: 'Member Name'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            dataIndex: 'LoanDno',
                                            text: 'Loan No'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            dataIndex: 'PaidAmount',
                                            text: 'Total Paid'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            dataIndex: 'PrincipalPaidAmount',
                                            text: 'Principal Paid'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            dataIndex: 'InterestPaidAmount',
                                            text: 'Interest Paid'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            dataIndex: 'PenaltyPaidAmount',
                                            text: 'Loan Amount'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            dataIndex: 'SavAcNo',
                                            text: 'Saving Ac No'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            dataIndex: 'ContraAcDesc',
                                            text: 'Contra Ac'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            dataIndex: 'ChequeNo',
                                            text: 'Cheque No'
                                        }
                                    ]
                                },
                                {
                                    xtype: 'container',
                                    padding: 10,
                                    layout: {
                                        type: 'table',
                                        columns: 2
                                    },
                                    items: [
                                        {
                                            xtype: 'textfield',
                                            itemId: 'txtTotalPaidAmount',
                                            fieldLabel: 'Total Paid Amount',
                                            labelWidth: 140,
                                            fieldStyle: 'background-color:#D2D2D2;background-image:none;'
                                        },
                                        {
                                            xtype: 'textfield',
                                            itemId: 'txtTotalPrincipleAmount',
                                            margin: '0 0 0 050',
                                            fieldLabel: 'Total Principle Amount',
                                            labelWidth: 140,
                                            fieldStyle: 'background-color:#D2D2D2;background-image:none;'
                                        },
                                        {
                                            xtype: 'textfield',
                                            itemId: 'txtTotalInterestAmount',
                                            fieldLabel: 'Total Interest Amount',
                                            labelWidth: 140,
                                            fieldStyle: 'background-color:#D2D2D2;background-image:none;'
                                        },
                                        {
                                            xtype: 'textfield',
                                            itemId: 'txtTotalPenaltyAmount',
                                            margin: '0 0 0 050',
                                            fieldLabel: 'Total Penalty Amount',
                                            labelWidth: 140,
                                            fieldStyle: 'background-color:#D2D2D2;background-image:none;'
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            xtype: 'panel',
                            frame: true,
                            title: 'Saving Deposit',
                            items: [
                                {
                                    xtype: 'gridpanel',
                                    frame: true,
                                    itemId: 'grdfSavingDeposit',
                                    title: 'My Grid Panel',
                                    store: 'SavingDepositStore',
                                    columns: [
                                        {
                                            xtype: 'gridcolumn',
                                            width: 300,
                                            dataIndex: 'ClientName',
                                            text: 'Member Name'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            dataIndex: 'DepositNo',
                                            text: 'Deposit No'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            width: 162,
                                            dataIndex: 'SavingAccountNo',
                                            text: 'Saving Account No'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            dataIndex: 'DepositAmount',
                                            text: 'Deposit Amount'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            dataIndex: 'AccountDesc',
                                            text: 'Contra Account'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            dataIndex: 'SavTypeDesc',
                                            text: 'Saving Type'
                                        }
                                    ]
                                },
                                {
                                    xtype: 'container',
                                    height: 40,
                                    padding: 10,
                                    layout: {
                                        type: 'hbox',
                                        align: 'stretch',
                                        pack: 'center'
                                    },
                                    items: [
                                        {
                                            xtype: 'textfield',
                                            height: 28,
                                            itemId: 'txtTotalDepositAmount',
                                            margin: '',
                                            fieldLabel: 'Total Deposit Amount',
                                            labelWidth: 140,
                                            fieldStyle: 'background-color:#D2D2D2;background-image:none;'
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            xtype: 'panel',
                            frame: true,
                            title: 'Public Interbranch Deposit',
                            items: [
                                {
                                    xtype: 'gridpanel',
                                    frame: true,
                                    itemId: 'grdPublicInterbranchDeposit',
                                    title: 'My Grid Panel',
                                    store: 'AbbsSavingDepositStore',
                                    columns: [
                                        {
                                            xtype: 'gridcolumn',
                                            width: 297,
                                            dataIndex: 'ClientName',
                                            text: 'Member Name'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            dataIndex: 'DepositNo',
                                            text: 'Deposit No'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            dataIndex: 'SavingAccountNo',
                                            text: 'Saving Account No'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            dataIndex: 'DepositAmount',
                                            text: 'Deposit Amount'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            dataIndex: 'AccountDesc',
                                            text: 'Contra Account'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            dataIndex: 'SavTypeDesc',
                                            text: 'Saving Type'
                                        }
                                    ]
                                },
                                {
                                    xtype: 'container',
                                    height: 40,
                                    padding: 10,
                                    layout: {
                                        type: 'hbox',
                                        align: 'stretch',
                                        pack: 'center'
                                    },
                                    items: [
                                        {
                                            xtype: 'textfield',
                                            height: 26,
                                            itemId: 'txtTotalAbbsDepositAmount',
                                            margin: '',
                                            fieldLabel: 'Total Deposit Amount',
                                            labelWidth: 140,
                                            fieldStyle: 'background-color:#D2D2D2;background-image:none;'
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            xtype: 'panel',
                            frame: true,
                            title: 'Saving Withdrawal',
                            items: [
                                {
                                    xtype: 'gridpanel',
                                    frame: true,
                                    itemId: 'grdSavingWithdrawal',
                                    title: 'My Grid Panel',
                                    store: 'SavingWithdrawlStore',
                                    columns: [
                                        {
                                            xtype: 'gridcolumn',
                                            width: 301,
                                            dataIndex: 'ClientName',
                                            text: 'Member Name'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            dataIndex: 'WithdrawalNo',
                                            text: 'Withdrawal No'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            width: 201,
                                            dataIndex: 'SavingAccountNo',
                                            text: 'Saving Account No'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            dataIndex: 'WithdrawAmount',
                                            text: 'Withdraw Amount'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            dataIndex: 'ChequeNo',
                                            text: 'Cheque No'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            dataIndex: 'PayeeName',
                                            text: 'Payee Name'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            dataIndex: 'AccountDesc',
                                            text: 'Contra Account'
                                        }
                                    ]
                                },
                                {
                                    xtype: 'container',
                                    height: 40,
                                    padding: 10,
                                    layout: {
                                        type: 'hbox',
                                        align: 'stretch',
                                        pack: 'center'
                                    },
                                    items: [
                                        {
                                            xtype: 'textfield',
                                            itemId: 'txtTotalSavingWithdrawalAmount',
                                            margin: '',
                                            fieldLabel: 'Total Withdrawal Amount',
                                            labelWidth: 150,
                                            fieldStyle: 'background-color:#D2D2D2;background-image:none;'
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            xtype: 'panel',
                            frame: true,
                            title: 'Public Interbranch Withdrawal',
                            items: [
                                {
                                    xtype: 'gridpanel',
                                    frame: true,
                                    itemId: 'grdPublicInterbranchWithdrawal',
                                    title: 'My Grid Panel',
                                    store: 'AbbsSavingWithdrawStore',
                                    columns: [
                                        {
                                            xtype: 'gridcolumn',
                                            width: 302,
                                            dataIndex: 'ClientName',
                                            text: 'Member Name'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            dataIndex: 'WithdrawalNo',
                                            text: 'Withdrawal No'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            dataIndex: 'SavingAccountNo',
                                            text: 'Saving Account No'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            dataIndex: 'WithdrawAmount',
                                            text: 'Withdraw Amount'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            dataIndex: 'ChequeNo',
                                            text: 'Cheque No'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            dataIndex: 'PayeeName',
                                            text: 'Payee Name'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            dataIndex: 'AccountDesc',
                                            text: 'Contra Account'
                                        }
                                    ]
                                },
                                {
                                    xtype: 'container',
                                    height: 40,
                                    itemId: 'txtTotalInterbranchWithdrawalAmount',
                                    padding: 10,
                                    layout: {
                                        type: 'hbox',
                                        align: 'stretch',
                                        pack: 'center'
                                    },
                                    items: [
                                        {
                                            xtype: 'textfield',
                                            itemId: 'txtTotalWithdrawalAmount',
                                            margin: '',
                                            fieldLabel: 'Total Withdrawal Amount',
                                            labelWidth: 150,
                                            fieldStyle: 'background-color:#D2D2D2;background-image:none;'
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            xtype: 'panel',
                            frame: true,
                            title: 'Collection Sheet',
                            items: [
                                {
                                    xtype: 'gridpanel',
                                    frame: true,
                                    itemId: 'grdCollectionsheet',
                                    title: 'My Grid Panel',
                                    store: 'CollectionSheetMasterOnlineStore',
                                    columns: [
                                        {
                                            xtype: 'gridcolumn',
                                            width: 142,
                                            dataIndex: 'CollectionSheetNo',
                                            text: 'Collection Sheet No'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            dataIndex: 'CenterCode',
                                            text: 'Center Code'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            dataIndex: 'CenterName',
                                            text: 'Center Name'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            dataIndex: 'EmpName',
                                            text: 'Employee Name'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            width: 128,
                                            dataIndex: 'CenterFundAccount',
                                            text: 'Center Fund Account'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            width: 125,
                                            dataIndex: 'CenterFundAmount',
                                            text: 'Center Fund Amount'
                                        }
                                    ]
                                },
                                {
                                    xtype: 'container',
                                    padding: 10,
                                    layout: {
                                        type: 'table',
                                        columns: 4
                                    },
                                    items: [
                                        {
                                            xtype: 'textfield',
                                            fieldLabel: 'Principle Paid Amount',
                                            labelWidth: 122
                                        },
                                        {
                                            xtype: 'textfield',
                                            itemId: 'txtTotalPaidAmount',
                                            margin: '0 0 0 20',
                                            fieldLabel: 'Total Paid Amount',
                                            labelWidth: 120
                                        },
                                        {
                                            xtype: 'textfield',
                                            itemId: 'txtTotalCenterFund',
                                            margin: '0 0 0 20',
                                            fieldLabel: 'Total Center Fund',
                                            labelWidth: 120,
                                            fieldStyle: 'background-color:#D2D2D2;background-image:none;'
                                        },
                                        {
                                            xtype: 'textfield',
                                            itemId: 'txtTotalAdjFromSaving',
                                            margin: '0 0 0 20',
                                            fieldLabel: 'Tot.Adj.From Saving',
                                            labelWidth: 120
                                        },
                                        {
                                            xtype: 'textfield',
                                            itemId: 'txtInterestPaidAmount',
                                            fieldLabel: 'Interest Paid Amount',
                                            labelWidth: 122
                                        },
                                        {
                                            xtype: 'textfield',
                                            itemId: 'txtSavingAdjustment',
                                            margin: '0 0 0 20',
                                            fieldLabel: 'Saving Adjustment',
                                            labelWidth: 120
                                        },
                                        {
                                            xtype: 'textfield',
                                            itemId: 'txtTotalPerSaving',
                                            margin: '0 0 0 20',
                                            fieldLabel: 'Total Per.Saving',
                                            labelWidth: 120
                                        },
                                        {
                                            xtype: 'textfield',
                                            itemId: 'txtTotalGrFundColl',
                                            margin: '0 0 0 20',
                                            fieldLabel: 'Total Gr.Fund Coll.',
                                            labelWidth: 120
                                        },
                                        {
                                            xtype: 'textfield',
                                            itemId: 'txtPenaltyPaidAmount',
                                            fieldLabel: 'Penalty Paid Amount',
                                            labelWidth: 122
                                        },
                                        {
                                            xtype: 'textfield',
                                            itemId: 'txtCashAmount',
                                            margin: '0 0 0 20',
                                            fieldLabel: 'Cash Amount',
                                            labelWidth: 120
                                        },
                                        {
                                            xtype: 'textfield',
                                            itemId: 'txtTotalCashCollection',
                                            margin: '0 0 0 20',
                                            fieldLabel: 'Total Cash Collection',
                                            labelWidth: 120
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ],
            listeners: {
                afterrender: {
                    fn: me.onPanelAfterRender,
                    scope: me
                }
            }
        });

        me.callParent(arguments);
    },

    onBtnABBSAdjustmentClick: function(button, e, eOpts) {
        var insObj={
            Date1:Ext.ComponentQuery.query('#txtDateAD')[0].getValue(),
            TranOfficeCode:getOfficeCode(),
            CreatedBy:getCurrentUser()
        };

        var waitSave = watiMsg("Please wait ...");
        Ext.Ajax.request({
            url: '../Handlers/Finance/Processing/CallAbbsAdjustmentHandler.ashx',
            params: {
                method:'SaveCallAbbsAdjustment',
                callAbbsAdjustment:JSON.stringify(insObj)
            },
            success: function ( response, request ) {
                waitSave.hide();
                var out=Ext.decode(response.responseText);
                console.log(out);

                if(out.success==="true")
                {
                    msg("SUCCESS",out.message);

                }
                else
                {
                    msg("FAILURE",out.message);
                }
            },
            failure: function ( result, request ) {
                waitSave.hide();
                var out=Ext.decode(response.responseText);
                msg("FAILURE",out.message);
            }

        });
    },

    onBtnCloseBookForTheDayClick: function(button, e, eOpts) {
        var insObj={
            Date1:Ext.ComponentQuery.query('#txtDateAD')[0].getValue(),
            TranOfficeCode:getOfficeCode(),
            CreatedBy:getCurrentUser()
        };

        var waitSave = watiMsg("Please wait ...");
        Ext.Ajax.request({
            url: '../Handlers/Finance/Processing/DayEndProcessHandler.ashx',
            params: {
                method:'SaveDayEndProcess',
                dayEndProcess:JSON.stringify(insObj)
            },
            success: function ( response, request ) {
                waitSave.hide();
                var out=Ext.decode(response.responseText);
                console.log(out);

                if(out.success==="true")
                {
                    msg("SUCCESS",out.message);

                }
                else
                {
                    msg("FAILURE",out.message);
                }
            },
            failure: function ( result, request ) {
                waitSave.hide();
                var out=Ext.decode(response.responseText);
                msg("FAILURE",out.message);
            }

        });
    },

    onPanelAfterRender: function(component, eOpts) {
        Ext.ComponentQuery.query('#txtDateAD')[0].setValue(getMisDateAD());
        Ext.ComponentQuery.query('#txtDateBS')[0].setValue(getMisDateBS());



        Ext.Ajax.request({
            url: '../Handlers/Finance/Processing/LoanDisbursementHandler.ashx',
            params: {
                method:'GetLoanDisbursement',
                OfficeCode:getOfficeCode(),
                UserCode:getCurrentUser()
            },
            success: function(response){


                var obj = Ext.decode(response.responseText);

                console.log('resp',response);



                if(obj.success === "true")
                {

                    var store=Ext.getStore('LoanDisbursementStore');
                    store.removeAll();
                    store.add(obj.root);
                    console.log('check',obj.root.length);
                    if(obj.root.length){
                        Ext.ComponentQuery.query('#txtTotalDisbursedAmount')[0].setValue(obj.root[0].data.TotalDisburseAmount);
                    }
                    else{
                        Ext.ComponentQuery.query('#txtTotalDisbursedAmount')[0].setValue('0');

                    }
                    if(obj.root.length){
                    Ext.ComponentQuery.query('#txtTotalDeductionAmount')[0].setValue(obj.root[0].data.TotalDeductionAmount);
                    }
                    else{
                       Ext.ComponentQuery.query('#txtTotalDeductionAmount')[0].setValue('0');

                    }
                }
                else
                {

                    msg("FAILURE",obj.message);
                }
            }
        });


        Ext.Ajax.request({
            url: '../Handlers/Finance/Processing/LoanRepaymentHandler.ashx',
            params: {
                method:'GetLoanRepayment',
                OfficeCode:getOfficeCode(),
                UserCode:getCurrentUser()
            },
            success: function(response){


                var obj = Ext.decode(response.responseText);

                console.log('resp',response);



                if(obj.success === "true")
                {

                    var store=Ext.getStore('LoanRepaymentDayEndStore');
                    store.removeAll();
                    store.add(obj.root);
                    if(obj.root.length)
                    {
                        Ext.ComponentQuery.query('#txtTotalPaidAmount')[0].setValue(obj.root[0].data.TotalDisburseAmount);

                    }
                    else
                    {
                        Ext.ComponentQuery.query('#txtTotalPaidAmount')[0].setValue('0');

                    }
                    if(obj.root.length)
                    {
                        Ext.ComponentQuery.query('#txtTotalPrincipleAmount')[0].setValue(obj.root[0].data.TotalPrincipalAmount);

                    }
                    else
                    {
                        Ext.ComponentQuery.query('#txtTotalPrincipleAmount')[0].setValue('0');

                    }
                    if(obj.root.length)
                    {
                        Ext.ComponentQuery.query('#txtTotalInterestAmount')[0].setValue(obj.root[0].data.TotalInterestAmount);

                    }
                    else
                    {
                        Ext.ComponentQuery.query('#txtTotalInterestAmount')[0].setValue('0');

                    }
                    if(obj.root.length)
                    {
                        Ext.ComponentQuery.query('#txtTotalPenaltyAmount')[0].setValue(obj.root[0].data.TotalPenaltyAmount);

                    }
                    else
                    {
                        Ext.ComponentQuery.query('#txtTotalPenaltyAmount')[0].setValue('0');

                    }


                }
                else
                {

                    msg("FAILURE",obj.message);
                }
            }
        });



        Ext.Ajax.request({
            url: '../Handlers/Finance/Processing/SavingDepositHandler.ashx',
            params: {
                method:'GetSavingDeposit',
                OfficeCode:getOfficeCode(),
                UserCode:getCurrentUser()
            },
            success: function(response){


                var obj = Ext.decode(response.responseText);

                console.log('resp',response);



                if(obj.success === "true")
                {

                    var store=Ext.getStore('SavingDepositStore');
                    store.removeAll();
                    store.add(obj.root);
                    if(obj.root.length)
                    {
                        Ext.ComponentQuery.query('#txtTotalDepositAmount')[0].setValue(obj.root[0].data.TotalDepositAmount);

                    }
                    else
                    {
                        Ext.ComponentQuery.query('#txtTotalDepositAmount')[0].setValue('0');

                    }

                }
                else
                {

                    msg("FAILURE",obj.message);
                }
            }
        });



        Ext.Ajax.request({
            url: '../Handlers/Finance/Processing/AbbsSavingDepositHandler.ashx',
            params: {
                method:'GetAbbsSavingDeposit',
                OfficeCode:getOfficeCode()

            },
            success: function(response){


                var obj = Ext.decode(response.responseText);

                console.log('resp',response);



                if(obj.success === "true")
                {

                    var store=Ext.getStore('AbbsSavingDepositStore');
                    store.removeAll();
                    store.add(obj.root);
                    if(obj.root.length)
                    {
                        Ext.ComponentQuery.query('#txtTotalAbbsDepositAmount')[0].setValue(obj.root[0].data.TotalDepositAmount);

                    }
                    else
                    {
                        Ext.ComponentQuery.query('#txtTotalAbbsDepositAmount')[0].setValue('0');

                    }
                }
                else
                {

                    msg("FAILURE",obj.message);
                }
            }
        });




        Ext.Ajax.request({
            url: '../Handlers/Finance/Processing/SavingWithdrawlHandler.ashx',
            params: {
                method:'GetSavingWithdrawal',
                OfficeCode:getOfficeCode(),
                UserCode:getCurrentUser()
            },
            success: function(response){


                var obj = Ext.decode(response.responseText);

                console.log('resp',response);



                if(obj.success === "true")
                {

                    var store=Ext.getStore('SavingWithdrawlStore');
                    store.removeAll();
                    store.add(obj.root);
                    if(obj.root.length)
                    {
                        Ext.ComponentQuery.query('#txtTotalSavingWithdrawalAmount')[0].setValue(obj.root[0].data.TotalWithdrawAmount);

                    }
                    else
                    {
                        Ext.ComponentQuery.query('#txtTotalSavingWithdrawalAmount')[0].setValue('0');

                    }

                }
                else
                {

                    msg("FAILURE",obj.message);
                }
            }
        });




        Ext.Ajax.request({
            url: '../Handlers/Finance/Processing/AbbsSavingWithdrawlHandler.ashx',
            params: {
                method:'GetAbbsSavingWithdrawal',
                OfficeCode:getOfficeCode(),
                UserCode:getCurrentUser()
            },
            success: function(response){


                var obj = Ext.decode(response.responseText);

                console.log('resp',response);



                if(obj.success === "true")
                {

                    var store=Ext.getStore('AbbsSavingWithdrawStore');
                    store.removeAll();
                    store.add(obj.root);
                    if(obj.root.length)
                    {
                        Ext.ComponentQuery.query('#txtTotalWithdrawalAmount')[0].setValue(obj.root[0].data.TotalWithdrawAmount);

                    }
                    else
                    {
                        Ext.ComponentQuery.query('#txtTotalWithdrawalAmount')[0].setValue('0');

                    }

                }
                else
                {

                    msg("FAILURE",obj.message);
                }
            }
        });



        Ext.Ajax.request({
            url: '../Handlers/Finance/Processing/CollectionSheetMasterOnlineHandler.ashx',
            params: {
                method:'GetCollectionSheetMstOnline',
                OfficeCode:getOfficeCode(),
            },
            success: function(response){


                var obj = Ext.decode(response.responseText);

                console.log('resp',response);



                if(obj.success === "true")
                {

                    var store=Ext.getStore('CollectionSheetMasterOnlineStore');
                    store.removeAll();
                    store.add(obj.root);
                    if(obj.root.lengtht)
                    {
                        Ext.ComponentQuery.query('#txtTotalCenterFund')[0].setValue(obj.root[0].data.TotalCenterFundAmount);

                    }
                    else
                    {
                        Ext.ComponentQuery.query('#txtTotalCenterFund')[0].setValue('0');

                    }

                }
                else
                {

                    msg("FAILURE",obj.message);
                }
            }
        });

    }

});