/*
 * File: app/controller/GroupEntry.js
 *
 * This file was generated by Sencha Architect version 4.2.2.
 * http://www.sencha.com/products/architect/
 *
 * This file requires use of the Ext JS 4.1.x library, under independent license.
 * License of Sencha Architect does not include license for Ext JS 4.1.x. For more
 * details see http://www.sencha.com/license or contact license@sencha.com.
 *
 * This file will be auto-generated each and everytime you save your project.
 *
 * Do NOT hand edit this file.
 */

Ext.define('MyApp.controller.GroupEntry', {
    extend: 'Ext.app.Controller',

    stores: [
        'GroupSearchStore'
    ],

    onBtnCreateGroupClick: function(button, e, eOpts) {
        var strMsgCode ='';
        var fiscalYear ='';
        var strMsgDesc ='';

        var groupCode = Ext.ComponentQuery.query('#txtGroupCode')[0];
        var groupName = Ext.ComponentQuery.query('#txtGroupName')[0];
        var centerCode = Ext.ComponentQuery.query('#txtCenterCode')[0];
        var groupFormedDate = Ext.ComponentQuery.query('#txtGroupFormedAd')[0];
        var groupFormedBy = Ext.ComponentQuery.query('#txtFieldAssistantCode')[0];
        var tranOfficeCode ='';
        var computerUserId ='';
        var createdOn = '';
        var createdBy = '';
        var modifiedOn = '';
        var modifiedBy = '';
        var lastChangedDate  = '';
        var grtPerformDate = Ext.ComponentQuery.query('#txtGrtPerformDate')[0];
        var grtPerformVal = Ext.ComponentQuery.query('#txtGrtPerformValue')[0];
        var grtPerformBy = '';
        var thirdPartyData='';
        var groupClosedDate = Ext.ComponentQuery.query('#txtGroupClosedDateAd')[0];
        var activeFlags = Ext.ComponentQuery.query('#chkActive')[0];
        var grpLeaderIndicator= Ext.ComponentQuery.query('#txtGroupLeaderCode')[0];
        var action ="I";


        var group={
            FiscalYear:fiscalYear,
                 GroupCode:groupCode.getValue(),
                 GroupName:groupName.getValue(),
                 CenterCode:centerCode.getValue(),
                 GroupFormedDate:groupFormedDate.getValue(),
                 GroupFormedBy:groupFormedBy.getValue(),
                 TranOfficeCode:tranOfficeCode,
                 CreatedOn:createdOn,
                 CreatedBy:createdBy,
                 ModifiedOn:modifiedOn,
                 ModifiedBy:modifiedBy,
                 LastChangedDate:lastChangedDate,
                 TransferDate:'',
                 GrtPerformDate:grtPerformDate.getValue(),
                 GrtPerformVal:grtPerformVal.getValue(),
                 GrtPerformBy:grtPerformBy,
                 ThirdPartyData:'',
                 GroupClosedDate:groupClosedDate.getValue(),
                 ActiveFlags:activeFlags.getValue()?'Y':'N',
                 GrpLeaderIndicator:grpLeaderIndicator.getValue(),
                 Action:action
        };
        Ext.Ajax.request({
            url: '../Handlers/GeneralMasterParameters/group/GroupHandler.ashx',
            params: {
                method:'SaveGroup',
                group:JSON.stringify(group)
            },
            success: function(response){

                msg('INFO','Group Saved Successfully');
            }
        });

    },

    onBtnCenterDetailsSearchClick: function(button, e, eOpts) {
        var buildDateFromBS=Ext.ComponentQuery.query('#txtSearchBuildDateFromBs')[0];
        var buildDateToBS=Ext.ComponentQuery.query('#txtSearchBuildDateToBs')[0];
        var centerCode=Ext.ComponentQuery.query('#txtSearchCenterCode')[0];
        var centerName=Ext.ComponentQuery.query('#txtSearchCenterName')[0];
        var groupCode=Ext.ComponentQuery.query('#txtSearchGroupCode')[0];
        var groupName=Ext.ComponentQuery.query('#txtSearchGroupName')[0];


         var waitSave = watiMsg('Please wait ...');
                Ext.Ajax.request({
                     url: '../Handlers/GeneralMasterParameters/Group/GroupHandler.ashx',
                     params:{method:'SearchGroup',group:JSON.stringify({})},
                     success: function ( result, request ) {
                waitSave.hide();
                          var obj = Ext.decode(result.responseText);
                          if(obj.success === 'true'){
                              var store =Ext.getStore('GroupSearchStore');
                              store.removeAll();
                              store.add(obj.root);


                          }
        				  else{
        					  msg("FAILURE","Could Not Load Data");
        				  }

                     },
                     failure: function(form, action) {
                         msg("FAILURE","Could Not Load Data");
                     }
                });
    },

    onBtnUpdateGroupClick: function(button, e, eOpts) {
        var strMsgCode ='';
        var fiscalYear ='';
        var strMsgDesc ='';

        var groupCode = Ext.ComponentQuery.query('#txtGroupCode')[0];
        var groupName = Ext.ComponentQuery.query('#txtGroupName')[0];
        var centerCode = Ext.ComponentQuery.query('#txtCenterCode')[0];
        var groupFormedDate = Ext.ComponentQuery.query('#txtGroupFormedAd')[0];
        var groupFormedBy = Ext.ComponentQuery.query('#txtFieldAssistantCode')[0];
        var tranOfficeCode ='';
        var computerUserId ='';
        var createdOn = '';
        var createdBy = '';
        var modifiedOn = '';
        var modifiedBy = '';
        var lastChangedDate  = '';
        var grtPerformDate = Ext.ComponentQuery.query('#txtGrtPerformDate')[0];
        var grtPerformVal = Ext.ComponentQuery.query('#txtGrtPerformValue')[0];
        var grtPerformBy = '';
        var thirdPartyData='';
        var groupClosedDate = Ext.ComponentQuery.query('#txtGroupClosedDateAd')[0];
        var activeFlags = Ext.ComponentQuery.query('#chkActive')[0];
        var grpLeaderIndicator= Ext.ComponentQuery.query('#txtGroupLeaderCode')[0];
        var action ="U";


        var group={
            FiscalYear:fiscalYear,
                 GroupCode:groupCode.getValue(),
                 GroupName:groupName.getValue(),
                 CenterCode:centerCode.getValue(),
                 GroupFormedDate:groupFormedDate.getValue(),
                 GroupFormedBy:groupFormedBy.getValue(),
                 TranOfficeCode:tranOfficeCode,
                 CreatedOn:createdOn,
                 CreatedBy:createdBy,
                 ModifiedOn:modifiedOn,
                 ModifiedBy:modifiedBy,
                 LastChangedDate:lastChangedDate,
                 TransferDate:'',
                 GrtPerformDate:grtPerformDate.getValue(),
                 GrtPerformVal:grtPerformVal.getValue(),
                 GrtPerformBy:grtPerformBy,
                 ThirdPartyData:'',
                 GroupClosedDate:groupClosedDate.getValue(),
                 ActiveFlags:activeFlags.getValue()?'Y':'N',
                 GrpLeaderIndicator:grpLeaderIndicator.getValue(),
                 Action:action
        };
        Ext.Ajax.request({
            url: '../Handlers/GeneralMasterParameters/group/GroupHandler.ashx',
            params: {
                method:'SaveGroup',
                group:JSON.stringify(group)
            },
            success: function(response){

                msg('INFO','Group Updated Successfully');
            }
        });

    },

    onBtnDeleteGroupClick: function(button, e, eOpts) {


        var groupCode = Ext.ComponentQuery.query('#txtGroupCode')[0];
        var groupName = Ext.ComponentQuery.query('#txtGroupName')[0];
        var centerCode = Ext.ComponentQuery.query('#txtCenterCode')[0];
        var groupFormedDate = Ext.ComponentQuery.query('#txtGroupFormedAd')[0];

        var action ="D";


        var group={

                 GroupCode:groupCode.getValue(),
                 GroupName:groupName.getValue(),
                 CenterCode:centerCode.getValue(),
                 GroupFormedDate:groupFormedDate.getValue(),
                Action:action

        };
        Ext.Ajax.request({
            url: '../Handlers/GeneralMasterParameters/group/GroupHandler.ashx',
            params: {
                method:'SaveGroup',
                group:JSON.stringify(group)
            },
            success: function(response){

                msg('INFO','Group Deleted Successfully');
            }
        });

    },

    init: function(application) {
        this.control({
            "#btnCreateGroup": {
                click: this.onBtnCreateGroupClick
            },
            "#btnCenterDetailsSearch": {
                click: this.onBtnCenterDetailsSearchClick
            },
            "#btnUpdateGroup": {
                click: this.onBtnUpdateGroupClick
            },
            "#btnDeleteGroup": {
                click: this.onBtnDeleteGroupClick
            }
        });
    }

});
