/*
 * File: app/controller/BusinessRegistration.js
 *
 * This file was generated by Sencha Architect version 2.2.3.
 * http://www.sencha.com/products/architect/
 *
 * This file requires use of the Ext JS 4.1.x library, under independent license.
 * License of Sencha Architect does not include license for Ext JS 4.1.x. For more
 * details see http://www.sencha.com/license or contact license@sencha.com.
 *
 * This file will be auto-generated each and everytime you save your project.
 *
 * Do NOT hand edit this file.
 */

Ext.define('MyApp.controller.BusinessRegistration', {
    extend: 'Ext.app.Controller',

    stores: [
        'Bus_Reg_T1LocationTypeStore',
        'BusinessCategoriesStore',
        'Bus_Reg_T3BusDetListStore',
        'BusinessSubCategoriesStore',
        'BusReg_ApproxBusDetStore',
        'Bus_Reg_Contact_1',
        'Bus_Reg_Contact_2',
        'Bus_Reg_Contact_3',
        'Bus_Reg_Contact_4',
        'Bus_Reg_Contact_5',
        'Bus_Reg_Contact_6',
        'BusinessListStore',
        'Bus_Reg_Contact1',
        'Bus_Reg_Contact2',
        'Bus_Reg_Contact3',
        'Bus_Reg_Contact4',
        'DistrictAreaStore',
        'BusReg_PDDocumentTypeStore',
        'BusReg_PDITDocumentTypeStore',
        'Bus_Reg_Contact_Rent',
        'DistrictRegistration'
    ],

    onBus_Reg_NextClick: function(button, e, eOpts) {
        var businessSubTyp="";
        var businessTyp="";
        var submissionNo="";
        var busReg=Ext.getCmp('BusinessRegistration');
        var val="";
        var regFor="";

        if(busReg.extraParam)   
        {    
            submissionNo = busReg.extraParam.subNo; 
            businessTyp=busReg.extraParam.busTyp;
            businessSubTyp=busReg.extraParam.busSubTyp;
            val=busReg.extraParam.regFor;
            regFor=val;
        }



        /////
        //var val=Ext.ComponentQuery.query('#Bus_Reg_RedirectURL')[0].getValue();   
        //alert('val : '+val);
        if(val==3)  //VAT
        {
            uiConfig = {menuLink:'VATRegistration',pageTitle:'VAT Registration'};
            DynamicUI(uiConfig,function(){         
                //Ext.ComponentQuery.query('#VAT_Reg_RedirectURL')[0].setValue(val);
                //Ext.ComponentQuery.query('#VAT_Reg_PanAction')[0].setValue("A");
                //var VATRegNext=Ext.ComponentQuery.query('#VAT_Reg_Next')[0];            
                //VATRegNext.hide();


            },{subNo:submissionNo,busTyp:businessTyp,busSubTyp:businessSubTyp,regFor:regFor});
            }
            if(val==4)  //EXCISE
            {
                uiConfig = {menuLink:'ExciseRegistration',pageTitle:'Excise Registration'};
                DynamicUI(uiConfig,function(){         
                    // Ext.ComponentQuery.query('#Excise_Reg_RedirectURL')[0].setValue(val);
                    //Ext.ComponentQuery.query('#Excise_Reg_PanAction')[0].setValue("A");
                    //var ExciseRegNext=Ext.ComponentQuery.query('#Excise_Reg_Next')[0];            
                    //ExciseRegNext.hide();


                },{subNo:submissionNo,busTyp:businessTyp,busSubTyp:businessSubTyp,regFor:regFor});
                }
                if(val==5)  //ITAX,VAT,EXCISE
                {
                    uiConfig = {menuLink:'VATRegistration',pageTitle:'VAT Registration'};
                    DynamicUI(uiConfig,function(){   

                        //Ext.ComponentQuery.query('#VAT_Reg_RedirectURL')[0].setValue(val);
                        //Ext.ComponentQuery.query('#VAT_Reg_PanAction')[0].setValue("A");
                        //var VATRegNext=Ext.ComponentQuery.query('#VAT_Reg_Next')[0];            
                        //VATRegNext.show();


                    },{subNo:submissionNo,busTyp:businessTyp,busSubTyp:businessSubTyp,regFor:regFor});
                    }
                    else if(val==6)  //ITAX,VAT
                    {
                        uiConfig = {menuLink:'VATRegistration',pageTitle:'VAT Registration'};
                        DynamicUI(uiConfig,function(){         
                            //Ext.ComponentQuery.query('#VAT_Reg_RedirectURL')[0].setValue(val);
                            //Ext.ComponentQuery.query('#VAT_Reg_PanAction')[0].setValue("A");
                            //var VATRegNext=Ext.ComponentQuery.query('#VAT_Reg_Next')[0];            
                            //VATRegNext.hide();


                        },{subNo:submissionNo,busTyp:businessTyp,busSubTyp:businessSubTyp,regFor:regFor});

                        }   
                        else if(val==7)  //VAT,EXCISE
                        {
                            uiConfig = {menuLink:'VATRegistration',pageTitle:'VAT Registration'};
                            DynamicUI(uiConfig,function(){         
                                // Ext.ComponentQuery.query('#VAT_Reg_RedirectURL')[0].setValue(val);
                                //Ext.ComponentQuery.query('#VAT_Reg_PanAction')[0].setValue("A");
                                //var VATRegNext=Ext.ComponentQuery.query('#VAT_Reg_Next')[0];            
                                //VATRegNext.show();


                            },{subNo:submissionNo,busTyp:businessTyp,busSubTyp:businessSubTyp,regFor:regFor});

                            }   
                            else if(val==8)  //ITAX,EXCISE
                            {
                                uiConfig = {menuLink:'ExciseRegistration',pageTitle:'Excise Registration'};
                                DynamicUI(uiConfig,function(){         
                                    //Ext.ComponentQuery.query('#Excise_Reg_RedirectURL')[0].setValue(val);
                                    //Ext.ComponentQuery.query('#Excise_Reg_PanAction')[0].setValue("A");
                                    // var ExciseRegNext=Ext.ComponentQuery.query('#Excise_Reg_Next')[0];            
                                    // ExciseRegNext.hide();


                                },{subNo:submissionNo,busTyp:businessTyp,busSubTyp:businessSubTyp,regFor:regFor});
                                }
                                else
                                {
                                    return;
                                }

                                /////
    },

    onBus_Reg_BtnSaveClick: function(button, e, eOpts) {
        var nepServerDate=document.getElementById('nepDate').innerHTML;
        var me=this;
        var busReg=Ext.getCmp('BusinessRegistration');
        if(busReg.extraParam)   
        {    
            var subNo = busReg.extraParam.subNo; 
            var busType=busReg.extraParam.busTyp;
            var businessSubTyp=busReg.extraParam.busSubTyp;
            var busList=[];
            var store=Ext.ComponentQuery.query('#Bus_Reg_BusinessList')[0].getStore();


            if(busType=='I')
            {
                if(store.getCount()<1)
                {
                    msg("WARNING","Business Missing.");
                    return;
                }
                if(store.findExact('IsMainBusiness',true)<0)
                {
                    msg("WARNING","Main Business Missing.");
                    return;
                }
                var cc=0;
                store.each(function(record,idx){
                    if(record.get('IsMainBusiness')==true)
                    {
                        cc++;        
                    }

                });
                if(cc>1)
                {
                    msg("WARNING","There Can Be Only One Main Business.");
                    return;
                }


                store.clearFilter();
                busList=getJson(store); 
                store.filter(function(item){
                    return item.get("Action")!= 'D';
                });



                Ext.Ajax.request({
                    url: '../Handlers/Registration/BusinessHandler.ashx?method=SaveBusinesses',
                    params: {
                        businesses:JSON.stringify( busList)
                    },
                    success: function(response){
                        var text = response.responseText;
                        var resp=Ext.decode(text);               

                        if(resp.success=='True')
                        {                    
                            msg("Status","Business Information Successfully Saved.");
                            Ext.ComponentQuery.query('#Bus_Reg_Next')[0].enable();
                            me.ReloadForm();  
                        }
                        else
                        {
                            msg("FAILURE","Business Information Saving Failed.");
                        }
                    },
                    failure: function ( result, request ) {
                        msg("FAILURE","Business Information Saving Failed.");        
                    }
                }); 
            }
            else
            {
                var saveAction=Ext.ComponentQuery.query('#Bus_Reg_PanAction')[0].getValue();
                var Bus_Reg_Contact_1= Ext.getStore('Bus_Reg_Contact_1');
                var Bus_Reg_Contact_2= Ext.getStore('Bus_Reg_Contact_2');
                var Bus_Reg_Contact_4= Ext.getStore('Bus_Reg_Contact_4');
                var Bus_Reg_Contact_5= Ext.getStore('Bus_Reg_Contact_5');
                var Bus_Reg_Contact_Rent= Ext.getStore('Bus_Reg_Contact_Rent');
                var busDetListStore= Ext.getStore('Bus_Reg_T3BusDetListStore');

                if(saveAction=="A")
                {
                    //*****
                    //Business Field
                    var TradeNameNepali=Ext.ComponentQuery.query('#Bus_Reg_FirmNameNepali')[0].getValue();

                    //MainOffice address Field
                    var MainOfficeDistrictCode=Ext.ComponentQuery.query('#Bus_Reg_T1District')[0].getValue();
                    // var MainOfficeAreaCode=Ext.ComponentQuery.query('#Bus_Reg_T1Region')[0].getValue(); 

                    //BusinessMainPlace address Field  
                    var BusinessMainPlaceDistrictCode=Ext.ComponentQuery.query('#Bus_Reg_T2District')[0].getValue();   
                    //var BusinessMainPlaceAreaCode=Ext.ComponentQuery.query('#Bus_Reg_T2Region')[0].getValue(); 

                    //BusinessPersonnel Address Field
                    var BusinessPersonnelDistrictCode=Ext.ComponentQuery.query('#Bus_Reg_T51_Child_District')[0].getValue();    
                    //var BusinessPersonnelAreaCode:Ext.ComponentQuery.query('#Bus_Reg_T51_Child_Region')[0].getValue();

                    //BusinessPersonnel Field
                    var BusinessPersonnelFirstNameNep=Ext.ComponentQuery.query('#Bus_Reg_T51FirstNameNepali')[0].getValue();    
                    var BusinessPersonnelLastNameNep=Ext.ComponentQuery.query('#Bus_Reg_T51LastNameNepali')[0].getValue();

                    //BusinessPersonnelForIT Address Field
                    var BusinessPersonnelForITDistrictCode=Ext.ComponentQuery.query('#Bus_Reg_T52_Child_District')[0].getValue();    
                    //var BusinessPersonnelForITAreaCode:Ext.ComponentQuery.query('#Bus_Reg_T52_Child_Region')[0].getValue();


                    //BusinessPersonnelForIT Field
                    var BusinessPersonnelForITFirstNameNep=Ext.ComponentQuery.query('#Bus_Reg_T52FirstNameNepali')[0].getValue();    
                    var BusinessPersonnelForITLastNameNep=Ext.ComponentQuery.query('#Bus_Reg_T52LastNameNepali')[0].getValue();


                    var errMsg="";
                    var errCount=0;
                    if(!TradeNameNepali)
                    {
                        errCount++;
                        errMsg +=errCount+") "+"TradeName (in Nepali) is required.<br/>";
                    }
                    if(!MainOfficeDistrictCode)
                    {
                        errCount++;
                        errMsg +=errCount+") "+"District of main office  is required.<br/>";
                    }
                    if(!BusinessMainPlaceDistrictCode)
                    {
                        errCount++;
                        errMsg +=errCount+") "+"District of Business's main place is required.<br/>";
                    }
                    if(!BusinessPersonnelDistrictCode)
                    {
                        errCount++;
                        errMsg +=errCount+") "+"District of Business personnel is required.<br/>";
                    }
                    if(!BusinessPersonnelFirstNameNep)
                    {
                        errCount++;
                        errMsg +=errCount+") "+"First name (in nepali) of Business personnel is required.<br/>";
                    }
                    if(!BusinessPersonnelLastNameNep)
                    {
                        errCount++;
                        errMsg +=errCount+") "+"Last name (in nepali) of Business personnel is required.<br/>";
                    }
                    if(!BusinessPersonnelForITDistrictCode)
                    {
                        errCount++;
                        errMsg +=errCount+") "+"District of Business personnel for IT is required.<br/>";
                    }
                    if(!BusinessPersonnelForITFirstNameNep)
                    {
                        errCount++;
                        errMsg +=errCount+") "+"First name (in nepali) of Business personnel for IT is required.<br/>";
                    }
                    if(!BusinessPersonnelForITLastNameNep)
                    {
                        errCount++;
                        errMsg +=errCount+") "+"Last name (in nepali) of Business personnel for IT is required.<br/>";
                    }

                    if(errCount>0)
                    {
                        msg("WARNING",errMsg);    
                        return false;
                    }

                    var businessTyp="";
                    var submissionNo="";
                    var busrez=Ext.getCmp('BusinessRegistration');
                    if(busrez.extraParam)   
                    {
                        submissionNo = Ext.getCmp('BusinessRegistration').extraParam.subNo;
                        businessTyp = Ext.getCmp('BusinessRegistration').extraParam.busTyp;  
                    }


                    var businessListStore=Ext.ComponentQuery.query('#Bus_Reg_BusinessList')[0].getStore();
                    var busDetListStore= Ext.getStore('Bus_Reg_T3BusDetListStore');

                    var selection=Ext.ComponentQuery.query('#Bus_Reg_BusinessList')[0].getSelectionModel().getSelection();


                    var locationType="";
                    if(Ext.ComponentQuery.query('#Bus_Reg_T1LocationType1')[0].checked)
                    {
                        locationType="VD";
                    }
                    else if(Ext.ComponentQuery.query('#Bus_Reg_T1LocationType2')[0].checked)
                    {
                        locationType="MN";
                    }
                    else if(Ext.ComponentQuery.query('#Bus_Reg_T1LocationType3')[0].checked)
                    {
                        locationType="MM";
                    }
                    else if(Ext.ComponentQuery.query('#Bus_Reg_T1LocationType4')[0].checked)
                    {
                        locationType="SM";
                    }
                    var MainOfficePlaceAddress =
                    {
                        AddressSNO:0, //not Null field
                        HouseNo:Ext.ComponentQuery.query('#Bus_Reg_T1HouseNo')[0].getValue(),
                        WardNo:Ext.ComponentQuery.query('#Bus_Reg_T1WardNo')[0].getValue()?Ext.ComponentQuery.query('#Bus_Reg_T1WardNo')[0].getValue():null,
                        StreetName:Ext.ComponentQuery.query('#Bus_Reg_T1Tole')[0].getValue(),
                        VdcTown:Ext.ComponentQuery.query('#Bus_Reg_T1VDC')[0].getValue(),
                        LocationType:locationType,
                        DistrictCode:Ext.ComponentQuery.query('#Bus_Reg_T1District')[0].getValue(), //not Null field
                        Telephone:Bus_Reg_Contact_1.getAt(3).data.Value,
                        // AreaCode:'01',//Ext.ComponentQuery.query('#Bus_Reg_T1Region')[0].getValue(), //not Null field
                        AreaCode:Ext.ComponentQuery.query('#Bus_Reg_T1Region')[0].getValue(), //not Null field
                        Fax:Bus_Reg_Contact_1.getAt(1).data.Value,
                        Email:Bus_Reg_Contact_1.getAt(0).data.Value,
                        PoBox:null,
                        ExpiryDate:null,
                        UserId:'ITS',  //not Null field
                        TranDate:null,    
                        TranNo:null,
                        submissionNo:submissionNo,
                        Action:saveAction
                    };

                    var MainOfficePlace=
                    {
                        SubmissionNo:submissionNo,
                        Business_SNO:0,
                        AddressSNO:0,
                        AddressType:'OA',
                        FromDate:nepServerDate,
                        ToDate:null,
                        Status:'S',
                        TranNo:null,
                        Action:saveAction,
                        Address:MainOfficePlaceAddress
                    };

                    var locationType1="";
                    if(Ext.ComponentQuery.query('#Bus_Reg_T2LocationType1')[0].checked)
                    {
                        locationType1="VD";
                    }
                    else if(Ext.ComponentQuery.query('#Bus_Reg_T2LocationType2')[0].checked)
                    {
                        locationType1="MN";
                    }
                    else if(Ext.ComponentQuery.query('#Bus_Reg_T2LocationType3')[0].checked)
                    {
                        locationType1="MM";
                    }
                    else if(Ext.ComponentQuery.query('#Bus_Reg_T2LocationType4')[0].checked)
                    {
                        locationType1="SM";
                    }
                    var MainBusinessPlaceAddress=
                    {
                        AddressSNO:0,
                        HouseNo:Ext.ComponentQuery.query('#Bus_Reg_T2HouseNo ')[0].getValue(),
                        WardNo:Ext.ComponentQuery.query('#Bus_Reg_T2WardNo')[0].getValue()?Ext.ComponentQuery.query('#Bus_Reg_T2WardNo')[0].getValue():null,
                        StreetName:Ext.ComponentQuery.query('#Bus_Reg_T2Tole')[0].getValue(),
                        VdcTown:Ext.ComponentQuery.query('#Bus_Reg_T2VDC')[0].getValue(),
                        LocationType:locationType1,
                        DistrictCode:Ext.ComponentQuery.query('#Bus_Reg_T2District')[0].getValue(),
                        Telephone:Bus_Reg_Contact_2.getAt(3).data.Value,
                        //AreaCode:'01',//Ext.ComponentQuery.query('#Bus_Reg_T2Region')[0].getValue(),
                        AreaCode:Ext.ComponentQuery.query('#Bus_Reg_T2Region')[0].getValue(),
                        Fax:Bus_Reg_Contact_2.getAt(1).data.Value,
                        Email:Bus_Reg_Contact_2.getAt(0).data.Value,
                        PoBox:null,
                        ExpiryDate:null,
                        UserId:'ITS',//null,
                        TranDate:null,    
                        TranNo:null,
                        submissionNo:submissionNo,
                        Action:saveAction
                    };

                    var MainBusinessPlace=
                    {
                        SubmissionNo:submissionNo,
                        Business_SNO:0,
                        AddressSNO:0,
                        AddressType:'BA',
                        FromDate:nepServerDate,
                        ToDate:null,
                        Status:'S',
                        TranNo:null,
                        Action:saveAction,
                        Address:MainBusinessPlaceAddress
                    };  

                    var locationType2="";
                    if(Ext.ComponentQuery.query('#Bus_Reg_T51LocationType1')[0].checked)
                    {
                        locationType2="VD";
                    }
                    else if(Ext.ComponentQuery.query('#Bus_Reg_T51LocationType2')[0].checked)
                    {
                        locationType2="MN";
                    }
                    else if(Ext.ComponentQuery.query('#Bus_Reg_T51LocationType3')[0].checked)
                    {
                        locationType2="MM";
                    }
                    else if(Ext.ComponentQuery.query('#Bus_Reg_T51LocationType4')[0].checked)
                    {
                        locationType2="SM";
                    }
                    var BusinessPersonnelAddress1Address=
                    {
                        AddressSNO:0,
                        HouseNo:Ext.ComponentQuery.query('#Bus_Reg_T51_Child_HouseNo')[0].getValue(),
                        WardNo:Ext.ComponentQuery.query('#Bus_Reg_T51_Child_WardNo')[0].getValue()?Ext.ComponentQuery.query('#Bus_Reg_T51_Child_WardNo')[0].getValue():null,
                        StreetName:Ext.ComponentQuery.query('#Bus_Reg_T51_Child_Tole')[0].getValue(),
                        VdcTown:Ext.ComponentQuery.query('#Bus_Reg_T51_Child_VDC')[0].getValue(),
                        LocationType:locationType2,
                        DistrictCode:Ext.ComponentQuery.query('#Bus_Reg_T51_Child_District')[0].getValue(),
                        Telephone:Bus_Reg_Contact_4.getAt(3).data.Value,
                        AreaCode:'00',//Ext.ComponentQuery.query('#Bus_Reg_T51_Child_Region')[0].getValue(),
                        Fax:Bus_Reg_Contact_4.getAt(1).data.Value,
                        Email:Bus_Reg_Contact_4.getAt(0).data.Value,
                        PoBox:null,
                        ExpiryDate:null,
                        UserId:'ITS',//null,
                        TranDate:null,    
                        TranNo:null,
                        submissionNo:submissionNo,
                        Action:saveAction
                    };

                    var BusinessPersonnelAddress1=
                    {
                        SubmissionNo:submissionNo,
                        Business_SNO:0,
                        BusinessPersonnelType:'CH',
                        FromDateHas:null,
                        Sno:0,
                        AddressSNO:0,
                        FromDate:nepServerDate,
                        ToDate:null,
                        Status:'',
                        TranNo:null,
                        Action:saveAction,
                        Address:BusinessPersonnelAddress1Address
                    };

                    var BusinessPersonnel=
                    {
                        SubmissionNo:submissionNo,
                        BusinessSNO:0,
                        BusPerType:'CH',
                        FromDate:nepServerDate,
                        SNo:0,
                        ToDate:null,
                        FirstNameEng:Ext.ComponentQuery.query('#Bus_Reg_T51FirstNameEnglish')[0].getValue(),
                        MiddleNameEng:Ext.ComponentQuery.query('#Bus_Reg_T51MiddleNameEnglish')[0].getValue(),
                        LastNameEng:Ext.ComponentQuery.query('#Bus_Reg_T51LastNameEnglish')[0].getValue(),
                        FirstNameNep:Ext.ComponentQuery.query('#Bus_Reg_T51FirstNameNepali')[0].getValue(),
                        MiddleNameNep:Ext.ComponentQuery.query('#Bus_Reg_T51MiddleNameNepali')[0].getValue(),
                        LastNameNep:Ext.ComponentQuery.query('#Bus_Reg_T51LastNameNepali')[0].getValue(),
                        TranNo:null,
                        Action:saveAction,
                        BusinessPersonnelAddress:BusinessPersonnelAddress1,
                        AppointedDate:Ext.ComponentQuery.query('#Bus_Reg_T51AppointedDate')[0].getValue(),
                        IdDocument:Ext.ComponentQuery.query('#Bus_Reg_T51PaperType')[0].getValue(),
                        IdNumber:Ext.ComponentQuery.query('#Bus_Reg_T51IdentityNo')[0].getValue(),
                        IdIssueAuthority:Ext.ComponentQuery.query('#Bus_Reg_T51IssuedByOrg')[0].getValue(),
                        IdIssueDate:Ext.ComponentQuery.query('#Bus_Reg_T51IssuedDate')[0].getValue(),
                        IdIssuePlace:Ext.ComponentQuery.query('#Bus_Reg_T51IssuedByOrgPlace')[0].getValue(),
                        Document:"",
                        DocNameUnique:Ext.ComponentQuery.query('#Bus_Reg_T51DocumentTxt')[0].fullName,
                        DocName:Ext.ComponentQuery.query('#Bus_Reg_T51DocumentTxt')[0].getValue(),
                        Post:""
                    };


                    var locationType3="";
                    if(Ext.ComponentQuery.query('#Bus_Reg_T52LocationType1')[0].checked)
                    {
                        locationType3="VD";
                    }
                    else if(Ext.ComponentQuery.query('#Bus_Reg_T52LocationType2')[0].checked)
                    {
                        locationType3="MN";
                    }
                    else if(Ext.ComponentQuery.query('#Bus_Reg_T52LocationType3')[0].checked)
                    {
                        locationType3="MM";
                    }
                    else if(Ext.ComponentQuery.query('#Bus_Reg_T52LocationType4')[0].checked)
                    {
                        locationType3="SM";
                    }
                    var BusinessPersonnelAddress2Address=
                    {
                        AddressSNO:0,
                        HouseNo:Ext.ComponentQuery.query('#Bus_Reg_T52_Child_HouseNo')[0].getValue(),
                        WardNo:Ext.ComponentQuery.query('#Bus_Reg_T52_Child_WardNo')[0].getValue()?Ext.ComponentQuery.query('#Bus_Reg_T52_Child_WardNo')[0].getValue():null,
                        StreetName:Ext.ComponentQuery.query('#Bus_Reg_T52_Child_Tole')[0].getValue(),
                        VdcTown:Ext.ComponentQuery.query('#Bus_Reg_T52_Child_VDC')[0].getValue(),
                        LocationType:locationType3,
                        DistrictCode:Ext.ComponentQuery.query('#Bus_Reg_T52_Child_District')[0].getValue(),
                        Telephone:Bus_Reg_Contact_5.getAt(3).data.Value,
                        AreaCode:'00',//Ext.ComponentQuery.query('#Bus_Reg_T52_Child_Region')[0].getValue(),
                        Fax:Bus_Reg_Contact_5.getAt(1).data.Value,
                        Email:Bus_Reg_Contact_5.getAt(0).data.Value,
                        PoBox:null,
                        ExpiryDate:null,
                        UserId:'ITS',//null,
                        TranDate:null,   
                        TranNo:null,
                        submissionNo:submissionNo,
                        Action:saveAction
                    };

                    var BusinessPersonnelAddress2=
                    {
                        SubmissionNo:submissionNo,
                        Business_SNO:0,
                        BusinessPersonnelType:'CP',
                        FromDateHas:'',
                        Sno:0,
                        AddressSNO:0,
                        FromDate:nepServerDate,
                        ToDate:null,
                        Status:'S',
                        TranNo:null,
                        Action:saveAction,
                        Address:BusinessPersonnelAddress2Address
                    };

                    var BusinessPersonnelForIT=
                    {
                        SubmissionNo:submissionNo,
                        Business_SNO:0,
                        BusPerType:'CP',
                        FromDate:nepServerDate,
                        SNo:0,
                        ToDate:null,
                        FirstNameEng:Ext.ComponentQuery.query('#Bus_Reg_T52FirstNameEnglish')[0].getValue(),
                        MiddleNameEng:Ext.ComponentQuery.query('#Bus_Reg_T52MiddleNameEnglish')[0].getValue(),
                        LastNameEng:Ext.ComponentQuery.query('#Bus_Reg_T52LastNameEnglish')[0].getValue(),
                        FirstNameNep:Ext.ComponentQuery.query('#Bus_Reg_T52FirstNameNepali')[0].getValue(),
                        MiddleNameNep:Ext.ComponentQuery.query('#Bus_Reg_T52MiddleNameNepali')[0].getValue(),
                        LastNameNep:Ext.ComponentQuery.query('#Bus_Reg_T52LastNameNepali')[0].getValue(),
                        TranNo:null,
                        Action:saveAction,
                        BusinessPersonnelAddress:BusinessPersonnelAddress2,
                        AppointedDate:Ext.ComponentQuery.query('#Bus_Reg_T52AppointedDate')[0].getValue(),
                        IdDocument:Ext.ComponentQuery.query('#Bus_Reg_T52PaperType')[0].getValue(),
                        IdNumber:Ext.ComponentQuery.query('#Bus_Reg_T52IdentityNo')[0].getValue(),
                        IdIssueAuthority:Ext.ComponentQuery.query('#Bus_Reg_T52IssuedByOrg')[0].getValue(),
                        IdIssueDate:Ext.ComponentQuery.query('#Bus_Reg_T52IssuedDate')[0].getValue(),
                        IdIssuePlace:Ext.ComponentQuery.query('#Bus_Reg_T52IssuedByOrgPlace')[0].getValue(),
                        Document:"",
                        DocNameUnique:Ext.ComponentQuery.query('#Bus_Reg_T52DocumentTxt')[0].fullName,
                        DocName:Ext.ComponentQuery.query('#Bus_Reg_T52DocumentTxt')[0].getValue(),
                        Post:Ext.ComponentQuery.query('#Bus_Reg_T52Post')[0].getValue()
                    };

                    //start rent
                    var locationTypeRent="";
                    if(Ext.ComponentQuery.query('#Bus_Reg_T4LocationType1')[0].checked)
                    {
                        locationTypeRent="VD";
                    }
                    else if(Ext.ComponentQuery.query('#Bus_Reg_T4LocationType2')[0].checked)
                    {
                        locationTypeRent="MN";
                    }
                    else if(Ext.ComponentQuery.query('#Bus_Reg_T4LocationType3')[0].checked)
                    {
                        locationTypeRent="MM";
                    }
                    else if(Ext.ComponentQuery.query('#Bus_Reg_T4LocationType4')[0].checked)
                    {
                        locationTypeRent="SM";
                    }
                    var rentAddressAddr=
                    {
                        AddressSNO:0,
                        HouseNo:Ext.ComponentQuery.query('#Bus_Reg_T4_Child_HouseNo')[0].getValue(),
                        WardNo:Ext.ComponentQuery.query('#Bus_Reg_T4_Child_WardNo')[0].getValue()?Ext.ComponentQuery.query('#Bus_Reg_T4_Child_WardNo')[0].getValue():null,
                        StreetName:Ext.ComponentQuery.query('#Bus_Reg_T4_Child_Tole')[0].getValue(),
                        VdcTown:Ext.ComponentQuery.query('#Bus_Reg_T4_Child_VDC')[0].getValue(),
                        LocationType:locationTypeRent,
                        DistrictCode:Ext.ComponentQuery.query('#Bus_Reg_T4_Child_District')[0].getValue(),
                        Telephone:Bus_Reg_Contact_Rent.getAt(3).data.Value,
                        AreaCode:'00',
                        Fax:Bus_Reg_Contact_Rent.getAt(1).data.Value,
                        Email:Bus_Reg_Contact_Rent.getAt(0).data.Value,
                        PoBox:null,
                        ExpiryDate:null,
                        UserId:'ITS',//null,
                        TranDate:null,   
                        TranNo:null,
                        submissionNo:submissionNo,
                        Action:saveAction
                    };
                    var rentAddress=
                    {
                        SubmissionNo:submissionNo,
                        Business_SNO:0,
                        AddressSNO:0,                    
                        Action:saveAction,
                        Address:rentAddressAddr
                    };

                    var rent=
                    {
                        SubmissionNo:submissionNo,
                        Business_SNO:0,
                        OwnerPAN:Ext.ComponentQuery.query('#Bus_Reg_T4HouseOwnerPanNo')[0].getValue(),
                        OwnerName:Ext.ComponentQuery.query('#Bus_Reg_T4HouseOwnerName')[0].getValue(),
                        HouseArea:Ext.ComponentQuery.query('#Bus_Reg_T4RoomSize')[0].getValue(),
                        HouseNo:Ext.ComponentQuery.query('#Bus_Reg_T4KittaNo')[0].getValue(),
                        RentalAmount:Ext.ComponentQuery.query('#Bus_Reg_T4Rent')[0].getValue()?Ext.ComponentQuery.query('#Bus_Reg_T4Rent')[0].getValue():null,
                        RentedDate:Ext.ComponentQuery.query('#Bus_Reg_T4RentalDate')[0].getValue(),
                        Action:saveAction,
                        RentAddress:rentAddress
                    };
                    //

                    var Business=
                    {   
                        SubmissionNo:submissionNo,
                        Type:busType,
                        Business_SNO:0,
                        TradeNameNepali:Ext.ComponentQuery.query('#Bus_Reg_FirmNameNepali')[0].getValue(),
                        TradeNameEnglish:Ext.ComponentQuery.query('#Bus_Reg_FirmNameEnglish')[0].getValue(),
                        RegDate:Ext.ComponentQuery.query('#Bus_Reg_RegDate')[0].getValue(),
                        RegNumber:Ext.ComponentQuery.query('#Bus_Reg_RegNo')[0].getValue(),                
                        RegOffice:Ext.ComponentQuery.query('#Bus_Reg_OfficePlace')[0].getValue(),
                        RegPlace:Ext.ComponentQuery.query('#Bus_Reg_OfficePlace')[0].getValue(),
                        StartDate:Ext.ComponentQuery.query('#Bus_Reg_BusStartDate')[0].getValue(),
                        BusinessReceivedFrom:Ext.ComponentQuery.query('#Bus_Reg_TransfererOrg')[0].getValue(),
                        BusinessReceivedDate:null,
                        BusinessTransferredTo:null,
                        BusinessTransferredDate:Ext.ComponentQuery.query('#Bus_Reg_transferDate')[0].getValue(),
                        IsMainBusiness:'true',
                        Status:null,
                        UserID:'ITS',
                        TranDate:null,
                        TranNo:null,
                        Action:saveAction,
                        MainOfficePlace:MainOfficePlace,
                        MainBusinessPlace:MainBusinessPlace,
                        BusinessTypes:getJson(busDetListStore),
                        BusinessPersonnel:BusinessPersonnel,
                        BusinessPersonnelForIT:BusinessPersonnelForIT,
                        Rent:rent
                    };       

                    busList=[Business];     






                    //*****     
                }
                else
                {

                    //-------
                    var selectedIndex= 0;


                    var businessListStore=Ext.ComponentQuery.query('#Bus_Reg_BusinessList')[0].getStore();
                    var business=businessListStore.getAt(selectedIndex).data;

                    var mainOfficePlace=business.MainOfficePlace;
                    var mainOfficePlaceAddress=mainOfficePlace.Address;

                    var mainBusinessPlace=business.MainBusinessPlace;
                    var mainBusinessPlaceAddress=mainBusinessPlace.Address;



                    var businessPersonnel=business.BusinessPersonnel;
                    var businessPersonnelAddress=businessPersonnel.BusinessPersonnelAddress;
                    var businessPersonnelAddressAddress=businessPersonnelAddress.Address;

                    var businessPersonnelForIT=business.BusinessPersonnelForIT;
                    var businessPersonnelForITAddress=businessPersonnelForIT.BusinessPersonnelAddress;
                    var businessPersonnelForITAddressAddress=businessPersonnelForITAddress.Address;

                    var rentt=business.Rent;
                    var renttAddress=rentt.RentAddress;
                    var renttAddressAddr=renttAddress.Address;




                    // start mainofficeplaceaddress

                    var locationType="";
                    if(Ext.ComponentQuery.query('#Bus_Reg_T1LocationType1')[0].checked)
                    {
                        locationType="VD";
                    }
                    else if(Ext.ComponentQuery.query('#Bus_Reg_T1LocationType2')[0].checked)
                    {
                        locationType="MN";
                    }
                    else if(Ext.ComponentQuery.query('#Bus_Reg_T1LocationType3')[0].checked)
                    {
                        locationType="MM";
                    }
                    else if(Ext.ComponentQuery.query('#Bus_Reg_T1LocationType4')[0].checked)
                    {
                        locationType="SM";
                    }

                    mainOfficePlaceAddress.HouseNo=Ext.ComponentQuery.query('#Bus_Reg_T1HouseNo')[0].getValue();
                    mainOfficePlaceAddress.WardNo=Ext.ComponentQuery.query('#Bus_Reg_T1WardNo')[0].getValue()?Ext.ComponentQuery.query('#Bus_Reg_T1WardNo')[0].getValue():null;
                    mainOfficePlaceAddress.StreetName=Ext.ComponentQuery.query('#Bus_Reg_T1Tole')[0].getValue();
                    mainOfficePlaceAddress.VdcTown=Ext.ComponentQuery.query('#Bus_Reg_T1VDC')[0].getValue();
                    mainOfficePlaceAddress.LocationType=locationType;//null,
                    mainOfficePlaceAddress.DistrictCode=Ext.ComponentQuery.query('#Bus_Reg_T1District')[0].getValue(); //not Null field
                    mainOfficePlaceAddress.Telephone=Bus_Reg_Contact_1.getAt(3).data.Value;
                    //mainOfficePlaceAddress.AreaCode='01';//Ext.ComponentQuery.query('#Bus_Reg_T1Region')[0].getValue(), //not Null field
                    mainOfficePlaceAddress.AreaCode=Ext.ComponentQuery.query('#Bus_Reg_T1Region')[0].getValue(); //not Null field
                    mainOfficePlaceAddress.Fax=Bus_Reg_Contact_1.getAt(1).data.Value;
                    mainOfficePlaceAddress.Email=Bus_Reg_Contact_1.getAt(0).data.Value;       

                    mainOfficePlaceAddress.Action=mainOfficePlaceAddress.Action=='A'?'A':'E'; 
                    // end mainofficeplaceaddress
                    //start businessmainplaceaddress

                    var locationType1="";
                    if(Ext.ComponentQuery.query('#Bus_Reg_T2LocationType1')[0].checked)
                    {
                        locationType1="VD";
                    }
                    else if(Ext.ComponentQuery.query('#Bus_Reg_T2LocationType2')[0].checked)
                    {
                        locationType1="MN";
                    }
                    else if(Ext.ComponentQuery.query('#Bus_Reg_T2LocationType3')[0].checked)
                    {
                        locationType1="MM";
                    }
                    else if(Ext.ComponentQuery.query('#Bus_Reg_T2LocationType4')[0].checked)
                    {
                        locationType1="SM";
                    }
                    mainBusinessPlaceAddress.HouseNo=Ext.ComponentQuery.query('#Bus_Reg_T2HouseNo')[0].getValue();
                    mainBusinessPlaceAddress.WardNo=Ext.ComponentQuery.query('#Bus_Reg_T2WardNo')[0].getValue()?Ext.ComponentQuery.query('#Bus_Reg_T2WardNo')[0].getValue():null;
                    mainBusinessPlaceAddress.StreetName=Ext.ComponentQuery.query('#Bus_Reg_T2Tole')[0].getValue();
                    mainBusinessPlaceAddress.VdcTown=Ext.ComponentQuery.query('#Bus_Reg_T2VDC')[0].getValue();
                    mainBusinessPlaceAddress.LocationType=locationType1;
                    mainBusinessPlaceAddress.DistrictCode=Ext.ComponentQuery.query('#Bus_Reg_T2District')[0].getValue(); //not Null field
                    mainBusinessPlaceAddress.Telephone=Bus_Reg_Contact_2.getAt(3).data.Value;
                    //mainBusinessPlaceAddress.AreaCode='01';//Ext.ComponentQuery.query('#Bus_Reg_T1Region')[0].getValue(), //not Null field
                    mainBusinessPlaceAddress.AreaCode=Ext.ComponentQuery.query('#Bus_Reg_T2Region')[0].getValue(); //not Null field
                    mainBusinessPlaceAddress.Fax=Bus_Reg_Contact_2.getAt(1).data.Value;
                    mainBusinessPlaceAddress.Email=Bus_Reg_Contact_2.getAt(0).data.Value;        
                    mainBusinessPlaceAddress.Action=mainBusinessPlaceAddress.Action=='A'?'A':'E'; 
                    //end businessmainplaceaddress    

                    //start businesspersonnelAddressAddress

                    var locationType2="";
                    if(Ext.ComponentQuery.query('#Bus_Reg_T51LocationType1')[0].checked)
                    {
                        locationType2="VD";
                    }
                    else if(Ext.ComponentQuery.query('#Bus_Reg_T51LocationType2')[0].checked)
                    {
                        locationType2="MN";
                    }
                    else if(Ext.ComponentQuery.query('#Bus_Reg_T51LocationType3')[0].checked)
                    {
                        locationType2="MM";
                    }
                    else if(Ext.ComponentQuery.query('#Bus_Reg_T51LocationType4')[0].checked)
                    {
                        locationType2="SM";
                    }
                    businessPersonnelAddressAddress.HouseNo=Ext.ComponentQuery.query('#Bus_Reg_T51_Child_HouseNo')[0].getValue();
                    businessPersonnelAddressAddress.WardNo=Ext.ComponentQuery.query('#Bus_Reg_T51_Child_WardNo')[0].getValue()?Ext.ComponentQuery.query('#Bus_Reg_T51_Child_WardNo')[0].getValue():null;
                    businessPersonnelAddressAddress.StreetName=Ext.ComponentQuery.query('#Bus_Reg_T51_Child_Tole')[0].getValue();
                    businessPersonnelAddressAddress.VdcTown=Ext.ComponentQuery.query('#Bus_Reg_T51_Child_VDC')[0].getValue();
                    businessPersonnelAddressAddress.LocationType=locationType2;
                    businessPersonnelAddressAddress.DistrictCode=Ext.ComponentQuery.query('#Bus_Reg_T51_Child_District')[0].getValue(); //not Null field
                    businessPersonnelAddressAddress.Telephone=Bus_Reg_Contact_4.getAt(3).data.Value;
                    businessPersonnelAddressAddress.AreaCode='00';//Ext.ComponentQuery.query('#Bus_Reg_T1Region')[0].getValue(), //not Null field
                    businessPersonnelAddressAddress.Fax=Bus_Reg_Contact_4.getAt(1).data.Value;
                    businessPersonnelAddressAddress.Email=Bus_Reg_Contact_4.getAt(0).data.Value;        
                    businessPersonnelAddressAddress.Action=businessPersonnelAddressAddress.Action=='A'?'A':'E';     

                    //end businesspersonnelAddressAddress
                    //start businesspersonnel
                    businessPersonnel.FirstNameEng=Ext.ComponentQuery.query('#Bus_Reg_T51FirstNameEnglish')[0].getValue();
                    businessPersonnel.MiddleNameEng=Ext.ComponentQuery.query('#Bus_Reg_T51MiddleNameEnglish')[0].getValue();
                    businessPersonnel.LastNameEng=Ext.ComponentQuery.query('#Bus_Reg_T51LastNameEnglish')[0].getValue();
                    businessPersonnel.FirstNameNep=Ext.ComponentQuery.query('#Bus_Reg_T51FirstNameNepali')[0].getValue();
                    businessPersonnel.MiddleNameNep=Ext.ComponentQuery.query('#Bus_Reg_T51MiddleNameNepali')[0].getValue();
                    businessPersonnel.LastNameNep=Ext.ComponentQuery.query('#Bus_Reg_T51LastNameNepali')[0].getValue();    
                    businessPersonnel.Action=businessPersonnel.Action=='A'?"A":"E";
                    businessPersonnel.AppointedDate=Ext.ComponentQuery.query('#Bus_Reg_T51AppointedDate')[0].getValue();
                    businessPersonnel.IdDocument=Ext.ComponentQuery.query('#Bus_Reg_T51PaperType')[0].getValue();
                    businessPersonnel.IdNumber=Ext.ComponentQuery.query('#Bus_Reg_T51IdentityNo')[0].getValue();
                    businessPersonnel.IdIssueAuthority=Ext.ComponentQuery.query('#Bus_Reg_T51IssuedByOrg')[0].getValue();
                    businessPersonnel.IdIssueDate=Ext.ComponentQuery.query('#Bus_Reg_T51IssuedDate')[0].getValue();
                    businessPersonnel.IdIssuePlace=Ext.ComponentQuery.query('#Bus_Reg_T51IssuedByOrgPlace')[0].getValue();
                    businessPersonnel.Document="";
                    businessPersonnel.DocNameUnique=Ext.ComponentQuery.query('#Bus_Reg_T51DocumentTxt')[0].fullName;
                    businessPersonnel.DocName=Ext.ComponentQuery.query('#Bus_Reg_T51DocumentTxt')[0].getValue();
                    businessPersonnel.Post='';

                    //end businesspersonnel

                    //start businesspersonnelForITAddressAddress

                    var locationType3="";
                    if(Ext.ComponentQuery.query('#Bus_Reg_T52LocationType1')[0].checked)
                    {
                        locationType3="VD";
                    }
                    else if(Ext.ComponentQuery.query('#Bus_Reg_T52LocationType2')[0].checked)
                    {
                        locationType3="MN";
                    }
                    else if(Ext.ComponentQuery.query('#Bus_Reg_T52LocationType3')[0].checked)
                    {
                        locationType3="MM";
                    }
                    else if(Ext.ComponentQuery.query('#Bus_Reg_T52LocationType4')[0].checked)
                    {
                        locationType3="SM";
                    }
                    businessPersonnelForITAddressAddress.HouseNo=Ext.ComponentQuery.query('#Bus_Reg_T52_Child_HouseNo')[0].getValue();
                    businessPersonnelForITAddressAddress.WardNo=Ext.ComponentQuery.query('#Bus_Reg_T52_Child_WardNo')[0].getValue()?Ext.ComponentQuery.query('#Bus_Reg_T52_Child_WardNo')[0].getValue():null;
                    businessPersonnelForITAddressAddress.StreetName=Ext.ComponentQuery.query('#Bus_Reg_T52_Child_Tole')[0].getValue();
                    businessPersonnelForITAddressAddress.VdcTown=Ext.ComponentQuery.query('#Bus_Reg_T52_Child_VDC')[0].getValue();
                    businessPersonnelForITAddressAddress.LocationType=locationType3;
                    businessPersonnelForITAddressAddress.DistrictCode=Ext.ComponentQuery.query('#Bus_Reg_T52_Child_District')[0].getValue(); //not Null field
                    businessPersonnelForITAddressAddress.Telephone=Bus_Reg_Contact_5.getAt(3).data.Value;
                    businessPersonnelForITAddressAddress.AreaCode='00';//Ext.ComponentQuery.query('#Bus_Reg_T1Region')[0].getValue(), //not Null field
                    businessPersonnelForITAddressAddress.Fax=Bus_Reg_Contact_5.getAt(1).data.Value;
                    businessPersonnelForITAddressAddress.Email=Bus_Reg_Contact_5.getAt(0).data.Value;        
                    businessPersonnelForITAddressAddress.Action=businessPersonnelForITAddressAddress.Action=='A'?'A':'E';     

                    //end businesspersonnelForITAddressAddress  
                    //start businesspersonnelForIT
                    businessPersonnelForIT.FirstNameEng=Ext.ComponentQuery.query('#Bus_Reg_T52FirstNameEnglish')[0].getValue();
                    businessPersonnelForIT.MiddleNameEng=Ext.ComponentQuery.query('#Bus_Reg_T52MiddleNameEnglish')[0].getValue();
                    businessPersonnelForIT.LastNameEng=Ext.ComponentQuery.query('#Bus_Reg_T52LastNameEnglish')[0].getValue();
                    businessPersonnelForIT.FirstNameNep=Ext.ComponentQuery.query('#Bus_Reg_T52FirstNameNepali')[0].getValue();
                    businessPersonnelForIT.MiddleNameNep=Ext.ComponentQuery.query('#Bus_Reg_T52MiddleNameNepali')[0].getValue();
                    businessPersonnelForIT.LastNameNep=Ext.ComponentQuery.query('#Bus_Reg_T52LastNameNepali')[0].getValue();    
                    businessPersonnelForIT.Action=businessPersonnelForIT.Action=='A'?"A":"E";
                    businessPersonnelForIT.AppointedDate=Ext.ComponentQuery.query('#Bus_Reg_T52AppointedDate')[0].getValue();
                    businessPersonnelForIT.IdDocument=Ext.ComponentQuery.query('#Bus_Reg_T52PaperType')[0].getValue();
                    businessPersonnelForIT.IdNumber=Ext.ComponentQuery.query('#Bus_Reg_T52IdentityNo')[0].getValue();
                    businessPersonnelForIT.IdIssueAuthority=Ext.ComponentQuery.query('#Bus_Reg_T52IssuedByOrg')[0].getValue();
                    businessPersonnelForIT.IdIssueDate=Ext.ComponentQuery.query('#Bus_Reg_T52IssuedDate')[0].getValue();
                    businessPersonnelForIT.IdIssuePlace=Ext.ComponentQuery.query('#Bus_Reg_T52IssuedByOrgPlace')[0].getValue();
                    businessPersonnelForIT.Document="";
                    businessPersonnelForIT.DocNameUnique=Ext.ComponentQuery.query('#Bus_Reg_T52DocumentTxt')[0].fullName;            
                    businessPersonnelForIT.DocName=Ext.ComponentQuery.query('#Bus_Reg_T52DocumentTxt')[0].getValue();
                    businessPersonnelForIT.Post=Ext.ComponentQuery.query('#Bus_Reg_T52Post')[0].getValue();

                    //end businesspersonnelForIT

                    //start rent
                    var locationTypeRent="";
                    if(Ext.ComponentQuery.query('#Bus_Reg_T4LocationType1')[0].checked)
                    {
                        locationTypeRent="VD";
                    }
                    else if(Ext.ComponentQuery.query('#Bus_Reg_T4LocationType2')[0].checked)
                    {
                        locationTypeRent="MN";
                    }
                    else if(Ext.ComponentQuery.query('#Bus_Reg_T4LocationType3')[0].checked)
                    {
                        locationTypeRent="MM";
                    }
                    else if(Ext.ComponentQuery.query('#Bus_Reg_T4LocationType4')[0].checked)
                    {
                        locationTypeRent="SM";
                    }



                    renttAddressAddr.HouseNo=Ext.ComponentQuery.query('#Bus_Reg_T4_Child_HouseNo')[0].getValue();
                    renttAddressAddr.WardNo=Ext.ComponentQuery.query('#Bus_Reg_T4_Child_WardNo')[0].getValue()?Ext.ComponentQuery.query('#Bus_Reg_T4_Child_WardNo')[0].getValue():null;
                    renttAddressAddr.StreetName=Ext.ComponentQuery.query('#Bus_Reg_T4_Child_Tole')[0].getValue();
                    renttAddressAddr.VdcTown=Ext.ComponentQuery.query('#Bus_Reg_T4_Child_VDC')[0].getValue();
                    renttAddressAddr.LocationType=locationTypeRent;
                    renttAddressAddr.DistrictCode=Ext.ComponentQuery.query('#Bus_Reg_T4_Child_District')[0].getValue();
                    renttAddressAddr.Telephone=Bus_Reg_Contact_Rent.getAt(3).data.Value;
                    renttAddressAddr.AreaCode='00';
                    renttAddressAddr.Fax=Bus_Reg_Contact_Rent.getAt(1).data.Value;
                    renttAddressAddr.Email=Bus_Reg_Contact_Rent.getAt(0).data.Value;           
                    renttAddressAddr.Action=renttAddressAddr.Action=='A'?'A':'E';          



                    rentt.OwnerPAN=Ext.ComponentQuery.query('#Bus_Reg_T4HouseOwnerPanNo')[0].getValue();
                    rentt.OwnerName=Ext.ComponentQuery.query('#Bus_Reg_T4HouseOwnerName')[0].getValue();
                    rentt.HouseArea=Ext.ComponentQuery.query('#Bus_Reg_T4RoomSize')[0].getValue();
                    rentt.HouseNo=Ext.ComponentQuery.query('#Bus_Reg_T4KittaNo')[0].getValue();
                    rentt.RentalAmount=Ext.ComponentQuery.query('#Bus_Reg_T4Rent')[0].getValue()?Ext.ComponentQuery.query('#Bus_Reg_T4Rent')[0].getValue():null;
                    rentt.RentedDate=Ext.ComponentQuery.query('#Bus_Reg_T4RentalDate')[0].getValue();
                    rentt.Action=rentt.Action=='A'?'A':'E';
                    //rent.RentAddress=rentAddress;

                    //

                    //start businessTypes
                    business.BusinessTypes=getJson(busDetListStore);
                    //end businessTypes
                    //start business
                    business.Type=busType;
                    business.TradeNameNepali=Ext.ComponentQuery.query('#Bus_Reg_FirmNameNepali')[0].getValue();
                    business.TradeNameEnglish=Ext.ComponentQuery.query('#Bus_Reg_FirmNameEnglish')[0].getValue();
                    business.RegDate=Ext.ComponentQuery.query('#Bus_Reg_RegDate')[0].getValue();
                    business.RegNumber=Ext.ComponentQuery.query('#Bus_Reg_RegNo')[0].getValue();
                    business.RegOffice=Ext.ComponentQuery.query('#Bus_Reg_OfficePlace')[0].getValue();
                    business.RegPlace=Ext.ComponentQuery.query('#Bus_Reg_OfficePlace')[0].getValue();
                    business.StartDate=Ext.ComponentQuery.query('#Bus_Reg_BusStartDate')[0].getValue();
                    business.BusinessReceivedFrom=Ext.ComponentQuery.query('#Bus_Reg_TransfererOrg')[0].getValue();        
                    business.BusinessTransferredDate=Ext.ComponentQuery.query('#Bus_Reg_transferDate')[0].getValue();
                    business.IsMainBusiness='true';        
                    business.Action=business.Action=='A'?"A":"E";       

                    //end business
                    busList=[business];

                    //-------

                }



                var taxxInfo={SubmissionNo:subNo,TaxpayerType:businessSubTyp,TaxpayerCategoryID:busType};

                Ext.Ajax.request({
                    url: '../Handlers/Registration/BusinessHandler.ashx?method=SaveBusinesses',
                    timeout:60000,
                    params: {
                        businesses:JSON.stringify( busList),
                        taxpayerInfo:JSON.stringify( taxxInfo)
                    },
                    success: function(response){
                        var text = response.responseText;
                        var resp=Ext.decode(text);  

                        if(resp.success=='True'||resp.success=='true')
                        {
                            msg("Status","Business Information Successfully Saved.");
                            Ext.ComponentQuery.query('#Bus_Reg_Next')[0].enable();
                            Ext.ComponentQuery.query('#Bus_Reg_PanAction')[0].setValue('E');
                            me.ReloadForm();
                        }
                        else
                        {
                            msg("FAILURE","Business Information Saving Failed.");
                        }
                    },
                    failure: function ( result, request ) {
                        msg("FAILURE","Business Information Saving Failed.");        
                    }
                });   
            }    

        }

    },

    onBus_Reg_btnSubmitClick: function(button, e, eOpts) {
        var nepServerDate=document.getElementById('nepDate').innerHTML;
        var me=this; 

        Ext.Msg.confirm('Confirm Action',
        'एकपटक Submit गरिसकेपछि अर्को पटक विवरण फेरि परिवर्तन गर्न पइने छैन। \n के तपाई Submit गर्न चाहनुहन्छ ?',
        function(btn) {
            if(btn == 'yes'){
                //////

                var busReg=Ext.getCmp('BusinessRegistration');
                if(busReg.extraParam)   
                {    
                    var subNo = busReg.extraParam.subNo; 
                    var busType=busReg.extraParam.busTyp;
                    var businessSubTyp=busReg.extraParam.busSubTyp;
                    var busList=[];
                    var store=Ext.ComponentQuery.query('#Bus_Reg_BusinessList')[0].getStore();


                    if(busType=='I')
                    {
                        if(store.getCount()<1)
                        {
                            msg("WARNING","Business Missing.");
                            return;
                        }
                        if(store.findExact('IsMainBusiness',true)<0)
                        {
                            msg("WARNING","Main Business Missing.");
                            return;
                        }
                        var cc=0;
                        store.each(function(record,idx){
                            if(record.get('IsMainBusiness')==true)
                            {
                                cc++;        
                            }

                        });
                        if(cc>1)
                        {
                            msg("WARNING","There Can Be Only One Main Business.");
                            return;
                        }


                        store.clearFilter();
                        busList=getJson(store); 
                        store.filter(function(item){
                            return item.get("Action")!= 'D';
                        });




                        Ext.Ajax.request({
                            url: '../Handlers/Registration/BusinessHandler.ashx?method=SaveBusinesses',
                            params: {
                                businesses:JSON.stringify( busList)
                            },
                            success: function(response){
                                var text = response.responseText;
                                var resp=Ext.decode(text);               

                                if(resp.success=='True'||resp.success=='true')
                                {   
                                    Ext.Ajax.request({
                                        url: '../Handlers/Registration/RegSubmissionNoHandler.ashx?method=SubmitRegistration',
                                        params:{submissionNo:subNo},
                                        // params:'',
                                        success: function ( ressponse ) {
                                            var respp = ressponse.responseText;
                                            var dta=Ext.decode(respp);   
                                            if(dta.root.success=='true'||dta.root.success=='True'||dta.root.success)
                                            {  

                                                msg("Status","Registration Information Saved And Submitted Successfully.");
                                            }
                                            else
                                            {
                                                me.submitMessage(dta.root);
                                            }
                                            me.ReloadForm();
                                        },
                                        failure: function ( result, request ) {
                                            me.ReloadForm();
                                            msg("FAILURE","Registration Information Saved Successfully But Submission Failed.");
                                        }

                                    });

                                    //888
                                    //msg("Status","Registration Submitted Successfully.");
                                    //Ext.ComponentQuery.query('#Bus_Reg_Next')[0].enable();
                                    //me.ReloadForm(); 
                                    //888
                                }
                                else
                                {
                                    msg("FAILURE","Registration Information Save and  Submission Failed.");
                                }
                            },
                            failure: function ( result, request ) {
                                msg("FAILURE","Registration Information Save and  Submission Failed.");    
                            }
                        }); 
                    }
                    else
                    {
                        var saveAction=Ext.ComponentQuery.query('#Bus_Reg_PanAction')[0].getValue();
                        var Bus_Reg_Contact_1= Ext.getStore('Bus_Reg_Contact_1');
                        var Bus_Reg_Contact_2= Ext.getStore('Bus_Reg_Contact_2');
                        var Bus_Reg_Contact_4= Ext.getStore('Bus_Reg_Contact_4');
                        var Bus_Reg_Contact_5= Ext.getStore('Bus_Reg_Contact_5');
                        var Bus_Reg_Contact_Rent= Ext.getStore('Bus_Reg_Contact_Rent');
                        var busDetListStore= Ext.getStore('Bus_Reg_T3BusDetListStore');

                        if(saveAction=="A")
                        {
                            //*****
                            //Business Field
                            var TradeNameNepali=Ext.ComponentQuery.query('#Bus_Reg_FirmNameNepali')[0].getValue();

                            //MainOffice address Field
                            var MainOfficeDistrictCode=Ext.ComponentQuery.query('#Bus_Reg_T1District')[0].getValue();
                            // var MainOfficeAreaCode=Ext.ComponentQuery.query('#Bus_Reg_T1Region')[0].getValue(); 

                            //BusinessMainPlace address Field  
                            var BusinessMainPlaceDistrictCode=Ext.ComponentQuery.query('#Bus_Reg_T2District')[0].getValue();   
                            //var BusinessMainPlaceAreaCode=Ext.ComponentQuery.query('#Bus_Reg_T2Region')[0].getValue(); 

                            //BusinessPersonnel Address Field
                            var BusinessPersonnelDistrictCode=Ext.ComponentQuery.query('#Bus_Reg_T51_Child_District')[0].getValue();    
                            //var BusinessPersonnelAreaCode:Ext.ComponentQuery.query('#Bus_Reg_T51_Child_Region')[0].getValue();

                            //BusinessPersonnel Field
                            var BusinessPersonnelFirstNameNep=Ext.ComponentQuery.query('#Bus_Reg_T51FirstNameNepali')[0].getValue();    
                            var BusinessPersonnelLastNameNep=Ext.ComponentQuery.query('#Bus_Reg_T51LastNameNepali')[0].getValue();

                            //BusinessPersonnelForIT Address Field
                            var BusinessPersonnelForITDistrictCode=Ext.ComponentQuery.query('#Bus_Reg_T52_Child_District')[0].getValue();    
                            //var BusinessPersonnelForITAreaCode:Ext.ComponentQuery.query('#Bus_Reg_T52_Child_Region')[0].getValue();


                            //BusinessPersonnelForIT Field
                            var BusinessPersonnelForITFirstNameNep=Ext.ComponentQuery.query('#Bus_Reg_T52FirstNameNepali')[0].getValue();    
                            var BusinessPersonnelForITLastNameNep=Ext.ComponentQuery.query('#Bus_Reg_T52LastNameNepali')[0].getValue();


                            var errMsg="";
                            var errCount=0;
                            if(!TradeNameNepali)
                            {
                                errCount++;
                                errMsg +=errCount+") "+"TradeName (in Nepali) is required.<br/>";
                            }
                            if(!MainOfficeDistrictCode)
                            {
                                errCount++;
                                errMsg +=errCount+") "+"District of main office  is required.<br/>";
                            }
                            if(!BusinessMainPlaceDistrictCode)
                            {
                                errCount++;
                                errMsg +=errCount+") "+"District of Business's main place is required.<br/>";
                            }
                            if(!BusinessPersonnelDistrictCode)
                            {
                                errCount++;
                                errMsg +=errCount+") "+"District of Business personnel is required.<br/>";
                            }
                            if(!BusinessPersonnelFirstNameNep)
                            {
                                errCount++;
                                errMsg +=errCount+") "+"First name (in nepali) of Business personnel is required.<br/>";
                            }
                            if(!BusinessPersonnelLastNameNep)
                            {
                                errCount++;
                                errMsg +=errCount+") "+"Last name (in nepali) of Business personnel is required.<br/>";
                            }
                            if(!BusinessPersonnelForITDistrictCode)
                            {
                                errCount++;
                                errMsg +=errCount+") "+"District of Business personnel for IT is required.<br/>";
                            }
                            if(!BusinessPersonnelForITFirstNameNep)
                            {
                                errCount++;
                                errMsg +=errCount+") "+"First name (in nepali) of Business personnel for IT is required.<br/>";
                            }
                            if(!BusinessPersonnelForITLastNameNep)
                            {
                                errCount++;
                                errMsg +=errCount+") "+"Last name (in nepali) of Business personnel for IT is required.<br/>";
                            }

                            if(errCount>0)
                            {
                                msg("WARNING",errMsg);    
                                return false;
                            }

                            var businessTyp="";
                            var submissionNo="";
                            var busrez=Ext.getCmp('BusinessRegistration');
                            if(busrez.extraParam)   
                            {
                                submissionNo = Ext.getCmp('BusinessRegistration').extraParam.subNo;
                                businessTyp = Ext.getCmp('BusinessRegistration').extraParam.busTyp;  
                            }


                            var businessListStore=Ext.ComponentQuery.query('#Bus_Reg_BusinessList')[0].getStore();
                            var busDetListStore= Ext.getStore('Bus_Reg_T3BusDetListStore');

                            var selection=Ext.ComponentQuery.query('#Bus_Reg_BusinessList')[0].getSelectionModel().getSelection();


                            var locationType="";
                            if(Ext.ComponentQuery.query('#Bus_Reg_T1LocationType1')[0].checked)
                            {
                                locationType="VD";
                            }
                            else if(Ext.ComponentQuery.query('#Bus_Reg_T1LocationType2')[0].checked)
                            {
                                locationType="MN";
                            }
                            else if(Ext.ComponentQuery.query('#Bus_Reg_T1LocationType3')[0].checked)
                            {
                                locationType="MM";
                            }
                            else if(Ext.ComponentQuery.query('#Bus_Reg_T1LocationType4')[0].checked)
                            {
                                locationType="SM";
                            }
                            var MainOfficePlaceAddress =
                            {
                                AddressSNO:0, //not Null field
                                HouseNo:Ext.ComponentQuery.query('#Bus_Reg_T1HouseNo')[0].getValue(),
                                WardNo:Ext.ComponentQuery.query('#Bus_Reg_T1WardNo')[0].getValue()?Ext.ComponentQuery.query('#Bus_Reg_T1WardNo')[0].getValue():null,
                                StreetName:Ext.ComponentQuery.query('#Bus_Reg_T1Tole')[0].getValue(),
                                VdcTown:Ext.ComponentQuery.query('#Bus_Reg_T1VDC')[0].getValue(),
                                LocationType:locationType,
                                DistrictCode:Ext.ComponentQuery.query('#Bus_Reg_T1District')[0].getValue(), //not Null field
                                Telephone:Bus_Reg_Contact_1.getAt(3).data.Value,
                                // AreaCode:'01',//Ext.ComponentQuery.query('#Bus_Reg_T1Region')[0].getValue(), //not Null field
                                AreaCode:Ext.ComponentQuery.query('#Bus_Reg_T1Region')[0].getValue(), //not Null field
                                Fax:Bus_Reg_Contact_1.getAt(1).data.Value,
                                Email:Bus_Reg_Contact_1.getAt(0).data.Value,
                                PoBox:null,
                                ExpiryDate:null,
                                UserId:'ITS',  //not Null field
                                TranDate:null,    
                                TranNo:null,
                                submissionNo:submissionNo,
                                Action:saveAction
                            };

                            var MainOfficePlace=
                            {
                                SubmissionNo:submissionNo,
                                Business_SNO:0,
                                AddressSNO:0,
                                AddressType:'OA',
                                FromDate:nepServerDate,
                                ToDate:null,
                                Status:'S',
                                TranNo:null,
                                Action:saveAction,
                                Address:MainOfficePlaceAddress
                            };

                            var locationType1="";
                            if(Ext.ComponentQuery.query('#Bus_Reg_T2LocationType1')[0].checked)
                            {
                                locationType1="VD";
                            }
                            else if(Ext.ComponentQuery.query('#Bus_Reg_T2LocationType2')[0].checked)
                            {
                                locationType1="MN";
                            }
                            else if(Ext.ComponentQuery.query('#Bus_Reg_T2LocationType3')[0].checked)
                            {
                                locationType1="MM";
                            }
                            else if(Ext.ComponentQuery.query('#Bus_Reg_T2LocationType4')[0].checked)
                            {
                                locationType1="SM";
                            }
                            var MainBusinessPlaceAddress=
                            {
                                AddressSNO:0,
                                HouseNo:Ext.ComponentQuery.query('#Bus_Reg_T2HouseNo ')[0].getValue(),
                                WardNo:Ext.ComponentQuery.query('#Bus_Reg_T2WardNo')[0].getValue()?Ext.ComponentQuery.query('#Bus_Reg_T2WardNo')[0].getValue():null,
                                StreetName:Ext.ComponentQuery.query('#Bus_Reg_T2Tole')[0].getValue(),
                                VdcTown:Ext.ComponentQuery.query('#Bus_Reg_T2VDC')[0].getValue(),
                                LocationType:locationType1,
                                DistrictCode:Ext.ComponentQuery.query('#Bus_Reg_T2District')[0].getValue(),
                                Telephone:Bus_Reg_Contact_2.getAt(3).data.Value,
                                //AreaCode:'01',//Ext.ComponentQuery.query('#Bus_Reg_T2Region')[0].getValue(),
                                AreaCode:Ext.ComponentQuery.query('#Bus_Reg_T2Region')[0].getValue(),
                                Fax:Bus_Reg_Contact_2.getAt(1).data.Value,
                                Email:Bus_Reg_Contact_2.getAt(0).data.Value,
                                PoBox:null,
                                ExpiryDate:null,
                                UserId:'ITS',//null,
                                TranDate:null,    
                                TranNo:null,
                                submissionNo:submissionNo,
                                Action:saveAction
                            };

                            var MainBusinessPlace=
                            {
                                SubmissionNo:submissionNo,
                                Business_SNO:0,
                                AddressSNO:0,
                                AddressType:'BA',
                                FromDate:nepServerDate,
                                ToDate:null,
                                Status:'S',
                                TranNo:null,
                                Action:saveAction,
                                Address:MainBusinessPlaceAddress
                            };  

                            var locationType2="";
                            if(Ext.ComponentQuery.query('#Bus_Reg_T51LocationType1')[0].checked)
                            {
                                locationType2="VD";
                            }
                            else if(Ext.ComponentQuery.query('#Bus_Reg_T51LocationType2')[0].checked)
                            {
                                locationType2="MN";
                            }
                            else if(Ext.ComponentQuery.query('#Bus_Reg_T51LocationType3')[0].checked)
                            {
                                locationType2="MM";
                            }
                            else if(Ext.ComponentQuery.query('#Bus_Reg_T51LocationType4')[0].checked)
                            {
                                locationType2="SM";
                            }
                            var BusinessPersonnelAddress1Address=
                            {
                                AddressSNO:0,
                                HouseNo:Ext.ComponentQuery.query('#Bus_Reg_T51_Child_HouseNo')[0].getValue(),
                                WardNo:Ext.ComponentQuery.query('#Bus_Reg_T51_Child_WardNo')[0].getValue()?Ext.ComponentQuery.query('#Bus_Reg_T51_Child_WardNo')[0].getValue():null,
                                StreetName:Ext.ComponentQuery.query('#Bus_Reg_T51_Child_Tole')[0].getValue(),
                                VdcTown:Ext.ComponentQuery.query('#Bus_Reg_T51_Child_VDC')[0].getValue(),
                                LocationType:locationType2,
                                DistrictCode:Ext.ComponentQuery.query('#Bus_Reg_T51_Child_District')[0].getValue(),
                                Telephone:Bus_Reg_Contact_4.getAt(3).data.Value,
                                AreaCode:'00',//Ext.ComponentQuery.query('#Bus_Reg_T51_Child_Region')[0].getValue(),
                                Fax:Bus_Reg_Contact_4.getAt(1).data.Value,
                                Email:Bus_Reg_Contact_4.getAt(0).data.Value,
                                PoBox:null,
                                ExpiryDate:null,
                                UserId:'ITS',//null,
                                TranDate:null,    
                                TranNo:null,
                                submissionNo:submissionNo,
                                Action:saveAction
                            };

                            var BusinessPersonnelAddress1=
                            {
                                SubmissionNo:submissionNo,
                                Business_SNO:0,
                                BusinessPersonnelType:'CH',
                                FromDateHas:null,
                                Sno:0,
                                AddressSNO:0,
                                FromDate:nepServerDate,
                                ToDate:null,
                                Status:'',
                                TranNo:null,
                                Action:saveAction,
                                Address:BusinessPersonnelAddress1Address
                            };

                            var BusinessPersonnel=
                            {
                                SubmissionNo:submissionNo,
                                BusinessSNO:0,
                                BusPerType:'CH',
                                FromDate:nepServerDate,
                                SNo:0,
                                ToDate:null,
                                FirstNameEng:Ext.ComponentQuery.query('#Bus_Reg_T51FirstNameEnglish')[0].getValue(),
                                MiddleNameEng:Ext.ComponentQuery.query('#Bus_Reg_T51MiddleNameEnglish')[0].getValue(),
                                LastNameEng:Ext.ComponentQuery.query('#Bus_Reg_T51LastNameEnglish')[0].getValue(),
                                FirstNameNep:Ext.ComponentQuery.query('#Bus_Reg_T51FirstNameNepali')[0].getValue(),
                                MiddleNameNep:Ext.ComponentQuery.query('#Bus_Reg_T51MiddleNameNepali')[0].getValue(),
                                LastNameNep:Ext.ComponentQuery.query('#Bus_Reg_T51LastNameNepali')[0].getValue(),
                                TranNo:null,
                                Action:saveAction,
                                BusinessPersonnelAddress:BusinessPersonnelAddress1,
                                AppointedDate:Ext.ComponentQuery.query('#Bus_Reg_T51AppointedDate')[0].getValue(),
                                IdDocument:Ext.ComponentQuery.query('#Bus_Reg_T51PaperType')[0].getValue(),
                                IdNumber:Ext.ComponentQuery.query('#Bus_Reg_T51IdentityNo')[0].getValue(),
                                IdIssueAuthority:Ext.ComponentQuery.query('#Bus_Reg_T51IssuedByOrg')[0].getValue(),
                                IdIssueDate:Ext.ComponentQuery.query('#Bus_Reg_T51IssuedDate')[0].getValue(),
                                IdIssuePlace:Ext.ComponentQuery.query('#Bus_Reg_T51IssuedByOrgPlace')[0].getValue(),
                                Document:"",
                                DocNameUnique:Ext.ComponentQuery.query('#Bus_Reg_T51DocumentTxt')[0].fullName,
                                DocName:Ext.ComponentQuery.query('#Bus_Reg_T51DocumentTxt')[0].getValue(),
                                Post:""
                            };


                            var locationType3="";
                            if(Ext.ComponentQuery.query('#Bus_Reg_T52LocationType1')[0].checked)
                            {
                                locationType3="VD";
                            }
                            else if(Ext.ComponentQuery.query('#Bus_Reg_T52LocationType2')[0].checked)
                            {
                                locationType3="MN";
                            }
                            else if(Ext.ComponentQuery.query('#Bus_Reg_T52LocationType3')[0].checked)
                            {
                                locationType3="MM";
                            }
                            else if(Ext.ComponentQuery.query('#Bus_Reg_T52LocationType4')[0].checked)
                            {
                                locationType3="SM";
                            }
                            var BusinessPersonnelAddress2Address=
                            {
                                AddressSNO:0,
                                HouseNo:Ext.ComponentQuery.query('#Bus_Reg_T52_Child_HouseNo')[0].getValue(),
                                WardNo:Ext.ComponentQuery.query('#Bus_Reg_T52_Child_WardNo')[0].getValue()?Ext.ComponentQuery.query('#Bus_Reg_T52_Child_WardNo')[0].getValue():null,
                                StreetName:Ext.ComponentQuery.query('#Bus_Reg_T52_Child_Tole')[0].getValue(),
                                VdcTown:Ext.ComponentQuery.query('#Bus_Reg_T52_Child_VDC')[0].getValue(),
                                LocationType:locationType3,
                                DistrictCode:Ext.ComponentQuery.query('#Bus_Reg_T52_Child_District')[0].getValue(),
                                Telephone:Bus_Reg_Contact_5.getAt(3).data.Value,
                                AreaCode:'00',//Ext.ComponentQuery.query('#Bus_Reg_T52_Child_Region')[0].getValue(),
                                Fax:Bus_Reg_Contact_5.getAt(1).data.Value,
                                Email:Bus_Reg_Contact_5.getAt(0).data.Value,
                                PoBox:null,
                                ExpiryDate:null,
                                UserId:'ITS',//null,
                                TranDate:null,   
                                TranNo:null,
                                submissionNo:submissionNo,
                                Action:saveAction
                            };

                            var BusinessPersonnelAddress2=
                            {
                                SubmissionNo:submissionNo,
                                Business_SNO:0,
                                BusinessPersonnelType:'CP',
                                FromDateHas:'',
                                Sno:0,
                                AddressSNO:0,
                                FromDate:nepServerDate,
                                ToDate:null,
                                Status:'S',
                                TranNo:null,
                                Action:saveAction,
                                Address:BusinessPersonnelAddress2Address
                            };

                            var BusinessPersonnelForIT=
                            {
                                SubmissionNo:submissionNo,
                                Business_SNO:0,
                                BusPerType:'CP',
                                FromDate:nepServerDate,
                                SNo:0,
                                ToDate:null,
                                FirstNameEng:Ext.ComponentQuery.query('#Bus_Reg_T52FirstNameEnglish')[0].getValue(),
                                MiddleNameEng:Ext.ComponentQuery.query('#Bus_Reg_T52MiddleNameEnglish')[0].getValue(),
                                LastNameEng:Ext.ComponentQuery.query('#Bus_Reg_T52LastNameEnglish')[0].getValue(),
                                FirstNameNep:Ext.ComponentQuery.query('#Bus_Reg_T52FirstNameNepali')[0].getValue(),
                                MiddleNameNep:Ext.ComponentQuery.query('#Bus_Reg_T52MiddleNameNepali')[0].getValue(),
                                LastNameNep:Ext.ComponentQuery.query('#Bus_Reg_T52LastNameNepali')[0].getValue(),
                                TranNo:null,
                                Action:saveAction,
                                BusinessPersonnelAddress:BusinessPersonnelAddress2,
                                AppointedDate:Ext.ComponentQuery.query('#Bus_Reg_T52AppointedDate')[0].getValue(),
                                IdDocument:Ext.ComponentQuery.query('#Bus_Reg_T52PaperType')[0].getValue(),
                                IdNumber:Ext.ComponentQuery.query('#Bus_Reg_T52IdentityNo')[0].getValue(),
                                IdIssueAuthority:Ext.ComponentQuery.query('#Bus_Reg_T52IssuedByOrg')[0].getValue(),
                                IdIssueDate:Ext.ComponentQuery.query('#Bus_Reg_T52IssuedDate')[0].getValue(),
                                IdIssuePlace:Ext.ComponentQuery.query('#Bus_Reg_T52IssuedByOrgPlace')[0].getValue(),
                                Document:"",
                                DocNameUnique:Ext.ComponentQuery.query('#Bus_Reg_T52DocumentTxt')[0].fullName,
                                DocName:Ext.ComponentQuery.query('#Bus_Reg_T52DocumentTxt')[0].getValue(),
                                Post:Ext.ComponentQuery.query('#Bus_Reg_T52Post')[0].getValue()
                            };

                            //start rent
                            var locationTypeRent="";
                            if(Ext.ComponentQuery.query('#Bus_Reg_T4LocationType1')[0].checked)
                            {
                                locationTypeRent="VD";
                            }
                            else if(Ext.ComponentQuery.query('#Bus_Reg_T4LocationType2')[0].checked)
                            {
                                locationTypeRent="MN";
                            }
                            else if(Ext.ComponentQuery.query('#Bus_Reg_T4LocationType3')[0].checked)
                            {
                                locationTypeRent="MM";
                            }
                            else if(Ext.ComponentQuery.query('#Bus_Reg_T4LocationType4')[0].checked)
                            {
                                locationTypeRent="SM";
                            }
                            var rentAddressAddr=
                            {
                                AddressSNO:0,
                                HouseNo:Ext.ComponentQuery.query('#Bus_Reg_T4_Child_HouseNo')[0].getValue(),
                                WardNo:Ext.ComponentQuery.query('#Bus_Reg_T4_Child_WardNo')[0].getValue()?Ext.ComponentQuery.query('#Bus_Reg_T4_Child_WardNo')[0].getValue():null,
                                StreetName:Ext.ComponentQuery.query('#Bus_Reg_T4_Child_Tole')[0].getValue(),
                                VdcTown:Ext.ComponentQuery.query('#Bus_Reg_T4_Child_VDC')[0].getValue(),
                                LocationType:locationTypeRent,
                                DistrictCode:Ext.ComponentQuery.query('#Bus_Reg_T4_Child_District')[0].getValue(),
                                Telephone:Bus_Reg_Contact_Rent.getAt(3).data.Value,
                                AreaCode:'00',
                                Fax:Bus_Reg_Contact_Rent.getAt(1).data.Value,
                                Email:Bus_Reg_Contact_Rent.getAt(0).data.Value,
                                PoBox:null,
                                ExpiryDate:null,
                                UserId:'ITS',//null,
                                TranDate:null,   
                                TranNo:null,
                                submissionNo:submissionNo,
                                Action:saveAction
                            };
                            var rentAddress=
                            {
                                SubmissionNo:submissionNo,
                                Business_SNO:0,
                                AddressSNO:0,                    
                                Action:saveAction,
                                Address:rentAddressAddr
                            };

                            var rent=
                            {
                                SubmissionNo:submissionNo,
                                Business_SNO:0,
                                OwnerPAN:Ext.ComponentQuery.query('#Bus_Reg_T4HouseOwnerPanNo')[0].getValue(),
                                OwnerName:Ext.ComponentQuery.query('#Bus_Reg_T4HouseOwnerName')[0].getValue(),
                                HouseArea:Ext.ComponentQuery.query('#Bus_Reg_T4RoomSize')[0].getValue(),
                                HouseNo:Ext.ComponentQuery.query('#Bus_Reg_T4KittaNo')[0].getValue(),
                                RentalAmount:Ext.ComponentQuery.query('#Bus_Reg_T4Rent')[0].getValue()?Ext.ComponentQuery.query('#Bus_Reg_T4Rent')[0].getValue():null,
                                RentedDate:Ext.ComponentQuery.query('#Bus_Reg_T4RentalDate')[0].getValue(),
                                Action:saveAction,
                                RentAddress:rentAddress
                            };
                            //

                            var Business=
                            {   
                                SubmissionNo:submissionNo,
                                Type:busType,
                                Business_SNO:0,
                                TradeNameNepali:Ext.ComponentQuery.query('#Bus_Reg_FirmNameNepali')[0].getValue(),
                                TradeNameEnglish:Ext.ComponentQuery.query('#Bus_Reg_FirmNameEnglish')[0].getValue(),
                                RegDate:Ext.ComponentQuery.query('#Bus_Reg_RegDate')[0].getValue(),
                                RegNumber:Ext.ComponentQuery.query('#Bus_Reg_RegNo')[0].getValue(),                
                                RegOffice:Ext.ComponentQuery.query('#Bus_Reg_OfficePlace')[0].getValue(),
                                RegPlace:Ext.ComponentQuery.query('#Bus_Reg_OfficePlace')[0].getValue(),
                                StartDate:Ext.ComponentQuery.query('#Bus_Reg_BusStartDate')[0].getValue(),
                                BusinessReceivedFrom:Ext.ComponentQuery.query('#Bus_Reg_TransfererOrg')[0].getValue(),
                                BusinessReceivedDate:null,
                                BusinessTransferredTo:null,
                                BusinessTransferredDate:Ext.ComponentQuery.query('#Bus_Reg_transferDate')[0].getValue(),
                                IsMainBusiness:'true',
                                Status:null,
                                UserID:'ITS',
                                TranDate:null,
                                TranNo:null,
                                Action:saveAction,
                                MainOfficePlace:MainOfficePlace,
                                MainBusinessPlace:MainBusinessPlace,
                                BusinessTypes:getJson(busDetListStore),
                                BusinessPersonnel:BusinessPersonnel,
                                BusinessPersonnelForIT:BusinessPersonnelForIT,
                                Rent:rent
                            };       

                            busList=[Business];     






                            //*****     
                        }
                        else
                        {

                            //-------
                            var selectedIndex= 0;


                            var businessListStore=Ext.ComponentQuery.query('#Bus_Reg_BusinessList')[0].getStore();
                            var business=businessListStore.getAt(selectedIndex).data;

                            var mainOfficePlace=business.MainOfficePlace;
                            var mainOfficePlaceAddress=mainOfficePlace.Address;

                            var mainBusinessPlace=business.MainBusinessPlace;
                            var mainBusinessPlaceAddress=mainBusinessPlace.Address;



                            var businessPersonnel=business.BusinessPersonnel;
                            var businessPersonnelAddress=businessPersonnel.BusinessPersonnelAddress;
                            var businessPersonnelAddressAddress=businessPersonnelAddress.Address;

                            var businessPersonnelForIT=business.BusinessPersonnelForIT;
                            var businessPersonnelForITAddress=businessPersonnelForIT.BusinessPersonnelAddress;
                            var businessPersonnelForITAddressAddress=businessPersonnelForITAddress.Address;

                            var rentt=business.Rent;
                            var renttAddress=rentt.RentAddress;
                            var renttAddressAddr=renttAddress.Address;




                            // start mainofficeplaceaddress

                            var locationType="";
                            if(Ext.ComponentQuery.query('#Bus_Reg_T1LocationType1')[0].checked)
                            {
                                locationType="VD";
                            }
                            else if(Ext.ComponentQuery.query('#Bus_Reg_T1LocationType2')[0].checked)
                            {
                                locationType="MN";
                            }
                            else if(Ext.ComponentQuery.query('#Bus_Reg_T1LocationType3')[0].checked)
                            {
                                locationType="MM";
                            }
                            else if(Ext.ComponentQuery.query('#Bus_Reg_T1LocationType4')[0].checked)
                            {
                                locationType="SM";
                            }

                            mainOfficePlaceAddress.HouseNo=Ext.ComponentQuery.query('#Bus_Reg_T1HouseNo')[0].getValue();
                            mainOfficePlaceAddress.WardNo=Ext.ComponentQuery.query('#Bus_Reg_T1WardNo')[0].getValue()?Ext.ComponentQuery.query('#Bus_Reg_T1WardNo')[0].getValue():null;
                            mainOfficePlaceAddress.StreetName=Ext.ComponentQuery.query('#Bus_Reg_T1Tole')[0].getValue();
                            mainOfficePlaceAddress.VdcTown=Ext.ComponentQuery.query('#Bus_Reg_T1VDC')[0].getValue();
                            mainOfficePlaceAddress.LocationType=locationType;//null,
                            mainOfficePlaceAddress.DistrictCode=Ext.ComponentQuery.query('#Bus_Reg_T1District')[0].getValue(); //not Null field
                            mainOfficePlaceAddress.Telephone=Bus_Reg_Contact_1.getAt(3).data.Value;
                            //mainOfficePlaceAddress.AreaCode='01';//Ext.ComponentQuery.query('#Bus_Reg_T1Region')[0].getValue(), //not Null field
                            mainOfficePlaceAddress.AreaCode=Ext.ComponentQuery.query('#Bus_Reg_T1Region')[0].getValue(); //not Null field
                            mainOfficePlaceAddress.Fax=Bus_Reg_Contact_1.getAt(1).data.Value;
                            mainOfficePlaceAddress.Email=Bus_Reg_Contact_1.getAt(0).data.Value;       

                            mainOfficePlaceAddress.Action=mainOfficePlaceAddress.Action=='A'?'A':'E'; 
                            // end mainofficeplaceaddress
                            //start businessmainplaceaddress

                            var locationType1="";
                            if(Ext.ComponentQuery.query('#Bus_Reg_T2LocationType1')[0].checked)
                            {
                                locationType1="VD";
                            }
                            else if(Ext.ComponentQuery.query('#Bus_Reg_T2LocationType2')[0].checked)
                            {
                                locationType1="MN";
                            }
                            else if(Ext.ComponentQuery.query('#Bus_Reg_T2LocationType3')[0].checked)
                            {
                                locationType1="MM";
                            }
                            else if(Ext.ComponentQuery.query('#Bus_Reg_T2LocationType4')[0].checked)
                            {
                                locationType1="SM";
                            }
                            mainBusinessPlaceAddress.HouseNo=Ext.ComponentQuery.query('#Bus_Reg_T2HouseNo')[0].getValue();
                            mainBusinessPlaceAddress.WardNo=Ext.ComponentQuery.query('#Bus_Reg_T2WardNo')[0].getValue()?Ext.ComponentQuery.query('#Bus_Reg_T2WardNo')[0].getValue():null;
                            mainBusinessPlaceAddress.StreetName=Ext.ComponentQuery.query('#Bus_Reg_T2Tole')[0].getValue();
                            mainBusinessPlaceAddress.VdcTown=Ext.ComponentQuery.query('#Bus_Reg_T2VDC')[0].getValue();
                            mainBusinessPlaceAddress.LocationType=locationType1;
                            mainBusinessPlaceAddress.DistrictCode=Ext.ComponentQuery.query('#Bus_Reg_T2District')[0].getValue(); //not Null field
                            mainBusinessPlaceAddress.Telephone=Bus_Reg_Contact_2.getAt(3).data.Value;
                            //mainBusinessPlaceAddress.AreaCode='01';//Ext.ComponentQuery.query('#Bus_Reg_T1Region')[0].getValue(), //not Null field
                            mainBusinessPlaceAddress.AreaCode=Ext.ComponentQuery.query('#Bus_Reg_T2Region')[0].getValue(); //not Null field
                            mainBusinessPlaceAddress.Fax=Bus_Reg_Contact_2.getAt(1).data.Value;
                            mainBusinessPlaceAddress.Email=Bus_Reg_Contact_2.getAt(0).data.Value;        
                            mainBusinessPlaceAddress.Action=mainBusinessPlaceAddress.Action=='A'?'A':'E'; 
                            //end businessmainplaceaddress    

                            //start businesspersonnelAddressAddress

                            var locationType2="";
                            if(Ext.ComponentQuery.query('#Bus_Reg_T51LocationType1')[0].checked)
                            {
                                locationType2="VD";
                            }
                            else if(Ext.ComponentQuery.query('#Bus_Reg_T51LocationType2')[0].checked)
                            {
                                locationType2="MN";
                            }
                            else if(Ext.ComponentQuery.query('#Bus_Reg_T51LocationType3')[0].checked)
                            {
                                locationType2="MM";
                            }
                            else if(Ext.ComponentQuery.query('#Bus_Reg_T51LocationType4')[0].checked)
                            {
                                locationType2="SM";
                            }
                            businessPersonnelAddressAddress.HouseNo=Ext.ComponentQuery.query('#Bus_Reg_T51_Child_HouseNo')[0].getValue();
                            businessPersonnelAddressAddress.WardNo=Ext.ComponentQuery.query('#Bus_Reg_T51_Child_WardNo')[0].getValue()?Ext.ComponentQuery.query('#Bus_Reg_T51_Child_WardNo')[0].getValue():null;
                            businessPersonnelAddressAddress.StreetName=Ext.ComponentQuery.query('#Bus_Reg_T51_Child_Tole')[0].getValue();
                            businessPersonnelAddressAddress.VdcTown=Ext.ComponentQuery.query('#Bus_Reg_T51_Child_VDC')[0].getValue();
                            businessPersonnelAddressAddress.LocationType=locationType2;
                            businessPersonnelAddressAddress.DistrictCode=Ext.ComponentQuery.query('#Bus_Reg_T51_Child_District')[0].getValue(); //not Null field
                            businessPersonnelAddressAddress.Telephone=Bus_Reg_Contact_4.getAt(3).data.Value;
                            businessPersonnelAddressAddress.AreaCode='00';//Ext.ComponentQuery.query('#Bus_Reg_T1Region')[0].getValue(), //not Null field
                            businessPersonnelAddressAddress.Fax=Bus_Reg_Contact_4.getAt(1).data.Value;
                            businessPersonnelAddressAddress.Email=Bus_Reg_Contact_4.getAt(0).data.Value;        
                            businessPersonnelAddressAddress.Action=businessPersonnelAddressAddress.Action=='A'?'A':'E';     

                            //end businesspersonnelAddressAddress
                            //start businesspersonnel
                            businessPersonnel.FirstNameEng=Ext.ComponentQuery.query('#Bus_Reg_T51FirstNameEnglish')[0].getValue();
                            businessPersonnel.MiddleNameEng=Ext.ComponentQuery.query('#Bus_Reg_T51MiddleNameEnglish')[0].getValue();
                            businessPersonnel.LastNameEng=Ext.ComponentQuery.query('#Bus_Reg_T51LastNameEnglish')[0].getValue();
                            businessPersonnel.FirstNameNep=Ext.ComponentQuery.query('#Bus_Reg_T51FirstNameNepali')[0].getValue();
                            businessPersonnel.MiddleNameNep=Ext.ComponentQuery.query('#Bus_Reg_T51MiddleNameNepali')[0].getValue();
                            businessPersonnel.LastNameNep=Ext.ComponentQuery.query('#Bus_Reg_T51LastNameNepali')[0].getValue();    
                            businessPersonnel.Action=businessPersonnel.Action=='A'?"A":"E";
                            businessPersonnel.AppointedDate=Ext.ComponentQuery.query('#Bus_Reg_T51AppointedDate')[0].getValue();
                            businessPersonnel.IdDocument=Ext.ComponentQuery.query('#Bus_Reg_T51PaperType')[0].getValue();
                            businessPersonnel.IdNumber=Ext.ComponentQuery.query('#Bus_Reg_T51IdentityNo')[0].getValue();
                            businessPersonnel.IdIssueAuthority=Ext.ComponentQuery.query('#Bus_Reg_T51IssuedByOrg')[0].getValue();
                            businessPersonnel.IdIssueDate=Ext.ComponentQuery.query('#Bus_Reg_T51IssuedDate')[0].getValue();
                            businessPersonnel.IdIssuePlace=Ext.ComponentQuery.query('#Bus_Reg_T51IssuedByOrgPlace')[0].getValue();
                            businessPersonnel.Document="";
                            businessPersonnel.DocNameUnique=Ext.ComponentQuery.query('#Bus_Reg_T51DocumentTxt')[0].fullName;
                            businessPersonnel.DocName=Ext.ComponentQuery.query('#Bus_Reg_T51DocumentTxt')[0].getValue();
                            businessPersonnel.Post='';

                            //end businesspersonnel

                            //start businesspersonnelForITAddressAddress

                            var locationType3="";
                            if(Ext.ComponentQuery.query('#Bus_Reg_T52LocationType1')[0].checked)
                            {
                                locationType3="VD";
                            }
                            else if(Ext.ComponentQuery.query('#Bus_Reg_T52LocationType2')[0].checked)
                            {
                                locationType3="MN";
                            }
                            else if(Ext.ComponentQuery.query('#Bus_Reg_T52LocationType3')[0].checked)
                            {
                                locationType3="MM";
                            }
                            else if(Ext.ComponentQuery.query('#Bus_Reg_T52LocationType4')[0].checked)
                            {
                                locationType3="SM";
                            }
                            businessPersonnelForITAddressAddress.HouseNo=Ext.ComponentQuery.query('#Bus_Reg_T52_Child_HouseNo')[0].getValue();
                            businessPersonnelForITAddressAddress.WardNo=Ext.ComponentQuery.query('#Bus_Reg_T52_Child_WardNo')[0].getValue()?Ext.ComponentQuery.query('#Bus_Reg_T52_Child_WardNo')[0].getValue():null;
                            businessPersonnelForITAddressAddress.StreetName=Ext.ComponentQuery.query('#Bus_Reg_T52_Child_Tole')[0].getValue();
                            businessPersonnelForITAddressAddress.VdcTown=Ext.ComponentQuery.query('#Bus_Reg_T52_Child_VDC')[0].getValue();
                            businessPersonnelForITAddressAddress.LocationType=locationType3;
                            businessPersonnelForITAddressAddress.DistrictCode=Ext.ComponentQuery.query('#Bus_Reg_T52_Child_District')[0].getValue(); //not Null field
                            businessPersonnelForITAddressAddress.Telephone=Bus_Reg_Contact_5.getAt(3).data.Value;
                            businessPersonnelForITAddressAddress.AreaCode='00';//Ext.ComponentQuery.query('#Bus_Reg_T1Region')[0].getValue(), //not Null field
                            businessPersonnelForITAddressAddress.Fax=Bus_Reg_Contact_5.getAt(1).data.Value;
                            businessPersonnelForITAddressAddress.Email=Bus_Reg_Contact_5.getAt(0).data.Value;        
                            businessPersonnelForITAddressAddress.Action=businessPersonnelForITAddressAddress.Action=='A'?'A':'E';     

                            //end businesspersonnelForITAddressAddress  
                            //start businesspersonnelForIT
                            businessPersonnelForIT.FirstNameEng=Ext.ComponentQuery.query('#Bus_Reg_T52FirstNameEnglish')[0].getValue();
                            businessPersonnelForIT.MiddleNameEng=Ext.ComponentQuery.query('#Bus_Reg_T52MiddleNameEnglish')[0].getValue();
                            businessPersonnelForIT.LastNameEng=Ext.ComponentQuery.query('#Bus_Reg_T52LastNameEnglish')[0].getValue();
                            businessPersonnelForIT.FirstNameNep=Ext.ComponentQuery.query('#Bus_Reg_T52FirstNameNepali')[0].getValue();
                            businessPersonnelForIT.MiddleNameNep=Ext.ComponentQuery.query('#Bus_Reg_T52MiddleNameNepali')[0].getValue();
                            businessPersonnelForIT.LastNameNep=Ext.ComponentQuery.query('#Bus_Reg_T52LastNameNepali')[0].getValue();    
                            businessPersonnelForIT.Action=businessPersonnelForIT.Action=='A'?"A":"E";
                            businessPersonnelForIT.AppointedDate=Ext.ComponentQuery.query('#Bus_Reg_T52AppointedDate')[0].getValue();
                            businessPersonnelForIT.IdDocument=Ext.ComponentQuery.query('#Bus_Reg_T52PaperType')[0].getValue();
                            businessPersonnelForIT.IdNumber=Ext.ComponentQuery.query('#Bus_Reg_T52IdentityNo')[0].getValue();
                            businessPersonnelForIT.IdIssueAuthority=Ext.ComponentQuery.query('#Bus_Reg_T52IssuedByOrg')[0].getValue();
                            businessPersonnelForIT.IdIssueDate=Ext.ComponentQuery.query('#Bus_Reg_T52IssuedDate')[0].getValue();
                            businessPersonnelForIT.IdIssuePlace=Ext.ComponentQuery.query('#Bus_Reg_T52IssuedByOrgPlace')[0].getValue();
                            businessPersonnelForIT.Document="";
                            businessPersonnelForIT.DocNameUnique=Ext.ComponentQuery.query('#Bus_Reg_T52DocumentTxt')[0].fullName;            
                            businessPersonnelForIT.DocName=Ext.ComponentQuery.query('#Bus_Reg_T52DocumentTxt')[0].getValue();
                            businessPersonnelForIT.Post=Ext.ComponentQuery.query('#Bus_Reg_T52Post')[0].getValue();

                            //end businesspersonnelForIT

                            //start rent
                            var locationTypeRent="";
                            if(Ext.ComponentQuery.query('#Bus_Reg_T4LocationType1')[0].checked)
                            {
                                locationTypeRent="VD";
                            }
                            else if(Ext.ComponentQuery.query('#Bus_Reg_T4LocationType2')[0].checked)
                            {
                                locationTypeRent="MN";
                            }
                            else if(Ext.ComponentQuery.query('#Bus_Reg_T4LocationType3')[0].checked)
                            {
                                locationTypeRent="MM";
                            }
                            else if(Ext.ComponentQuery.query('#Bus_Reg_T4LocationType4')[0].checked)
                            {
                                locationTypeRent="SM";
                            }



                            renttAddressAddr.HouseNo=Ext.ComponentQuery.query('#Bus_Reg_T4_Child_HouseNo')[0].getValue();
                            renttAddressAddr.WardNo=Ext.ComponentQuery.query('#Bus_Reg_T4_Child_WardNo')[0].getValue()?Ext.ComponentQuery.query('#Bus_Reg_T4_Child_WardNo')[0].getValue():null;
                            renttAddressAddr.StreetName=Ext.ComponentQuery.query('#Bus_Reg_T4_Child_Tole')[0].getValue();
                            renttAddressAddr.VdcTown=Ext.ComponentQuery.query('#Bus_Reg_T4_Child_VDC')[0].getValue();
                            renttAddressAddr.LocationType=locationTypeRent;
                            renttAddressAddr.DistrictCode=Ext.ComponentQuery.query('#Bus_Reg_T4_Child_District')[0].getValue();
                            renttAddressAddr.Telephone=Bus_Reg_Contact_Rent.getAt(3).data.Value;
                            renttAddressAddr.AreaCode='00';
                            renttAddressAddr.Fax=Bus_Reg_Contact_Rent.getAt(1).data.Value;
                            renttAddressAddr.Email=Bus_Reg_Contact_Rent.getAt(0).data.Value;           
                            renttAddressAddr.Action=renttAddressAddr.Action=='A'?'A':'E';          



                            rentt.OwnerPAN=Ext.ComponentQuery.query('#Bus_Reg_T4HouseOwnerPanNo')[0].getValue();
                            rentt.OwnerName=Ext.ComponentQuery.query('#Bus_Reg_T4HouseOwnerName')[0].getValue();
                            rentt.HouseArea=Ext.ComponentQuery.query('#Bus_Reg_T4RoomSize')[0].getValue();
                            rentt.HouseNo=Ext.ComponentQuery.query('#Bus_Reg_T4KittaNo')[0].getValue();
                            rentt.RentalAmount=Ext.ComponentQuery.query('#Bus_Reg_T4Rent')[0].getValue()?Ext.ComponentQuery.query('#Bus_Reg_T4Rent')[0].getValue():null;
                            rentt.RentedDate=Ext.ComponentQuery.query('#Bus_Reg_T4RentalDate')[0].getValue();
                            rentt.Action=rentt.Action=='A'?'A':'E';
                            //rent.RentAddress=rentAddress;

                            //

                            //start businessTypes
                            business.BusinessTypes=getJson(busDetListStore);
                            //end businessTypes
                            //start business
                            business.Type=busType;
                            business.TradeNameNepali=Ext.ComponentQuery.query('#Bus_Reg_FirmNameNepali')[0].getValue();
                            business.TradeNameEnglish=Ext.ComponentQuery.query('#Bus_Reg_FirmNameEnglish')[0].getValue();
                            business.RegDate=Ext.ComponentQuery.query('#Bus_Reg_RegDate')[0].getValue();
                            business.RegNumber=Ext.ComponentQuery.query('#Bus_Reg_RegNo')[0].getValue();
                            business.RegOffice=Ext.ComponentQuery.query('#Bus_Reg_OfficePlace')[0].getValue();
                            business.RegPlace=Ext.ComponentQuery.query('#Bus_Reg_OfficePlace')[0].getValue();
                            business.StartDate=Ext.ComponentQuery.query('#Bus_Reg_BusStartDate')[0].getValue();
                            business.BusinessReceivedFrom=Ext.ComponentQuery.query('#Bus_Reg_TransfererOrg')[0].getValue();        
                            business.BusinessTransferredDate=Ext.ComponentQuery.query('#Bus_Reg_transferDate')[0].getValue();
                            business.IsMainBusiness='true';        
                            business.Action=business.Action=='A'?"A":"E";       

                            //end business
                            busList=[business];

                            //-------

                        }

                        var taxxInfo={SubmissionNo:subNo,TaxpayerType:businessSubTyp,TaxpayerCategoryID:busType};
                        Ext.Ajax.request({
                            url: '../Handlers/Registration/BusinessHandler.ashx?method=SaveBusinesses',
                            timeout:60000,
                            params: {
                                businesses:JSON.stringify( busList),
                                taxpayerInfo:JSON.stringify( taxxInfo)
                            },
                            success: function(response){
                                var text = response.responseText;
                                var resp=Ext.decode(text);  

                                if(resp.success=='True'||resp.success=='true')
                                {
                                    Ext.ComponentQuery.query('#Bus_Reg_PanAction')[0].setValue('E');
                                    Ext.Ajax.request({
                                        url: '../Handlers/Registration/RegSubmissionNoHandler.ashx?method=SubmitRegistration',
                                        timeout:60000,
                                        params:{submissionNo:subNo},
                                        // params:'',
                                        success: function ( ressponse ) {
                                            var respp = ressponse.responseText;
                                            var dta=Ext.decode(respp);   
                                            if(dta.root.success=='true'||dta.root.success=='True'||dta.root.success)
                                            {  

                                                msg("Status","Registration Information Saved And Submitted Successfully.");
                                            }
                                            else
                                            {
                                                me.submitMessage(dta.root);
                                            }
                                            me.ReloadForm();
                                        },
                                        failure: function ( result, request ) {
                                            me.ReloadForm();
                                            msg("FAILURE","Registration Information Saved Successfully But Submission Failed.");
                                        }

                                    });
                                    //88
                                    //this.Reset();
                                    //msg("Status","Persanal Information Submitted Successfully.");
                                    //Ext.ComponentQuery.query('#Bus_Reg_Next')[0].enable();
                                    //Ext.ComponentQuery.query('#Bus_Reg_PanAction')[0].setValue('E');
                                    //me.ReloadForm();
                                    //88
                                }
                                else
                                {
                                    msg("FAILURE","Registration Information Save and  Submission Failed.");
                                }
                            },
                            failure: function ( result, request ) {
                                msg("FAILURE","Registration Information Save and  Submission Failed.");      
                            }
                        });   
                    }    

                }


                //////
            }
        },
        this);
    },

    onBusReg_btnAddBusinessClick: function(button, e, eOpts) {
        var nepServerDate=document.getElementById('nepDate').innerHTML;
        var me=this;
        //Business Field
        var TradeNameNepali=Ext.ComponentQuery.query('#Bus_Reg_FirmNameNepali')[0].getValue();

        //MainOffice address Field
        var MainOfficeDistrictCode=Ext.ComponentQuery.query('#Bus_Reg_T1District')[0].getValue();
        // var MainOfficeAreaCode=Ext.ComponentQuery.query('#Bus_Reg_T1Region')[0].getValue(); 

        //BusinessMainPlace address Field  
        var BusinessMainPlaceDistrictCode=Ext.ComponentQuery.query('#Bus_Reg_T2District')[0].getValue();   
        //var BusinessMainPlaceAreaCode=Ext.ComponentQuery.query('#Bus_Reg_T2Region')[0].getValue(); 

        //BusinessPersonnel Address Field
        var BusinessPersonnelDistrictCode=Ext.ComponentQuery.query('#Bus_Reg_T51_Child_District')[0].getValue();    
        //var BusinessPersonnelAreaCode:Ext.ComponentQuery.query('#Bus_Reg_T51_Child_Region')[0].getValue();

        //BusinessPersonnel Field
        var BusinessPersonnelFirstNameNep=Ext.ComponentQuery.query('#Bus_Reg_T51FirstNameNepali')[0].getValue();    
        var BusinessPersonnelLastNameNep=Ext.ComponentQuery.query('#Bus_Reg_T51LastNameNepali')[0].getValue();

        //BusinessPersonnelForIT Address Field
        var BusinessPersonnelForITDistrictCode=Ext.ComponentQuery.query('#Bus_Reg_T52_Child_District')[0].getValue();    
        //var BusinessPersonnelForITAreaCode:Ext.ComponentQuery.query('#Bus_Reg_T52_Child_Region')[0].getValue();


        //BusinessPersonnelForIT Field
        var BusinessPersonnelForITFirstNameNep=Ext.ComponentQuery.query('#Bus_Reg_T52FirstNameNepali')[0].getValue();    
        var BusinessPersonnelForITLastNameNep=Ext.ComponentQuery.query('#Bus_Reg_T52LastNameNepali')[0].getValue();


        var errMsg="";
        var errCount=0;
        if(!TradeNameNepali)
        {
            errCount++;
            errMsg +=errCount+") "+"TradeName (in Nepali) is required.<br/>";
        }
        if(!MainOfficeDistrictCode)
        {
            errCount++;
            errMsg +=errCount+") "+"District of main office  is required.<br/>";
        }
        if(!BusinessMainPlaceDistrictCode)
        {
            errCount++;
            errMsg +=errCount+") "+"District of Business's main place is required.<br/>";
        }
        if(!BusinessPersonnelDistrictCode)
        {
            errCount++;
            errMsg +=errCount+") "+"District of Business personnel is required.<br/>";
        }
        if(!BusinessPersonnelFirstNameNep)
        {
            errCount++;
            errMsg +=errCount+") "+"First name (in nepali) of Business personnel is required.<br/>";
        }
        if(!BusinessPersonnelLastNameNep)
        {
            errCount++;
            errMsg +=errCount+") "+"Last name (in nepali) of Business personnel is required.<br/>";
        }
        if(!BusinessPersonnelForITDistrictCode)
        {
            errCount++;
            errMsg +=errCount+") "+"District of Business personnel for IT is required.<br/>";
        }
        if(!BusinessPersonnelForITFirstNameNep)
        {
            errCount++;
            errMsg +=errCount+") "+"First name (in nepali) of Business personnel for IT is required.<br/>";
        }
        if(!BusinessPersonnelForITLastNameNep)
        {
            errCount++;
            errMsg +=errCount+") "+"Last name (in nepali) of Business personnel for IT is required.<br/>";
        }

        if(errCount>0)
        {
            msg("WARNING",errMsg);    
            return false;
        }

        var businessTyp="";
        var submissionNo="";
        var busrez=Ext.getCmp('BusinessRegistration');
        if(busrez.extraParam)   
        {

            submissionNo = Ext.getCmp('BusinessRegistration').extraParam.subNo;
            businessTyp = Ext.getCmp('BusinessRegistration').extraParam.busTyp;
            //alert(submissionNo+" "+businessTyp);
        }

        var Bus_Reg_Contact_1= Ext.getStore('Bus_Reg_Contact_1');
        var Bus_Reg_Contact_2= Ext.getStore('Bus_Reg_Contact_2');
        var Bus_Reg_Contact_4= Ext.getStore('Bus_Reg_Contact_4');
        var Bus_Reg_Contact_5= Ext.getStore('Bus_Reg_Contact_5');
        var Bus_Reg_Contact_Rent= Ext.getStore('Bus_Reg_Contact_Rent');
        var businessListStore=Ext.ComponentQuery.query('#Bus_Reg_BusinessList')[0].getStore();
        var busDetListStore= Ext.getStore('Bus_Reg_T3BusDetListStore');

        var selection=Ext.ComponentQuery.query('#Bus_Reg_BusinessList')[0].getSelectionModel().getSelection();
        if(selection.length>0)
        {   
            var selectedIndex= businessListStore.indexOf( selection[0] );



            var business=businessListStore.getAt(selectedIndex).data;

            var mainOfficePlace=business.MainOfficePlace;
            var mainOfficePlaceAddress=mainOfficePlace.Address;

            var mainBusinessPlace=business.MainBusinessPlace;
            var mainBusinessPlaceAddress=mainBusinessPlace.Address;



            var businessPersonnel=business.BusinessPersonnel;
            var businessPersonnelAddress=businessPersonnel.BusinessPersonnelAddress;
            var businessPersonnelAddressAddress=businessPersonnelAddress.Address;

            var businessPersonnelForIT=business.BusinessPersonnelForIT;
            var businessPersonnelForITAddress=businessPersonnelForIT.BusinessPersonnelAddress;
            var businessPersonnelForITAddressAddress=businessPersonnelForITAddress.Address;

            var rentt=business.Rent;
            var renttAddress=rentt.RentAddress;
            var renttAddressAddr=renttAddress.Address;

            // start mainofficeplaceaddress

            var locationType="";
            if(Ext.ComponentQuery.query('#Bus_Reg_T1LocationType1')[0].checked)
            {
                locationType="VD";
            }
            else if(Ext.ComponentQuery.query('#Bus_Reg_T1LocationType2')[0].checked)
            {
                locationType="MN";
            }
            else if(Ext.ComponentQuery.query('#Bus_Reg_T1LocationType3')[0].checked)
            {
                locationType="MM";
            }
            else if(Ext.ComponentQuery.query('#Bus_Reg_T1LocationType4')[0].checked)
            {
                locationType="SM";
            }

            mainOfficePlaceAddress.HouseNo=Ext.ComponentQuery.query('#Bus_Reg_T1HouseNo')[0].getValue();
            mainOfficePlaceAddress.WardNo=Ext.ComponentQuery.query('#Bus_Reg_T1WardNo')[0].getValue()?Ext.ComponentQuery.query('#Bus_Reg_T1WardNo')[0].getValue():null;
            mainOfficePlaceAddress.StreetName=Ext.ComponentQuery.query('#Bus_Reg_T1Tole')[0].getValue();
            mainOfficePlaceAddress.VdcTown=Ext.ComponentQuery.query('#Bus_Reg_T1VDC')[0].getValue();
            mainOfficePlaceAddress.LocationType=locationType;//null,
            mainOfficePlaceAddress.DistrictCode=Ext.ComponentQuery.query('#Bus_Reg_T1District')[0].getValue(); //not Null field
            mainOfficePlaceAddress.Telephone=Bus_Reg_Contact_1.getAt(3).data.Value;
            // mainOfficePlaceAddress.AreaCode='01';//Ext.ComponentQuery.query('#Bus_Reg_T1Region')[0].getValue(), //not Null field
            mainOfficePlaceAddress.AreaCode=Ext.ComponentQuery.query('#Bus_Reg_T1Region')[0].getValue(); //not Null field
            mainOfficePlaceAddress.Fax=Bus_Reg_Contact_1.getAt(1).data.Value;
            mainOfficePlaceAddress.Email=Bus_Reg_Contact_1.getAt(0).data.Value;        
            mainOfficePlaceAddress.Action=mainOfficePlaceAddress.Action=='A'?'A':'E'; 
            // end mainofficeplaceaddress
            //start businessmainplaceaddress

            var locationType1="";
            if(Ext.ComponentQuery.query('#Bus_Reg_T2LocationType1')[0].checked)
            {
                locationType1="VD";
            }
            else if(Ext.ComponentQuery.query('#Bus_Reg_T2LocationType2')[0].checked)
            {
                locationType1="MN";
            }
            else if(Ext.ComponentQuery.query('#Bus_Reg_T2LocationType3')[0].checked)
            {
                locationType1="MM";
            }
            else if(Ext.ComponentQuery.query('#Bus_Reg_T2LocationType4')[0].checked)
            {
                locationType1="SM";
            }
            mainBusinessPlaceAddress.HouseNo=Ext.ComponentQuery.query('#Bus_Reg_T2HouseNo')[0].getValue();
            mainBusinessPlaceAddress.WardNo=Ext.ComponentQuery.query('#Bus_Reg_T2WardNo')[0].getValue()?Ext.ComponentQuery.query('#Bus_Reg_T2WardNo')[0].getValue():null;
            mainBusinessPlaceAddress.StreetName=Ext.ComponentQuery.query('#Bus_Reg_T2Tole')[0].getValue();
            mainBusinessPlaceAddress.VdcTown=Ext.ComponentQuery.query('#Bus_Reg_T2VDC')[0].getValue();
            mainBusinessPlaceAddress.LocationType=locationType1;
            mainBusinessPlaceAddress.DistrictCode=Ext.ComponentQuery.query('#Bus_Reg_T2District')[0].getValue(); //not Null field
            mainBusinessPlaceAddress.Telephone=Bus_Reg_Contact_2.getAt(3).data.Value;
            //mainBusinessPlaceAddress.AreaCode='01';//Ext.ComponentQuery.query('#Bus_Reg_T1Region')[0].getValue(), //not Null field
            mainBusinessPlaceAddress.AreaCode=Ext.ComponentQuery.query('#Bus_Reg_T2Region')[0].getValue(); //not Null field
            mainBusinessPlaceAddress.Fax=Bus_Reg_Contact_2.getAt(1).data.Value;
            mainBusinessPlaceAddress.Email=Bus_Reg_Contact_2.getAt(0).data.Value;        
            mainBusinessPlaceAddress.Action=mainBusinessPlaceAddress.Action=='A'?'A':'E'; 
            //end businessmainplaceaddress    

            //start businesspersonnelAddressAddress

            var locationType2="";
            if(Ext.ComponentQuery.query('#Bus_Reg_T51LocationType1')[0].checked)
            {
                locationType2="VD";
            }
            else if(Ext.ComponentQuery.query('#Bus_Reg_T51LocationType2')[0].checked)
            {
                locationType2="MN";
            }
            else if(Ext.ComponentQuery.query('#Bus_Reg_T51LocationType3')[0].checked)
            {
                locationType2="MM";
            }
            else if(Ext.ComponentQuery.query('#Bus_Reg_T51LocationType4')[0].checked)
            {
                locationType2="SM";
            }
            businessPersonnelAddressAddress.HouseNo=Ext.ComponentQuery.query('#Bus_Reg_T51_Child_HouseNo')[0].getValue();
            businessPersonnelAddressAddress.WardNo=Ext.ComponentQuery.query('#Bus_Reg_T51_Child_WardNo')[0].getValue()?Ext.ComponentQuery.query('#Bus_Reg_T51_Child_WardNo')[0].getValue():null;
            businessPersonnelAddressAddress.StreetName=Ext.ComponentQuery.query('#Bus_Reg_T51_Child_Tole')[0].getValue();
            businessPersonnelAddressAddress.VdcTown=Ext.ComponentQuery.query('#Bus_Reg_T51_Child_VDC')[0].getValue();
            businessPersonnelAddressAddress.LocationType=locationType2;
            businessPersonnelAddressAddress.DistrictCode=Ext.ComponentQuery.query('#Bus_Reg_T51_Child_District')[0].getValue(); //not Null field
            businessPersonnelAddressAddress.Telephone=Bus_Reg_Contact_4.getAt(3).data.Value;
            businessPersonnelAddressAddress.AreaCode='00';//Ext.ComponentQuery.query('#Bus_Reg_T1Region')[0].getValue(), //not Null field
            businessPersonnelAddressAddress.Fax=Bus_Reg_Contact_4.getAt(1).data.Value;
            businessPersonnelAddressAddress.Email=Bus_Reg_Contact_4.getAt(0).data.Value;        
            businessPersonnelAddressAddress.Action=businessPersonnelAddressAddress.Action=='A'?'A':'E';     

            //end businesspersonnelAddressAddress
            //start businesspersonnel
            businessPersonnel.FirstNameEng=Ext.ComponentQuery.query('#Bus_Reg_T51FirstNameEnglish')[0].getValue();
            businessPersonnel.MiddleNameEng=Ext.ComponentQuery.query('#Bus_Reg_T51MiddleNameEnglish')[0].getValue();
            businessPersonnel.LastNameEng=Ext.ComponentQuery.query('#Bus_Reg_T51LastNameEnglish')[0].getValue();
            businessPersonnel.FirstNameNep=Ext.ComponentQuery.query('#Bus_Reg_T51FirstNameNepali')[0].getValue();
            businessPersonnel.MiddleNameNep=Ext.ComponentQuery.query('#Bus_Reg_T51MiddleNameNepali')[0].getValue();
            businessPersonnel.LastNameNep=Ext.ComponentQuery.query('#Bus_Reg_T51LastNameNepali')[0].getValue();    
            businessPersonnel.Action=businessPersonnel.Action=='A'?"A":"E";
            businessPersonnel.AppointedDate=Ext.ComponentQuery.query('#Bus_Reg_T51AppointedDate')[0].getValue();
            businessPersonnel.IdDocument=Ext.ComponentQuery.query('#Bus_Reg_T51PaperType')[0].getValue();
            businessPersonnel.IdNumber=Ext.ComponentQuery.query('#Bus_Reg_T51IdentityNo')[0].getValue();
            businessPersonnel.IdIssueAuthority=Ext.ComponentQuery.query('#Bus_Reg_T51IssuedByOrg')[0].getValue();
            businessPersonnel.IdIssueDate=Ext.ComponentQuery.query('#Bus_Reg_T51IssuedDate')[0].getValue();
            businessPersonnel.IdIssuePlace=Ext.ComponentQuery.query('#Bus_Reg_T51IssuedByOrgPlace')[0].getValue();
            businessPersonnel.Document="";
            businessPersonnel.DocNameUnique=Ext.ComponentQuery.query('#Bus_Reg_T51DocumentTxt')[0].fullName;
            businessPersonnel.DocName=Ext.ComponentQuery.query('#Bus_Reg_T51DocumentTxt')[0].getValue();
            businessPersonnel.Post="";

            //end businesspersonnel

            //start businesspersonnelForITAddressAddress

            var locationType3="";
            if(Ext.ComponentQuery.query('#Bus_Reg_T52LocationType1')[0].checked)
            {
                locationType3="VD";
            }
            else if(Ext.ComponentQuery.query('#Bus_Reg_T52LocationType2')[0].checked)
            {
                locationType3="MN";
            }
            else if(Ext.ComponentQuery.query('#Bus_Reg_T52LocationType3')[0].checked)
            {
                locationType3="MM";
            }
            else if(Ext.ComponentQuery.query('#Bus_Reg_T52LocationType4')[0].checked)
            {
                locationType3="SM";
            }
            businessPersonnelForITAddressAddress.HouseNo=Ext.ComponentQuery.query('#Bus_Reg_T52_Child_HouseNo')[0].getValue();
            businessPersonnelForITAddressAddress.WardNo=Ext.ComponentQuery.query('#Bus_Reg_T52_Child_WardNo')[0].getValue()?Ext.ComponentQuery.query('#Bus_Reg_T52_Child_WardNo')[0].getValue():null;
            businessPersonnelForITAddressAddress.StreetName=Ext.ComponentQuery.query('#Bus_Reg_T52_Child_Tole')[0].getValue();
            businessPersonnelForITAddressAddress.VdcTown=Ext.ComponentQuery.query('#Bus_Reg_T52_Child_VDC')[0].getValue();
            businessPersonnelForITAddressAddress.LocationType=locationType3;
            businessPersonnelForITAddressAddress.DistrictCode=Ext.ComponentQuery.query('#Bus_Reg_T52_Child_District')[0].getValue(); //not Null field
            businessPersonnelForITAddressAddress.Telephone=Bus_Reg_Contact_5.getAt(3).data.Value;
            businessPersonnelForITAddressAddress.AreaCode='00';//Ext.ComponentQuery.query('#Bus_Reg_T1Region')[0].getValue(), //not Null field
            businessPersonnelForITAddressAddress.Fax=Bus_Reg_Contact_5.getAt(1).data.Value;
            businessPersonnelForITAddressAddress.Email=Bus_Reg_Contact_5.getAt(0).data.Value;        
            businessPersonnelForITAddressAddress.Action=businessPersonnelForITAddressAddress.Action=='A'?'A':'E';     

            //end businesspersonnelForITAddressAddress  
            //start businesspersonnelForIT
            businessPersonnelForIT.FirstNameEng=Ext.ComponentQuery.query('#Bus_Reg_T52FirstNameEnglish')[0].getValue();
            businessPersonnelForIT.MiddleNameEng=Ext.ComponentQuery.query('#Bus_Reg_T52MiddleNameEnglish')[0].getValue();
            businessPersonnelForIT.LastNameEng=Ext.ComponentQuery.query('#Bus_Reg_T52LastNameEnglish')[0].getValue();
            businessPersonnelForIT.FirstNameNep=Ext.ComponentQuery.query('#Bus_Reg_T52FirstNameNepali')[0].getValue();
            businessPersonnelForIT.MiddleNameNep=Ext.ComponentQuery.query('#Bus_Reg_T52MiddleNameNepali')[0].getValue();
            businessPersonnelForIT.LastNameNep=Ext.ComponentQuery.query('#Bus_Reg_T52LastNameNepali')[0].getValue();    
            businessPersonnelForIT.Action=businessPersonnelForIT.Action=='A'?"A":"E";
            businessPersonnelForIT.AppointedDate=Ext.ComponentQuery.query('#Bus_Reg_T52AppointedDate')[0].getValue();
            businessPersonnelForIT.IdDocument=Ext.ComponentQuery.query('#Bus_Reg_T52PaperType')[0].getValue();
            businessPersonnelForIT.IdNumber=Ext.ComponentQuery.query('#Bus_Reg_T52IdentityNo')[0].getValue();
            businessPersonnelForIT.IdIssueAuthority=Ext.ComponentQuery.query('#Bus_Reg_T52IssuedByOrg')[0].getValue();
            businessPersonnelForIT.IdIssueDate=Ext.ComponentQuery.query('#Bus_Reg_T52IssuedDate')[0].getValue();
            businessPersonnelForIT.IdIssuePlace=Ext.ComponentQuery.query('#Bus_Reg_T52IssuedByOrgPlace')[0].getValue();
            businessPersonnelForIT.Document="";
            businessPersonnelForIT.DocNameUnique=Ext.ComponentQuery.query('#Bus_Reg_T52DocumentTxt')[0].fullName;    
            businessPersonnelForIT.DocName=Ext.ComponentQuery.query('#Bus_Reg_T52DocumentTxt')[0].getValue();
            businessPersonnelForIT.Post=Ext.ComponentQuery.query('#Bus_Reg_T52Post')[0].getValue();

            //end businesspersonnelForIT

            renttAddressAddr.HouseNo=Ext.ComponentQuery.query('#Bus_Reg_T4_Child_HouseNo')[0].getValue();
            renttAddressAddr.WardNo=Ext.ComponentQuery.query('#Bus_Reg_T4_Child_WardNo')[0].getValue()?Ext.ComponentQuery.query('#Bus_Reg_T4_Child_WardNo')[0].getValue():null;
            renttAddressAddr.StreetName=Ext.ComponentQuery.query('#Bus_Reg_T4_Child_Tole')[0].getValue();
            renttAddressAddr.VdcTown=Ext.ComponentQuery.query('#Bus_Reg_T4_Child_VDC')[0].getValue();
            renttAddressAddr.LocationType=locationTypeRent;
            renttAddressAddr.DistrictCode=Ext.ComponentQuery.query('#Bus_Reg_T4_Child_District')[0].getValue();
            renttAddressAddr.Telephone=Bus_Reg_Contact_Rent.getAt(3).data.Value;
            renttAddressAddr.AreaCode='00';
            renttAddressAddr.Fax=Bus_Reg_Contact_Rent.getAt(1).data.Value;
            renttAddressAddr.Email=Bus_Reg_Contact_Rent.getAt(0).data.Value;           
            renttAddressAddr.Action=renttAddressAddr.Action=='A'?'A':'E';          



            rentt.OwnerPAN=Ext.ComponentQuery.query('#Bus_Reg_T4HouseOwnerPanNo')[0].getValue();
            rentt.OwnerName=Ext.ComponentQuery.query('#Bus_Reg_T4HouseOwnerName')[0].getValue();
            rentt.HouseArea=Ext.ComponentQuery.query('#Bus_Reg_T4RoomSize')[0].getValue();
            rentt.HouseNo=Ext.ComponentQuery.query('#Bus_Reg_T4KittaNo')[0].getValue();
            rentt.RentalAmount=Ext.ComponentQuery.query('#Bus_Reg_T4Rent')[0].getValue()?Ext.ComponentQuery.query('#Bus_Reg_T4Rent')[0].getValue():null;
            rentt.RentedDate=Ext.ComponentQuery.query('#Bus_Reg_T4RentalDate')[0].getValue();
            rentt.Action=rentt.Action=='A'?'A':'E';

            //start businessTypes
            business.BusinessTypes=getJson(busDetListStore);
            //end businessTypes
            //start business
            business.Type=businessTyp;
            business.TradeNameNepali=Ext.ComponentQuery.query('#Bus_Reg_FirmNameNepali')[0].getValue();
            business.TradeNameEnglish=Ext.ComponentQuery.query('#Bus_Reg_FirmNameEnglish')[0].getValue();
            business.RegDate=Ext.ComponentQuery.query('#Bus_Reg_RegDate')[0].getValue();
            business.RegNumber=Ext.ComponentQuery.query('#Bus_Reg_RegNo')[0].getValue();
            business.RegOffice=Ext.ComponentQuery.query('#Bus_Reg_OfficePlace')[0].getValue();
            business.RegPlace=Ext.ComponentQuery.query('#Bus_Reg_OfficePlace')[0].getValue();
            business.StartDate=Ext.ComponentQuery.query('#Bus_Reg_BusStartDate')[0].getValue();
            business.BusinessReceivedFrom=Ext.ComponentQuery.query('#Bus_Reg_TransfererOrg')[0].getValue();        
            business.BusinessTransferredDate=Ext.ComponentQuery.query('#Bus_Reg_transferDate')[0].getValue();
            business.IsMainBusiness=Ext.ComponentQuery.query('#Bus_Reg_IsMainBusiness')[0].getValue();        
            business.Action=business.Action=='A'?"A":"E";       
            //end business

            businessListStore.removeAt(selectedIndex);
            businessListStore.insert(selectedIndex,business);

        }
        else
        {
            var locationType="";
            if(Ext.ComponentQuery.query('#Bus_Reg_T1LocationType1')[0].checked)
            {
                locationType="VD";
            }
            else if(Ext.ComponentQuery.query('#Bus_Reg_T1LocationType2')[0].checked)
            {
                locationType="MN";
            }
            else if(Ext.ComponentQuery.query('#Bus_Reg_T1LocationType3')[0].checked)
            {
                locationType="MM";
            }
            else if(Ext.ComponentQuery.query('#Bus_Reg_T1LocationType4')[0].checked)
            {
                locationType="SM";
            }
            var MainOfficePlaceAddress =
            {
                AddressSNO:0, //not Null field
                HouseNo:Ext.ComponentQuery.query('#Bus_Reg_T1HouseNo')[0].getValue(),
                WardNo:Ext.ComponentQuery.query('#Bus_Reg_T1WardNo')[0].getValue()?Ext.ComponentQuery.query('#Bus_Reg_T1WardNo')[0].getValue():null,
                StreetName:Ext.ComponentQuery.query('#Bus_Reg_T1Tole')[0].getValue(),
                VdcTown:Ext.ComponentQuery.query('#Bus_Reg_T1VDC')[0].getValue(),
                LocationType:locationType,
                DistrictCode:Ext.ComponentQuery.query('#Bus_Reg_T1District')[0].getValue(), //not Null field
                Telephone:Bus_Reg_Contact_1.getAt(3).data.Value,
                //AreaCode:'01',//Ext.ComponentQuery.query('#Bus_Reg_T1Region')[0].getValue(), //not Null field
                AreaCode:Ext.ComponentQuery.query('#Bus_Reg_T1Region')[0].getValue(), //not Null field
                Fax:Bus_Reg_Contact_1.getAt(1).data.Value,
                Email:Bus_Reg_Contact_1.getAt(0).data.Value,
                PoBox:null,
                ExpiryDate:null,
                UserId:'ITS',  //not Null field
                TranDate:null,    
                TranNo:null,
                submissionNo:submissionNo,
                Action:'A'
            };

            var MainOfficePlace=
            {
                SubmissionNo:submissionNo,
                Business_SNO:0,
                AddressSNO:0,
                AddressType:'OA',
                FromDate:nepServerDate,
                ToDate:null,
                Status:'S',
                TranNo:null,
                Action:'A',
                Address:MainOfficePlaceAddress
            };

            var locationType1="";
            if(Ext.ComponentQuery.query('#Bus_Reg_T2LocationType1')[0].checked)
            {
                locationType1="VD";
            }
            else if(Ext.ComponentQuery.query('#Bus_Reg_T2LocationType2')[0].checked)
            {
                locationType1="MN";
            }
            else if(Ext.ComponentQuery.query('#Bus_Reg_T2LocationType3')[0].checked)
            {
                locationType1="MM";
            }
            else if(Ext.ComponentQuery.query('#Bus_Reg_T2LocationType4')[0].checked)
            {
                locationType1="SM";
            }
            var MainBusinessPlaceAddress=
            {
                AddressSNO:0,
                HouseNo:Ext.ComponentQuery.query('#Bus_Reg_T2HouseNo ')[0].getValue(),
                WardNo:Ext.ComponentQuery.query('#Bus_Reg_T2WardNo')[0].getValue()?Ext.ComponentQuery.query('#Bus_Reg_T2WardNo')[0].getValue():null,
                StreetName:Ext.ComponentQuery.query('#Bus_Reg_T2Tole')[0].getValue(),
                VdcTown:Ext.ComponentQuery.query('#Bus_Reg_T2VDC')[0].getValue(),
                LocationType:locationType1,
                DistrictCode:Ext.ComponentQuery.query('#Bus_Reg_T2District')[0].getValue(),
                Telephone:Bus_Reg_Contact_2.getAt(3).data.Value,
                //AreaCode:'01',//Ext.ComponentQuery.query('#Bus_Reg_T2Region')[0].getValue(),
                AreaCode:Ext.ComponentQuery.query('#Bus_Reg_T2Region')[0].getValue(),
                Fax:Bus_Reg_Contact_2.getAt(1).data.Value,
                Email:Bus_Reg_Contact_2.getAt(0).data.Value,
                PoBox:null,
                ExpiryDate:null,
                UserId:'ITS',//null,
                TranDate:null,    
                TranNo:null,
                submissionNo:submissionNo,
                Action:'A'
            };

            var MainBusinessPlace=
            {
                SubmissionNo:submissionNo,
                Business_SNO:0,
                AddressSNO:0,
                AddressType:'BA',
                FromDate:nepServerDate,
                ToDate:null,
                Status:'S',
                TranNo:null,
                Action:'A',
                Address:MainBusinessPlaceAddress
            };  

            var locationType2="";
            if(Ext.ComponentQuery.query('#Bus_Reg_T51LocationType1')[0].checked)
            {
                locationType2="VD";
            }
            else if(Ext.ComponentQuery.query('#Bus_Reg_T51LocationType2')[0].checked)
            {
                locationType2="MN";
            }
            else if(Ext.ComponentQuery.query('#Bus_Reg_T51LocationType3')[0].checked)
            {
                locationType2="MM";
            }
            else if(Ext.ComponentQuery.query('#Bus_Reg_T51LocationType4')[0].checked)
            {
                locationType2="SM";
            }
            var BusinessPersonnelAddress1Address=
            {
                AddressSNO:0,
                HouseNo:Ext.ComponentQuery.query('#Bus_Reg_T51_Child_HouseNo')[0].getValue(),
                WardNo:Ext.ComponentQuery.query('#Bus_Reg_T51_Child_WardNo')[0].getValue()?Ext.ComponentQuery.query('#Bus_Reg_T51_Child_WardNo')[0].getValue():null,
                StreetName:Ext.ComponentQuery.query('#Bus_Reg_T51_Child_Tole')[0].getValue(),
                VdcTown:Ext.ComponentQuery.query('#Bus_Reg_T51_Child_VDC')[0].getValue(),
                LocationType:locationType2,
                DistrictCode:Ext.ComponentQuery.query('#Bus_Reg_T51_Child_District')[0].getValue(),
                Telephone:Bus_Reg_Contact_4.getAt(3).data.Value,
                AreaCode:'00',//Ext.ComponentQuery.query('#Bus_Reg_T51_Child_Region')[0].getValue(),
                Fax:Bus_Reg_Contact_4.getAt(1).data.Value,
                Email:Bus_Reg_Contact_4.getAt(0).data.Value,
                PoBox:null,
                ExpiryDate:null,
                UserId:'ITS',//null,
                TranDate:null,    
                TranNo:null,
                submissionNo:submissionNo,
                Action:'A'
            };

            var BusinessPersonnelAddress1=
            {
                SubmissionNo:submissionNo,
                Business_SNO:0,
                BusinessPersonnelType:'CH',
                FromDateHas:null,
                Sno:0,
                AddressSNO:0,
                FromDate:nepServerDate,
                ToDate:null,
                Status:'',
                TranNo:null,
                Action:'A',
                Address:BusinessPersonnelAddress1Address

            };

            var BusinessPersonnel=
            {
                SubmissionNo:submissionNo,
                BusinessSNO:0,
                BusPerType:'CH',
                FromDate:nepServerDate,
                SNo:0,
                ToDate:null,
                FirstNameEng:Ext.ComponentQuery.query('#Bus_Reg_T51FirstNameEnglish')[0].getValue(),
                MiddleNameEng:Ext.ComponentQuery.query('#Bus_Reg_T51MiddleNameEnglish')[0].getValue(),
                LastNameEng:Ext.ComponentQuery.query('#Bus_Reg_T51LastNameEnglish')[0].getValue(),
                FirstNameNep:Ext.ComponentQuery.query('#Bus_Reg_T51FirstNameNepali')[0].getValue(),
                MiddleNameNep:Ext.ComponentQuery.query('#Bus_Reg_T51MiddleNameNepali')[0].getValue(),
                LastNameNep:Ext.ComponentQuery.query('#Bus_Reg_T51LastNameNepali')[0].getValue(),
                TranNo:null,
                Action:'A',
                BusinessPersonnelAddress:BusinessPersonnelAddress1,
                AppointedDate:Ext.ComponentQuery.query('#Bus_Reg_T51AppointedDate')[0].getValue(),
                IdDocument:Ext.ComponentQuery.query('#Bus_Reg_T51PaperType')[0].getValue(),
                IdNumber:Ext.ComponentQuery.query('#Bus_Reg_T51IdentityNo')[0].getValue(),
                IdIssueAuthority:Ext.ComponentQuery.query('#Bus_Reg_T51IssuedByOrg')[0].getValue(),
                IdIssueDate:Ext.ComponentQuery.query('#Bus_Reg_T51IssuedDate')[0].getValue(),
                IdIssuePlace:Ext.ComponentQuery.query('#Bus_Reg_T51IssuedByOrgPlace')[0].getValue(),
                Document:"",
                DocNameUnique:Ext.ComponentQuery.query('#Bus_Reg_T51DocumentTxt')[0].fullName,
                DocName:Ext.ComponentQuery.query('#Bus_Reg_T51DocumentTxt')[0].getValue(),
                Post:Ext.ComponentQuery.query('#Bus_Reg_T51FirstNameNepali')[0].getValue()
            };


            var locationType3="";
            if(Ext.ComponentQuery.query('#Bus_Reg_T52LocationType1')[0].checked)
            {
                locationType3="VD";
            }
            else if(Ext.ComponentQuery.query('#Bus_Reg_T52LocationType2')[0].checked)
            {
                locationType3="MN";
            }
            else if(Ext.ComponentQuery.query('#Bus_Reg_T52LocationType3')[0].checked)
            {
                locationType3="MM";
            }
            else if(Ext.ComponentQuery.query('#Bus_Reg_T52LocationType4')[0].checked)
            {
                locationType3="SM";
            }
            var BusinessPersonnelAddress2Address=
            {
                AddressSNO:0,
                HouseNo:Ext.ComponentQuery.query('#Bus_Reg_T52_Child_HouseNo')[0].getValue(),
                WardNo:Ext.ComponentQuery.query('#Bus_Reg_T52_Child_WardNo')[0].getValue()?Ext.ComponentQuery.query('#Bus_Reg_T52_Child_WardNo')[0].getValue():null,
                StreetName:Ext.ComponentQuery.query('#Bus_Reg_T52_Child_Tole')[0].getValue(),
                VdcTown:Ext.ComponentQuery.query('#Bus_Reg_T52_Child_VDC')[0].getValue(),
                LocationType:locationType3,
                DistrictCode:Ext.ComponentQuery.query('#Bus_Reg_T52_Child_District')[0].getValue(),
                Telephone:Bus_Reg_Contact_5.getAt(3).data.Value,
                AreaCode:'00',//Ext.ComponentQuery.query('#Bus_Reg_T52_Child_Region')[0].getValue(),
                Fax:Bus_Reg_Contact_5.getAt(1).data.Value,
                Email:Bus_Reg_Contact_5.getAt(0).data.Value,
                PoBox:null,
                ExpiryDate:null,
                UserId:'ITS',//null,
                TranDate:null,   
                TranNo:null,
                submissionNo:submissionNo,
                Action:'A'
            };

            var BusinessPersonnelAddress2=
            {
                SubmissionNo:submissionNo,
                Business_SNO:0,
                BusinessPersonnelType:'CP',
                FromDateHas:'',
                Sno:0,
                AddressSNO:0,
                FromDate:nepServerDate,
                ToDate:null,
                Status:'S',
                TranNo:null,
                Action:'A',
                Address:BusinessPersonnelAddress2Address,
                IdDocument:Ext.ComponentQuery.query('#Bus_Reg_T51FirstNameNepali')[0].getValue(),
                IdNumber:Ext.ComponentQuery.query('#Bus_Reg_T51FirstNameNepali')[0].getValue(),
                IdIssueAuthority:Ext.ComponentQuery.query('#Bus_Reg_T51FirstNameNepali')[0].getValue(),
                IdIssueDate:Ext.ComponentQuery.query('#Bus_Reg_T51FirstNameNepali')[0].getValue(),
                IdIssuePlace:Ext.ComponentQuery.query('#Bus_Reg_T51FirstNameNepali')[0].getValue(),
                Document:Ext.ComponentQuery.query('#Bus_Reg_T51FirstNameNepali')[0].getValue(),
                DocName:Ext.ComponentQuery.query('#Bus_Reg_T51FirstNameNepali')[0].getValue(),
                Post:Ext.ComponentQuery.query('#Bus_Reg_T51FirstNameNepali')[0].getValue()
            };

            var BusinessPersonnelForIT=
            {
                SubmissionNo:submissionNo,
                Business_SNO:0,
                BusPerType:'CP',
                FromDate:nepServerDate,
                SNo:0,
                ToDate:null,
                FirstNameEng:Ext.ComponentQuery.query('#Bus_Reg_T52FirstNameEnglish')[0].getValue(),
                MiddleNameEng:Ext.ComponentQuery.query('#Bus_Reg_T52MiddleNameEnglish')[0].getValue(),
                LastNameEng:Ext.ComponentQuery.query('#Bus_Reg_T52LastNameEnglish')[0].getValue(),
                FirstNameNep:Ext.ComponentQuery.query('#Bus_Reg_T52FirstNameNepali')[0].getValue(),
                MiddleNameNep:Ext.ComponentQuery.query('#Bus_Reg_T52MiddleNameNepali')[0].getValue(),
                LastNameNep:Ext.ComponentQuery.query('#Bus_Reg_T52LastNameNepali')[0].getValue(),
                TranNo:null,
                Action:'A',
                BusinessPersonnelAddress:BusinessPersonnelAddress2,
                AppointedDate:Ext.ComponentQuery.query('#Bus_Reg_T52AppointedDate')[0].getValue(),
                IdDocument:Ext.ComponentQuery.query('#Bus_Reg_T52PaperType')[0].getValue(),
                IdNumber:Ext.ComponentQuery.query('#Bus_Reg_T52IdentityNo')[0].getValue(),
                IdIssueAuthority:Ext.ComponentQuery.query('#Bus_Reg_T52IssuedByOrg')[0].getValue(),
                IdIssueDate:Ext.ComponentQuery.query('#Bus_Reg_T52IssuedDate')[0].getValue(),
                IdIssuePlace:Ext.ComponentQuery.query('#Bus_Reg_T52IssuedByOrgPlace')[0].getValue(),
                Document:"",
                DocNameUnique:Ext.ComponentQuery.query('#Bus_Reg_T52DocumentTxt')[0].fullName,
                DocName:Ext.ComponentQuery.query('#Bus_Reg_T52DocumentTxt')[0].getValue(),
                Post:Ext.ComponentQuery.query('#Bus_Reg_T52Post')[0].getValue()
            };

            //start rent
            var locationTypeRent="";
            if(Ext.ComponentQuery.query('#Bus_Reg_T4LocationType1')[0].checked)
            {
                locationTypeRent="VD";
            }
            else if(Ext.ComponentQuery.query('#Bus_Reg_T4LocationType2')[0].checked)
            {
                locationTypeRent="MN";
            }
            else if(Ext.ComponentQuery.query('#Bus_Reg_T4LocationType3')[0].checked)
            {
                locationTypeRent="MM";
            }
            else if(Ext.ComponentQuery.query('#Bus_Reg_T4LocationType4')[0].checked)
            {
                locationTypeRent="SM";
            }
            var rentAddressAddr=
            {
                AddressSNO:0,
                HouseNo:Ext.ComponentQuery.query('#Bus_Reg_T4_Child_HouseNo')[0].getValue(),
                WardNo:Ext.ComponentQuery.query('#Bus_Reg_T4_Child_WardNo')[0].getValue()?Ext.ComponentQuery.query('#Bus_Reg_T4_Child_WardNo')[0].getValue():null,
                StreetName:Ext.ComponentQuery.query('#Bus_Reg_T4_Child_Tole')[0].getValue(),
                VdcTown:Ext.ComponentQuery.query('#Bus_Reg_T4_Child_VDC')[0].getValue(),
                LocationType:locationTypeRent,
                DistrictCode:Ext.ComponentQuery.query('#Bus_Reg_T4_Child_District')[0].getValue(),
                Telephone:Bus_Reg_Contact_Rent.getAt(3).data.Value,
                AreaCode:'00',
                Fax:Bus_Reg_Contact_Rent.getAt(1).data.Value,
                Email:Bus_Reg_Contact_Rent.getAt(0).data.Value,
                PoBox:null,
                ExpiryDate:null,
                UserId:'ITS',//null,
                TranDate:null,   
                TranNo:null,
                submissionNo:submissionNo,
                Action:'A'
            };
            var rentAddress=
            {
                SubmissionNo:submissionNo,
                Business_SNO:0,
                AddressSNO:0,                    
                Action:'A',
                Address:rentAddressAddr
            };

            var rent=
            {
                SubmissionNo:submissionNo,
                Business_SNO:0,
                OwnerPAN:Ext.ComponentQuery.query('#Bus_Reg_T4HouseOwnerPanNo')[0].getValue(),
                OwnerName:Ext.ComponentQuery.query('#Bus_Reg_T4HouseOwnerName')[0].getValue(),
                HouseArea:Ext.ComponentQuery.query('#Bus_Reg_T4RoomSize')[0].getValue(),
                HouseNo:Ext.ComponentQuery.query('#Bus_Reg_T4KittaNo')[0].getValue(),
                RentalAmount:Ext.ComponentQuery.query('#Bus_Reg_T4Rent')[0].getValue()?Ext.ComponentQuery.query('#Bus_Reg_T4Rent')[0].getValue():null,
                RentedDate:Ext.ComponentQuery.query('#Bus_Reg_T4RentalDate')[0].getValue(),
                Action:'A',
                RentAddress:rentAddress
            };
            //

            var Business=
            {	
                SubmissionNo:submissionNo,
                Type:businessTyp,
                Business_SNO:0,
                TradeNameNepali:Ext.ComponentQuery.query('#Bus_Reg_FirmNameNepali')[0].getValue(),
                TradeNameEnglish:Ext.ComponentQuery.query('#Bus_Reg_FirmNameEnglish')[0].getValue(),
                RegDate:Ext.ComponentQuery.query('#Bus_Reg_RegDate')[0].getValue(),
                RegNumber:Ext.ComponentQuery.query('#Bus_Reg_RegNo')[0].getValue(),
                RegOffice:Ext.ComponentQuery.query('#Bus_Reg_OfficePlace')[0].getValue(),
                RegPlace:Ext.ComponentQuery.query('#Bus_Reg_OfficePlace')[0].getValue(),
                StartDate:Ext.ComponentQuery.query('#Bus_Reg_BusStartDate')[0].getValue(),
                BusinessReceivedFrom:Ext.ComponentQuery.query('#Bus_Reg_TransfererOrg')[0].getValue(),
                BusinessReceivedDate:null,
                BusinessTransferredTo:null,
                BusinessTransferredDate:Ext.ComponentQuery.query('#Bus_Reg_transferDate')[0].getValue(),
                IsMainBusiness:Ext.ComponentQuery.query('#Bus_Reg_IsMainBusiness')[0].getValue(),
                Status:null,
                UserID:'ITS',
                TranDate:null,
                TranNo:null,
                Action:'A',
                MainOfficePlace:MainOfficePlace,
                MainBusinessPlace:MainBusinessPlace,
                BusinessTypes:getJson(busDetListStore),
                BusinessPersonnel:BusinessPersonnel,
                BusinessPersonnelForIT:BusinessPersonnelForIT,
                Rent:rent
            };	     

            businessListStore.add(Business); 
        }

        me.ClearControls();

    },

    onBus_Reg_T3BusTypeChange: function(field, newValue, oldValue, eOpts) {
        Ext.ComponentQuery.query('#Bus_Reg_T3BusSubType')[0].setValue('');
        var busSubCategoriesStore=Ext.getStore('BusinessSubCategoriesStore');
        busSubCategoriesStore.removeAll();
        if(newValue)
        {
            Ext.Ajax.request({
                url: '../Handlers/Common/BusSubCategoriesHandler.ashx?method=GetBusinessSubCategories',
                params:{categoryID:newValue},
                success: function ( result, request ) {
                    var data = Ext.decode(result.responseText);     
                    busSubCategoriesStore.loadData(data.root);
                },
                failure: function ( result, request ) {
                    Ext.Msg.show({
                        title: 'Failure',
                        msg: 'ERROR OCURRED !!!' ,
                        buttons: Ext.MessageBox.OK,
                        icon:Ext.Msg.ERROR
                    });
                }

            });
        }

    },

    onBus_Reg_T3AddClick: function(button, e, eOpts) {
        var businessCategory=Ext.ComponentQuery.query('#Bus_Reg_T3BusType')[0].getValue();
        var businessSubCategory=Ext.ComponentQuery.query('#Bus_Reg_T3BusSubType')[0].getValue();
        var busDetListStore= Ext.ComponentQuery.query('#Bus_Reg_T3BusDetList')[0].getStore();

        var errMsg="";
        var errCount=0;
        if(!businessCategory)
        {
            errCount++;
            errMsg +=errCount+") "+"Business Category is required.<br/>";
        }
        if(!businessSubCategory)
        {
            errCount++;
            errMsg +=errCount+") "+"Business SubCategory  is required.<br/>";
        }


        if(errCount>0)
        {
            msg("WARNING",errMsg);    
            return false;
        }



        var recordIndex = busDetListStore.findBy(
        function(record, id){
            return  ( record.get('BusCategoryID') === businessCategory && record.get('BusSubCategoryID') === businessSubCategory && record.get('Action') !== "D");
        }
        );

        if(recordIndex != -1)
        {
            msg('WARNING','Already Exists.');
            return false;
        }



        var submissionNo="";
        var busrez=Ext.getCmp('BusinessRegistration');

        if(busrez.extraParam)   
        {
            submissionNo = busrez.extraParam.subNo;    

        }

        //////////


        var selection=Ext.ComponentQuery.query('#Bus_Reg_T3BusDetList')[0].getSelectionModel().getSelection();
        if(selection.length>0)
        {   
            var selectedIndex= busDetListStore.indexOf( selection[0] );
            var businessType=busDetListStore.getAt(selectedIndex).data;     

            // start businessTypes

            businessType.BusCategoryID=businessCategory;
            businessType.BusSubCategoryID=businessSubCategory;

            businessType.Action=businessType.Action=='A'?'A':'E'; 
            // end businessTypes

            busDetListStore.removeAt(selectedIndex);
            busDetListStore.insert(selectedIndex,businessType);

        }
        else
        {

            var businessType ={
                SubmissionNo:submissionNo,
                BusinessSNO:0,
                BusCategoryID:businessCategory,
                BusSubCategoryID:businessSubCategory,
                FromDate:'2041.01.01',
                ToDate:null,        
                UserID:'ITS', 
                TranDate:null,    
                TranNo:null, 
                Action:'A'
            };    
            busDetListStore.add(businessType);
        }
        var  businessListStore=Ext.ComponentQuery.query('#Bus_Reg_BusinessList')[0].getStore();


    },

    onBus_Reg_T1DistrictCollapse: function(field, eOpts) {
        var combobox=Ext.ComponentQuery.query('#Bus_Reg_T1District')[0];
        var value = combobox.getValue();
        var record = combobox.findRecord(combobox.valueField || combobox.displayField, value);
        var index = combobox.store.indexOf(record);

        if(index)
        {

            var comboStore=combobox.getStore();

            var data=comboStore.getAt(index).data;

            if(data.DistrictAreas.length>1)
            {
                var areaWindow = Ext.create('MyApp.view.DistrictAreas',{
                    autoScroll: true,
                    width:600,
                    height:400
                });
                var areaStore=Ext.ComponentQuery.query('#bud_reg_DistrictAreas')[0].getStore();

                areaWindow.target=Ext.ComponentQuery.query('#Bus_Reg_T1Region')[0];
                areaStore.loadData(data.DistrictAreas);
                areaWindow.show();
            }
            else
            {
                Ext.ComponentQuery.query('#Bus_Reg_T1Region')[0].setValue('00');
            }
        }
    },

    onBus_Reg_T2DistrictCollapse: function(field, eOpts) {
        var combobox=Ext.ComponentQuery.query('#Bus_Reg_T2District')[0];
        var value = combobox.getValue();
        var record = combobox.findRecord(combobox.valueField || combobox.displayField, value);
        var index = combobox.store.indexOf(record);

        if(index)
        {
            var comboStore=combobox.getStore();

            var data=comboStore.getAt(index).data;

            if(data.DistrictAreas.length>1)
            {
                var areaWindow = Ext.create('MyApp.view.DistrictAreas',{
                    autoScroll: true,
                    width:600,
                    height:400
                });
                var areaStore=Ext.ComponentQuery.query('#bud_reg_DistrictAreas')[0].getStore();

                areaWindow.target=Ext.ComponentQuery.query('#Bus_Reg_T2Region')[0];
                areaStore.loadData(data.DistrictAreas);
                areaWindow.show();
            }
            else
            {
                Ext.ComponentQuery.query('#Bus_Reg_T2Region')[0].setValue('00');
            }
        }
    },

    onBusinessRegistrationAfterRender: function(component, eOpts) {
        this.ReloadForm();
    },

    onBus_Reg_BtnPrintClick: function(button, e, eOpts) {
        var busReg=Ext.getCmp('BusinessRegistration');
        var obj={submissionNo:busReg.extraParam.subNo};
        var url="";
        var winOption="width=730,height=345,left=100,top=100,resizable=yes,scrollbars=yes";
        if(busReg.extraParam.busTyp=='I')
        {    
            url="../Reporting/Registration/ReportHandlers/RegIndReportHandler.ashx";

        }
        else
        {    
            url="../Reporting/Registration/ReportHandlers/RegOrgReportHandler.ashx"; 
        }

        OpenWindowWithPost(url,winOption,"NewFile",obj);
    },

    onBus_Reg_btnCancelClick: function(button, e, eOpts) {
        this.ReloadForm(); 
    },

    LoadIndividualBusinesses: function() {
        var busReg=Ext.getCmp('BusinessRegistration');
        var subNo = busReg.extraParam.subNo; 
        var busType=busReg.extraParam.busTyp;

        Ext.Ajax.request({
            url: '../Handlers/Registration/RegistrationsForHandler.ashx?method=IsSubmitted',
            params:{submissionNo:subNo},
            success: function ( result, request ) {            
                var rsp = Ext.decode(result.responseText);
                if(rsp.message=='true'||rsp.message=='True')
                {   
                    ConvertFieldsToReadOnly("BusinessRegistration");
                    Ext.ComponentQuery.query('#Bus_Reg_BtnSave')[0].disable();
                    Ext.ComponentQuery.query('#Bus_Reg_btnSubmit')[0].disable();
                    Ext.ComponentQuery.query('#Bus_Reg_btnCancel')[0].disable();
                    Ext.ComponentQuery.query('#busReg_btnAddBusiness')[0].disable();
                    Ext.ComponentQuery.query('#Bus_Reg_T3Add')[0].disable();
                    //Ext.ComponentQuery.query('#Bus_Reg_Next')[0].enable();


                }  

                var btnAddBusiness=Ext.ComponentQuery.query('#busReg_btnAddBusiness')[0];
                var isMainBusiness=Ext.ComponentQuery.query('#Bus_Reg_IsMainBusiness')[0];
                var businessList=Ext.ComponentQuery.query('#Bus_Reg_BusinessList')[0];
                var Bus_Reg_Next=Ext.ComponentQuery.query('#Bus_Reg_Next')[0];                
                //Bus_Reg_Next.disable();           



                btnAddBusiness.show();
                isMainBusiness.show(); 
                businessList.show();

                //var statuBar= waitMsg("Please Wait...");
                Ext.Ajax.request({
                    url: '../Handlers/Registration/BusinessHandler.ashx?method=GetBusinesses',
                    params:{submissionNo:subNo},
                    success: function ( result, request ) {
                        var data = Ext.decode(result.responseText); 
                        var store=Ext.ComponentQuery.query('#Bus_Reg_BusinessList')[0].getStore();
                        store.removeAll();

                        if(data.root)
                        {             
                            console.log('businesses',data.root);
                            if(data.root.length>0)
                            { 
                                Bus_Reg_Next.enable();
                                store.add(data.root);    
                                //statuBar.close();
                            }
                        }

                    },
                    failure: function ( result, request ) {
                        //statuBar.close();
                        msg('ERROR','Could Not Load ITAX Details'); 
                    }

                });
            },
            failure:function(result, request)
            {
                msg('ERROR','Could Not Load ITAX Details');            
                return;
            }
        });


    },

    LoadEntityBusiness: function() {
        var busReg=Ext.getCmp('BusinessRegistration');
        var subNo = busReg.extraParam.subNo; 
        var busType=busReg.extraParam.busTyp;


        Ext.Ajax.request({
            url: '../Handlers/Registration/RegistrationsForHandler.ashx?method=IsSubmitted',
            params:{submissionNo:subNo},
            success: function ( result, request ) {            
                var rsp = Ext.decode(result.responseText);
                if(rsp.message=='true'||rsp.message=='True')
                {
                    ConvertFieldsToReadOnly("BusinessRegistration");
                    Ext.ComponentQuery.query('#Bus_Reg_BtnSave')[0].disable();
                    Ext.ComponentQuery.query('#Bus_Reg_btnSubmit')[0].disable();
                    Ext.ComponentQuery.query('#Bus_Reg_btnCancel')[0].disable();
                    Ext.ComponentQuery.query('#busReg_btnAddBusiness')[0].disable();
                    Ext.ComponentQuery.query('#Bus_Reg_T3Add')[0].disable();
                    //Ext.ComponentQuery.query('#Bus_Reg_Next')[0].enable();

                }

                var btnAddBusiness=Ext.ComponentQuery.query('#busReg_btnAddBusiness')[0];
                var isMainBusiness=Ext.ComponentQuery.query('#Bus_Reg_IsMainBusiness')[0];
                var businessList=Ext.ComponentQuery.query('#Bus_Reg_BusinessList')[0];
                var Bus_Reg_Next=Ext.ComponentQuery.query('#Bus_Reg_Next')[0];
                var Bus_Reg_IsMainBusiness=Ext.ComponentQuery.query('#Bus_Reg_IsMainBusiness')[0];
                Bus_Reg_Next.disable();

                btnAddBusiness.hide();
                isMainBusiness.hide(); 
                businessList.hide();
                Bus_Reg_IsMainBusiness.hide();
                //var statuBar= waitMsg("Please Wait...");

                Ext.Ajax.request({
                    url: '../Handlers/Registration/BusinessHandler.ashx?method=GetBusinesses',
                    params:{submissionNo:subNo},
                    success: function ( result, request ) {
                        var data = Ext.decode(result.responseText);                                
                        var store=Ext.ComponentQuery.query('#Bus_Reg_BusinessList')[0].getStore();
                        store.removeAll();                       
                        if(data.root[0])
                        {

                            Bus_Reg_Next.enable();
                            console.log('businesses',data.root);
                            store.add(data.root[0]);            

                            var business=data.root[0];            

                            var mainOfficePlace=business.MainOfficePlace;
                            var mainOfficePlaceAddress=mainOfficePlace.Address;

                            var mainBusinessPlace=business.MainBusinessPlace;
                            var mainBusinessPlaceAddress=mainBusinessPlace.Address;

                            var businessPersonnel=business.BusinessPersonnel;
                            var businessPersonnelAddress=businessPersonnel.BusinessPersonnelAddress;
                            var businessPersonnelAddressAddress=businessPersonnelAddress.Address;

                            var businessPersonnelForIT=business.BusinessPersonnelForIT;
                            var businessPersonnelForITAddress=businessPersonnelForIT.BusinessPersonnelAddress;
                            var businessPersonnelForITAddressAddress=businessPersonnelForITAddress.Address;

                            var rentt=business.Rent;
                            var renttAddress=rentt.RentAddress;
                            var renttAddressAddr=renttAddress.Address;


                            //start Set business
                            Ext.ComponentQuery.query('#Bus_Reg_FirmNameNepali')[0].setValue(business.TradeNameNepali);
                            Ext.ComponentQuery.query('#Bus_Reg_FirmNameEnglish')[0].setValue(business.TradeNameEnglish);
                            Ext.ComponentQuery.query('#Bus_Reg_RegDate')[0].setValue(business.RegDate);
                            Ext.ComponentQuery.query('#Bus_Reg_RegNo')[0].setValue(business.RegNumber);
                            Ext.ComponentQuery.query('#Bus_Reg_OfficePlace')[0].setValue(business.RegPlace);
                            Ext.ComponentQuery.query('#Bus_Reg_BusStartDate')[0].setValue(business.StartDate);
                            Ext.ComponentQuery.query('#Bus_Reg_TransfererOrg')[0].setValue(business.BusinessReceivedFrom);   
                            Ext.ComponentQuery.query('#Bus_Reg_transferDate')[0].setValue(business.BusinessTransferredDate);
                            Ext.ComponentQuery.query('#Bus_Reg_IsMainBusiness')[0].setValue(business.IsMainBusiness);
                            if(business.BusinessReceivedFrom || business.BusinessTransferredDate)
                            {
                                Ext.ComponentQuery.query('#Bus_Reg_transferredNo')[0].setValue(false);
                                Ext.ComponentQuery.query('#Bus_Reg_transferredYes')[0].setValue(true);

                            }
                            else
                            {
                                Ext.ComponentQuery.query('#Bus_Reg_transferredNo')[0].setValue(true);
                                Ext.ComponentQuery.query('#Bus_Reg_transferredYes')[0].setValue(false);
                            }
                            //end Set business


                            // start set businessTypes
                            var busDetListStore= Ext.getStore('Bus_Reg_T3BusDetListStore');

                            busDetListStore.removeAll();
                            busDetListStore.loadData(business.BusinessTypes);
                            // end set businessTypes

                            //start Set MainOfficePlaceAddress

                            var locationType=mainOfficePlaceAddress.LocationType;
                            if(locationType=="VD")
                            {
                                Ext.ComponentQuery.query('#Bus_Reg_T1LocationType1')[0].setValue(true);
                            }
                            else if(locationType=="MN")
                            {
                                Ext.ComponentQuery.query('#Bus_Reg_T1LocationType2')[0].setValue(true);
                            }
                            else if(locationType=="MM")
                            {
                                Ext.ComponentQuery.query('#Bus_Reg_T1LocationType3')[0].setValue(true);
                            }
                            else if(locationType=="SM")
                            {
                                Ext.ComponentQuery.query('#Bus_Reg_T1LocationType4')[0].setValue(true);
                            }


                            var Bus_Reg_Contact_1= Ext.getStore('Bus_Reg_Contact_1');
                            Ext.ComponentQuery.query('#Bus_Reg_T1HouseNo')[0].setValue(mainOfficePlaceAddress.HouseNo);
                            Ext.ComponentQuery.query('#Bus_Reg_T1WardNo')[0].setValue(mainOfficePlaceAddress.WardNo);
                            Ext.ComponentQuery.query('#Bus_Reg_T1Tole')[0].setValue(mainOfficePlaceAddress.StreetName);
                            Ext.ComponentQuery.query('#Bus_Reg_T1VDC')[0].setValue(mainOfficePlaceAddress.VdcTown);


                            Ext.ComponentQuery.query('#Bus_Reg_T1District')[0].setValue(Number(mainOfficePlaceAddress.DistrictCode)); 
                            Bus_Reg_Contact_1.getAt(3).set({Value:mainOfficePlaceAddress.Telephone});    
                            Ext.ComponentQuery.query('#Bus_Reg_T1Region')[0].setValue(mainOfficePlaceAddress.AreaCode);
                            Bus_Reg_Contact_1.getAt(1).set({Value:mainOfficePlaceAddress.Fax});
                            Bus_Reg_Contact_1.getAt(0).set({Value:mainOfficePlaceAddress.Email});

                            //end Set MainOfficePlaceAddress

                            //start Set BusinessMainOfficeAddress
                            var locationType1=mainBusinessPlaceAddress.LocationType;
                            if(locationType1=="VD")
                            {
                                Ext.ComponentQuery.query('#Bus_Reg_T2LocationType1')[0].setValue(true);
                            }
                            else if(locationType1=="MN")
                            {
                                Ext.ComponentQuery.query('#Bus_Reg_T2LocationType2')[0].setValue(true);
                            }
                            else if(locationType1=="MM")
                            {
                                Ext.ComponentQuery.query('#Bus_Reg_T2LocationType3')[0].setValue(true);
                            }
                            else if(locationType1=="SM")
                            {
                                Ext.ComponentQuery.query('#Bus_Reg_T2LocationType4')[0].setValue(true);
                            }
                            var Bus_Reg_Contact_2= Ext.getStore('Bus_Reg_Contact_2');

                            Ext.ComponentQuery.query('#Bus_Reg_T2HouseNo')[0].setValue(mainBusinessPlaceAddress.HouseNo);
                            Ext.ComponentQuery.query('#Bus_Reg_T2WardNo')[0].setValue(mainBusinessPlaceAddress.WardNo);
                            Ext.ComponentQuery.query('#Bus_Reg_T2Tole')[0].setValue(mainBusinessPlaceAddress.StreetName);
                            Ext.ComponentQuery.query('#Bus_Reg_T2VDC')[0].setValue(mainBusinessPlaceAddress.VdcTown);
                            Ext.ComponentQuery.query('#Bus_Reg_T2District')[0].setValue(Number(mainBusinessPlaceAddress.DistrictCode)); 
                            Bus_Reg_Contact_2.getAt(3).set({Value:mainBusinessPlaceAddress.Telephone});    
                            Ext.ComponentQuery.query('#Bus_Reg_T2Region')[0].setValue(mainBusinessPlaceAddress.AreaCode);
                            Bus_Reg_Contact_2.getAt(1).set({Value:mainBusinessPlaceAddress.Fax});
                            Bus_Reg_Contact_2.getAt(0).set({Value:mainBusinessPlaceAddress.Email});
                            //end Set BusinessMainOfficeAddress

                            //start Set BusinessPersonnelAddressAddress
                            var locationType3=businessPersonnelAddressAddress.LocationType;
                            if(locationType3=="VD")
                            {
                                Ext.ComponentQuery.query('#Bus_Reg_T51LocationType1')[0].setValue(true);
                            }
                            else if(locationType3=="MN")
                            {
                                Ext.ComponentQuery.query('#Bus_Reg_T51LocationType2')[0].setValue(true);
                            }
                            else if(locationType3=="MM")
                            {
                                Ext.ComponentQuery.query('#Bus_Reg_T51LocationType3')[0].setValue(true);
                            }
                            else if(locationType3=="SM")
                            {
                                Ext.ComponentQuery.query('#Bus_Reg_T51LocationType4')[0].setValue(true);
                            }
                            var Bus_Reg_Contact_4= Ext.getStore('Bus_Reg_Contact_4');

                            Ext.ComponentQuery.query('#Bus_Reg_T51_Child_HouseNo')[0].setValue(businessPersonnelAddressAddress.HouseNo);
                            Ext.ComponentQuery.query('#Bus_Reg_T51_Child_WardNo')[0].setValue(businessPersonnelAddressAddress.WardNo);
                            Ext.ComponentQuery.query('#Bus_Reg_T51_Child_Tole')[0].setValue(businessPersonnelAddressAddress.StreetName);
                            Ext.ComponentQuery.query('#Bus_Reg_T51_Child_VDC')[0].setValue(businessPersonnelAddressAddress.VdcTown);

                            Ext.ComponentQuery.query('#Bus_Reg_T51_Child_District')[0].setValue(businessPersonnelAddressAddress.DistrictCode);
                            Bus_Reg_Contact_4.getAt(3).set({Value:businessPersonnelAddressAddress.Telephone});
                            Ext.ComponentQuery.query('#Bus_Reg_T51_Child_Region')[0].setValue(businessPersonnelAddressAddress.AreaCode);
                            Bus_Reg_Contact_4.getAt(1).set({Value:businessPersonnelAddressAddress.Fax});
                            Bus_Reg_Contact_4.getAt(0).set({Value:businessPersonnelAddressAddress.Email});   

                            //end Set BusinessPersonnelAddressAddress

                            //start Set BusinessPersonnel   
                            Ext.ComponentQuery.query('#Bus_Reg_T51FirstNameEnglish')[0].setValue(businessPersonnel.FirstNameEng);
                            Ext.ComponentQuery.query('#Bus_Reg_T51MiddleNameEnglish')[0].setValue(businessPersonnel.MiddleNameEng);
                            Ext.ComponentQuery.query('#Bus_Reg_T51LastNameEnglish')[0].setValue(businessPersonnel.LastNameEng);
                            Ext.ComponentQuery.query('#Bus_Reg_T51FirstNameNepali')[0].setValue(businessPersonnel.FirstNameNep);
                            Ext.ComponentQuery.query('#Bus_Reg_T51MiddleNameNepali')[0].setValue(businessPersonnel.MiddleNameNep);
                            Ext.ComponentQuery.query('#Bus_Reg_T51LastNameNepali')[0].setValue(businessPersonnel.LastNameNep);
                            Ext.ComponentQuery.query('#Bus_Reg_T51AppointedDate')[0].setValue(businessPersonnel.AppointedDate);
                            Ext.ComponentQuery.query('#Bus_Reg_T51PaperType')[0].setValue(businessPersonnel.IdDocument);
                            Ext.ComponentQuery.query('#Bus_Reg_T51IdentityNo')[0].setValue(businessPersonnel.IdNumber);
                            Ext.ComponentQuery.query('#Bus_Reg_T51IssuedByOrg')[0].setValue(businessPersonnel.IdIssueAuthority);
                            Ext.ComponentQuery.query('#Bus_Reg_T51IssuedDate')[0].setValue(businessPersonnel.IdIssueDate);
                            Ext.ComponentQuery.query('#Bus_Reg_T51IssuedByOrgPlace')[0].setValue(businessPersonnel.IdIssuePlace);
                            Ext.ComponentQuery.query('#Bus_Reg_T51DocumentTxt')[0].fullName=businessPersonnel.DocNameUnique;
                            Ext.ComponentQuery.query('#Bus_Reg_T51DocumentTxt')[0].setValue(businessPersonnel.DocName);

                            //start Set BusinessPersonnel

                            //start Set BusinessPersonnelForITAddressAddress
                            var locationType4=businessPersonnelForITAddressAddress.LocationType;
                            if(locationType4=="VD")
                            {
                                Ext.ComponentQuery.query('#Bus_Reg_T52LocationType1')[0].setValue(true);
                            }
                            else if(locationType4=="MN")
                            {
                                Ext.locationType4.query('#Bus_Reg_T52LocationType2')[0].setValue(true);
                            }
                            else if(locationType4=="MM")
                            {
                                Ext.ComponentQuery.query('#Bus_Reg_T52LocationType3')[0].setValue(true);
                            }
                            else if(locationType4=="SM")
                            {
                                Ext.ComponentQuery.query('#Bus_Reg_T52LocationType4')[0].setValue(true);
                            }
                            var Bus_Reg_Contact_5= Ext.getStore('Bus_Reg_Contact_5');

                            Ext.ComponentQuery.query('#Bus_Reg_T52_Child_HouseNo')[0].setValue(businessPersonnelForITAddressAddress.HouseNo);
                            Ext.ComponentQuery.query('#Bus_Reg_T52_Child_WardNo')[0].setValue(businessPersonnelForITAddressAddress.WardNo);
                            Ext.ComponentQuery.query('#Bus_Reg_T52_Child_Tole')[0].setValue(businessPersonnelForITAddressAddress.StreetName);
                            Ext.ComponentQuery.query('#Bus_Reg_T52_Child_VDC')[0].setValue(businessPersonnelForITAddressAddress.VdcTown);

                            Ext.ComponentQuery.query('#Bus_Reg_T52_Child_District')[0].setValue(businessPersonnelForITAddressAddress.DistrictCode);
                            Bus_Reg_Contact_5.getAt(3).set({Value:businessPersonnelForITAddressAddress.Telephone});
                            Ext.ComponentQuery.query('#Bus_Reg_T52_Child_Region')[0].setValue(businessPersonnelForITAddressAddress.AreaCode);
                            Bus_Reg_Contact_5.getAt(1).set({Value:businessPersonnelForITAddressAddress.Fax});
                            Bus_Reg_Contact_5.getAt(0).set({Value:businessPersonnelForITAddressAddress.Email});   

                            //end Set BusinessPersonnelForITAddressAddress

                            //start Set BusinessPersonnelForIT   
                            Ext.ComponentQuery.query('#Bus_Reg_T52FirstNameEnglish')[0].setValue(businessPersonnelForIT.FirstNameEng);
                            Ext.ComponentQuery.query('#Bus_Reg_T52MiddleNameEnglish')[0].setValue(businessPersonnelForIT.MiddleNameEng);
                            Ext.ComponentQuery.query('#Bus_Reg_T52LastNameEnglish')[0].setValue(businessPersonnelForIT.LastNameEng);
                            Ext.ComponentQuery.query('#Bus_Reg_T52FirstNameNepali')[0].setValue(businessPersonnelForIT.FirstNameNep);
                            Ext.ComponentQuery.query('#Bus_Reg_T52MiddleNameNepali')[0].setValue(businessPersonnelForIT.MiddleNameNep);
                            Ext.ComponentQuery.query('#Bus_Reg_T52LastNameNepali')[0].setValue(businessPersonnelForIT.LastNameNep);
                            Ext.ComponentQuery.query('#Bus_Reg_T52AppointedDate')[0].setValue(businessPersonnelForIT.AppointedDate);
                            Ext.ComponentQuery.query('#Bus_Reg_T52PaperType')[0].setValue(businessPersonnelForIT.IdDocument);
                            Ext.ComponentQuery.query('#Bus_Reg_T52IdentityNo')[0].setValue(businessPersonnelForIT.IdNumber);
                            Ext.ComponentQuery.query('#Bus_Reg_T52IssuedByOrg')[0].setValue(businessPersonnelForIT.IdIssueAuthority);
                            Ext.ComponentQuery.query('#Bus_Reg_T52IssuedDate')[0].setValue(businessPersonnelForIT.IdIssueDate);
                            Ext.ComponentQuery.query('#Bus_Reg_T52IssuedByOrgPlace')[0].setValue(businessPersonnelForIT.IdIssuePlace);
                            Ext.ComponentQuery.query('#Bus_Reg_T52DocumentTxt')[0].fullName=businessPersonnelForIT.DocNameUnique;
                            Ext.ComponentQuery.query('#Bus_Reg_T52DocumentTxt')[0].setValue(businessPersonnelForIT.DocName);
                            Ext.ComponentQuery.query('#Bus_Reg_T52Post')[0].setValue(businessPersonnelForIT.Post);
                            //end Set BusinessPersonnelForIT


                            //start rent
                            var Bus_Reg_Contact_Rent= Ext.getStore('Bus_Reg_Contact_Rent');
                            var locationTypeRent=renttAddressAddr.LocationType;
                            if(locationType4=="VD")
                            {
                                Ext.ComponentQuery.query('#Bus_Reg_T4LocationType1')[0].setValue(true);
                            }
                            else if(locationType4=="MN")
                            {
                                Ext.ComponentQuery.query('#Bus_Reg_T4LocationType2')[0].setValue(true);
                            }
                            else if(locationType4=="MM")
                            {
                                Ext.ComponentQuery.query('#Bus_Reg_T4LocationType3')[0].setValue(true);
                            }
                            else if(locationType4=="SM")
                            {
                                Ext.ComponentQuery.query('#Bus_Reg_T4LocationType4')[0].setValue(true);
                            }


                            Ext.ComponentQuery.query('#Bus_Reg_T4_Child_HouseNo')[0].setValue(renttAddressAddr.HouseNo);
                            Ext.ComponentQuery.query('#Bus_Reg_T4_Child_WardNo')[0].setValue(renttAddressAddr.WardNo);
                            Ext.ComponentQuery.query('#Bus_Reg_T4_Child_Tole')[0].setValue(renttAddressAddr.StreetName);
                            Ext.ComponentQuery.query('#Bus_Reg_T4_Child_VDC')[0].setValue(renttAddressAddr.VdcTown);

                            Ext.ComponentQuery.query('#Bus_Reg_T4_Child_District')[0].setValue(renttAddressAddr.DistrictCode);
                            Bus_Reg_Contact_Rent.getAt(3).set({Value:renttAddressAddr.Telephone});                
                            Bus_Reg_Contact_Rent.getAt(1).set({Value:renttAddressAddr.Fax});
                            Bus_Reg_Contact_Rent.getAt(0).set({Value:renttAddressAddr.Email});


                            Ext.ComponentQuery.query('#Bus_Reg_T4HouseOwnerPanNo')[0].setValue(rentt.OwnerPAN);
                            Ext.ComponentQuery.query('#Bus_Reg_T4HouseOwnerName')[0].setValue(rentt.OwnerName);
                            Ext.ComponentQuery.query('#Bus_Reg_T4RoomSize')[0].setValue(rentt.HouseArea);
                            Ext.ComponentQuery.query('#Bus_Reg_T4KittaNo')[0].setValue(rentt.HouseNo);
                            Ext.ComponentQuery.query('#Bus_Reg_T4Rent')[0].setValue(rentt.RentalAmount);
                            Ext.ComponentQuery.query('#Bus_Reg_T4RentalDate')[0].setValue(rentt.RentedDate);


                            //


                            //////////////////
                            //statuBar.close();
                        }


                    },
                    failure: function ( result, request ) {
                        msg('ERROR','Could Not Load ITAX Details'); 
                    }

                });



            },
            failure:function(result, request)
            {
                msg('ERROR','Could Not Load ITAX Details');            
                return;
            }
        });




    },

    ReloadForm: function() {
        var me=this;
        var busReg=Ext.getCmp('BusinessRegistration');
        var busType=busReg.extraParam.busTyp;
        var regFor=busReg.extraParam.regFor;

        if(regFor==3||regFor==4||regFor==5||regFor==6||regFor==7||regFor==8)
        {
            Ext.ComponentQuery.query('#Bus_Reg_Next')[0].enable();
            Ext.ComponentQuery.query('#Bus_Reg_Next')[0].show();
        }
        else
        {
            Ext.ComponentQuery.query('#Bus_Reg_Next')[0].disable();
            Ext.ComponentQuery.query('#Bus_Reg_Next')[0].hide();
        }


        Ext.ComponentQuery.query('#Bus_Reg_T1District')[0].setValue("0");
        Ext.ComponentQuery.query('#Bus_Reg_T2District')[0].setValue("0");
        Ext.ComponentQuery.query('#Bus_Reg_T4_Child_District')[0].setValue("0");        
        Ext.ComponentQuery.query('#Bus_Reg_T51_Child_District')[0].setValue("0");
        Ext.ComponentQuery.query('#Bus_Reg_T52_Child_District')[0].setValue("0");

        var distReg=Ext.getStore('DistrictRegistration');  
        distReg.load({
            scope: this,
            callback: function(records, operation, success) {  

                Ext.getStore('BusReg_PDDocumentTypeStore').load({
                    scope: this,
                    callback: function(records, operation, success) {  

                        Ext.getStore('BusReg_PDITDocumentTypeStore').loadData(records);

                        me.ClearControls();

                        if(busType=='I')
                        {
                            me.LoadIndividualBusinesses();
                        }
                        else
                        {
                            me.LoadEntityBusiness();
                        }

                    }
                });

            }

        });

        Ext.getStore('BusReg_PDDocumentTypeStore').load({
            scope: this,
            callback: function(records, operation, success) {        
                Ext.getStore('BusReg_PDITDocumentTypeStore').loadData(records);

            }
        });

        Ext.getStore('BusinessCategoriesStore').load();

        me.ClearControls();
        if(busType=='I')
        {
            me.LoadIndividualBusinesses();
        }
        else
        {
            me.LoadEntityBusiness();
        } 
    },

    ClearControls: function() {
        //Start Set business
        Ext.ComponentQuery.query('#Bus_Reg_FirmNameNepali')[0].setValue("");
        Ext.ComponentQuery.query('#Bus_Reg_FirmNameEnglish')[0].setValue("");
        Ext.ComponentQuery.query('#Bus_Reg_RegDate')[0].setValue("");
        Ext.ComponentQuery.query('#Bus_Reg_RegNo')[0].setValue("");
        Ext.ComponentQuery.query('#Bus_Reg_OfficePlace')[0].setValue("");
        Ext.ComponentQuery.query('#Bus_Reg_BusStartDate')[0].setValue("");
        Ext.ComponentQuery.query('#Bus_Reg_TransfererOrg')[0].setValue("");   
        Ext.ComponentQuery.query('#Bus_Reg_transferDate')[0].setValue("");
        Ext.ComponentQuery.query('#Bus_Reg_IsMainBusiness')[0].setValue("");


        Ext.ComponentQuery.query('#Bus_Reg_transferredNo')[0].setValue(true);
        Ext.ComponentQuery.query('#Bus_Reg_transferredYes')[0].setValue(false);
        Ext.ComponentQuery.query('#Bus_Reg_transferrerOrgPanNo')[0].setValue("");






        //end Set business


        // start set businessTypes
        var busDetListStore= Ext.getStore('Bus_Reg_T3BusDetListStore');
        busDetListStore.removeAll();




        // end set businessTypes

        //start Set MainOfficePlaceAddress


        Ext.ComponentQuery.query('#Bus_Reg_T1LocationType1')[0].setValue(true);
        Ext.ComponentQuery.query('#Bus_Reg_T1LocationType2')[0].setValue(false);
        Ext.ComponentQuery.query('#Bus_Reg_T1LocationType3')[0].setValue(false);
        Ext.ComponentQuery.query('#Bus_Reg_T1LocationType4')[0].setValue(false);


        var Bus_Reg_Contact_1= Ext.getStore('Bus_Reg_Contact_1');
        Ext.ComponentQuery.query('#Bus_Reg_T1HouseNo')[0].setValue("");
        Ext.ComponentQuery.query('#Bus_Reg_T1WardNo')[0].setValue("");
        Ext.ComponentQuery.query('#Bus_Reg_T1Tole')[0].setValue("");
        Ext.ComponentQuery.query('#Bus_Reg_T1VDC')[0].setValue("");
        //Ext.ComponentQuery.query('#Bus_Reg_T1District')[0].setValue(""); 
        Bus_Reg_Contact_1.getAt(3).set({Value:""});
        Bus_Reg_Contact_1.getAt(2).set({Value:""});
        Ext.ComponentQuery.query('#Bus_Reg_T1Region')[0].setValue("");
        Bus_Reg_Contact_1.getAt(1).set({Value:""});
        Bus_Reg_Contact_1.getAt(0).set({Value:""});

        //end Set MainOfficePlaceAddress

        //start Set BusinessMainOfficeAddress

        Ext.ComponentQuery.query('#Bus_Reg_T2LocationType1')[0].setValue(true);
        Ext.ComponentQuery.query('#Bus_Reg_T2LocationType2')[0].setValue(false);
        Ext.ComponentQuery.query('#Bus_Reg_T2LocationType3')[0].setValue(false);
        Ext.ComponentQuery.query('#Bus_Reg_T2LocationType4')[0].setValue(false);

        var Bus_Reg_Contact_2= Ext.getStore('Bus_Reg_Contact_2');

        Ext.ComponentQuery.query('#Bus_Reg_T2HouseNo')[0].setValue("");
        Ext.ComponentQuery.query('#Bus_Reg_T2WardNo')[0].setValue("");
        Ext.ComponentQuery.query('#Bus_Reg_T2Tole')[0].setValue("");
        Ext.ComponentQuery.query('#Bus_Reg_T2VDC')[0].setValue("");
        //Ext.ComponentQuery.query('#Bus_Reg_T2District')[0].setValue(""); 
        Bus_Reg_Contact_2.getAt(3).set({Value:""});   
        Bus_Reg_Contact_2.getAt(2).set({Value:""});
        Ext.ComponentQuery.query('#Bus_Reg_T2Region')[0].setValue("");
        Bus_Reg_Contact_2.getAt(1).set({Value:""});
        Bus_Reg_Contact_2.getAt(0).set({Value:""});
        //end Set BusinessMainOfficeAddress

        //start Set BusinessPersonnelAddressAddress

        Ext.ComponentQuery.query('#Bus_Reg_T51LocationType1')[0].setValue(true);

        Ext.ComponentQuery.query('#Bus_Reg_T51LocationType2')[0].setValue(false);

        Ext.ComponentQuery.query('#Bus_Reg_T51LocationType3')[0].setValue(false);

        Ext.ComponentQuery.query('#Bus_Reg_T51LocationType4')[0].setValue(false);

        var Bus_Reg_Contact_4= Ext.getStore('Bus_Reg_Contact_4');

        Ext.ComponentQuery.query('#Bus_Reg_T51_Child_HouseNo')[0].setValue("");
        Ext.ComponentQuery.query('#Bus_Reg_T51_Child_WardNo')[0].setValue("");
        Ext.ComponentQuery.query('#Bus_Reg_T51_Child_Tole')[0].setValue("");
        Ext.ComponentQuery.query('#Bus_Reg_T51_Child_VDC')[0].setValue("");

        //Ext.ComponentQuery.query('#Bus_Reg_T51_Child_District')[0].setValue("");
        Bus_Reg_Contact_4.getAt(3).set({Value:""});
        Bus_Reg_Contact_4.getAt(2).set({Value:""});
        Ext.ComponentQuery.query('#Bus_Reg_T51_Child_Region')[0].setValue("");
        Bus_Reg_Contact_4.getAt(1).set({Value:""});
        Bus_Reg_Contact_4.getAt(0).set({Value:""});   

        //end Set BusinessPersonnelAddressAddress

        //start Set BusinessPersonnel   
        Ext.ComponentQuery.query('#Bus_Reg_T51FirstNameEnglish')[0].setValue("");
        Ext.ComponentQuery.query('#Bus_Reg_T51MiddleNameEnglish')[0].setValue("");
        Ext.ComponentQuery.query('#Bus_Reg_T51LastNameEnglish')[0].setValue("");
        Ext.ComponentQuery.query('#Bus_Reg_T51FirstNameNepali')[0].setValue("");
        Ext.ComponentQuery.query('#Bus_Reg_T51MiddleNameNepali')[0].setValue("");
        Ext.ComponentQuery.query('#Bus_Reg_T51LastNameNepali')[0].setValue("");
        Ext.ComponentQuery.query('#Bus_Reg_T51AppointedDate')[0].setValue("");
        Ext.ComponentQuery.query('#Bus_Reg_T51PaperType')[0].setValue("");
        Ext.ComponentQuery.query('#Bus_Reg_T51IdentityNo')[0].setValue("");
        Ext.ComponentQuery.query('#Bus_Reg_T51IssuedByOrg')[0].setValue("");
        Ext.ComponentQuery.query('#Bus_Reg_T51IssuedDate')[0].setValue("");
        Ext.ComponentQuery.query('#Bus_Reg_T51IssuedByOrgPlace')[0].setValue("");
        Ext.ComponentQuery.query('#Bus_Reg_T51DocumentTxt')[0].fullName="";
        Ext.ComponentQuery.query('#Bus_Reg_T51DocumentTxt')[0].setValue("");

        //start Set BusinessPersonnel

        //start Set BusinessPersonnelForITAddressAddress

        Ext.ComponentQuery.query('#Bus_Reg_T52LocationType1')[0].setValue(true);
        Ext.ComponentQuery.query('#Bus_Reg_T52LocationType2')[0].setValue(false);
        Ext.ComponentQuery.query('#Bus_Reg_T52LocationType3')[0].setValue(false);
        Ext.ComponentQuery.query('#Bus_Reg_T52LocationType4')[0].setValue(false);

        var Bus_Reg_Contact_5= Ext.getStore('Bus_Reg_Contact_5');

        Ext.ComponentQuery.query('#Bus_Reg_T52_Child_HouseNo')[0].setValue("");
        Ext.ComponentQuery.query('#Bus_Reg_T52_Child_WardNo')[0].setValue("");
        Ext.ComponentQuery.query('#Bus_Reg_T52_Child_Tole')[0].setValue("");
        Ext.ComponentQuery.query('#Bus_Reg_T52_Child_VDC')[0].setValue("");

        //Ext.ComponentQuery.query('#Bus_Reg_T52_Child_District')[0].setValue("");
        Bus_Reg_Contact_5.getAt(3).set({Value:""});
        Bus_Reg_Contact_5.getAt(2).set({Value:""});
        Ext.ComponentQuery.query('#Bus_Reg_T52_Child_Region')[0].setValue("");
        Bus_Reg_Contact_5.getAt(1).set({Value:""});
        Bus_Reg_Contact_5.getAt(0).set({Value:""});   

        //end Set BusinessPersonnelForITAddressAddress

        //start Set BusinessPersonnelForIT   
        Ext.ComponentQuery.query('#Bus_Reg_T52FirstNameEnglish')[0].setValue("");
        Ext.ComponentQuery.query('#Bus_Reg_T52MiddleNameEnglish')[0].setValue("");
        Ext.ComponentQuery.query('#Bus_Reg_T52LastNameEnglish')[0].setValue("");
        Ext.ComponentQuery.query('#Bus_Reg_T52FirstNameNepali')[0].setValue("");
        Ext.ComponentQuery.query('#Bus_Reg_T52MiddleNameNepali')[0].setValue("");
        Ext.ComponentQuery.query('#Bus_Reg_T52LastNameNepali')[0].setValue("");
        Ext.ComponentQuery.query('#Bus_Reg_T52AppointedDate')[0].setValue("");
        Ext.ComponentQuery.query('#Bus_Reg_T52PaperType')[0].setValue("");
        Ext.ComponentQuery.query('#Bus_Reg_T52IdentityNo')[0].setValue("");
        Ext.ComponentQuery.query('#Bus_Reg_T52IssuedByOrg')[0].setValue("");
        Ext.ComponentQuery.query('#Bus_Reg_T52IssuedDate')[0].setValue("");
        Ext.ComponentQuery.query('#Bus_Reg_T52IssuedByOrgPlace')[0].setValue("");
        Ext.ComponentQuery.query('#Bus_Reg_T52DocumentTxt')[0].fullName="";
        Ext.ComponentQuery.query('#Bus_Reg_T52DocumentTxt')[0].setValue("");
        Ext.ComponentQuery.query('#Bus_Reg_T52Post')[0].setValue("");
        //end Set BusinessPersonnelForIT


        //
        Ext.ComponentQuery.query('#Bus_Reg_T3BusType')[0].setValue("");
        Ext.ComponentQuery.query('#Bus_Reg_T3BusSubType')[0].setValue("");
        Ext.ComponentQuery.query('#Bus_Reg_T3BusDetList')[0].getStore().removeAll();
        ///

        //rent start
        var Bus_Reg_Contact_Rent= Ext.getStore('Bus_Reg_Contact_Rent');


        Ext.ComponentQuery.query('#Bus_Reg_T4LocationType1')[0].setValue(true);
        Ext.ComponentQuery.query('#Bus_Reg_T4LocationType2')[0].setValue(false);
        Ext.ComponentQuery.query('#Bus_Reg_T4LocationType3')[0].setValue(false);
        Ext.ComponentQuery.query('#Bus_Reg_T4LocationType4')[0].setValue(false);



        Ext.ComponentQuery.query('#Bus_Reg_T4_Child_HouseNo')[0].setValue('');
        Ext.ComponentQuery.query('#Bus_Reg_T4_Child_WardNo')[0].setValue('');
        Ext.ComponentQuery.query('#Bus_Reg_T4_Child_Tole')[0].setValue('');
        Ext.ComponentQuery.query('#Bus_Reg_T4_Child_VDC')[0].setValue('');

        Ext.ComponentQuery.query('#Bus_Reg_T4_Child_District')[0].setValue('');
        Bus_Reg_Contact_Rent.getAt(3).set({Value:''});                
        Bus_Reg_Contact_Rent.getAt(2).set({Value:''});
        Bus_Reg_Contact_Rent.getAt(1).set({Value:''});
        Bus_Reg_Contact_Rent.getAt(0).set({Value:''});


        Ext.ComponentQuery.query('#Bus_Reg_T4HouseOwnerPanNo')[0].setValue('');
        Ext.ComponentQuery.query('#Bus_Reg_T4HouseOwnerName')[0].setValue('');
        Ext.ComponentQuery.query('#Bus_Reg_T4RoomSize')[0].setValue('');
        Ext.ComponentQuery.query('#Bus_Reg_T4KittaNo')[0].setValue('');
        Ext.ComponentQuery.query('#Bus_Reg_T4Rent')[0].setValue('');
        Ext.ComponentQuery.query('#Bus_Reg_T4RentalDate')[0].setValue('');
        //rent end
    },

    submitMessage: function(obj) {
        var winPopup = Ext.create('MyApp.view.SubmitError',{
            autoScroll:true,
            width:700,
            height:500,

            draggable:true,
            maximizable:true,
            minimizable:true,
            resizable:false,
            modal:true,
            title:"",
            y:80,
            layout:'fit'
        });           

        winPopup.extraParam={param:obj};
        winPopup.show();

    },

    init: function(application) {
        this.control({
            "#Bus_Reg_Next": {
                click: this.onBus_Reg_NextClick
            },
            "#Bus_Reg_BtnSave": {
                click: this.onBus_Reg_BtnSaveClick
            },
            "#Bus_Reg_btnSubmit": {
                click: this.onBus_Reg_btnSubmitClick
            },
            "#busReg_btnAddBusiness": {
                click: this.onBusReg_btnAddBusinessClick
            },
            "#Bus_Reg_T3BusType": {
                change: this.onBus_Reg_T3BusTypeChange
            },
            "#Bus_Reg_T3Add": {
                click: this.onBus_Reg_T3AddClick
            },
            "#Bus_Reg_T1District": {
                collapse: this.onBus_Reg_T1DistrictCollapse
            },
            "#Bus_Reg_T2District": {
                collapse: this.onBus_Reg_T2DistrictCollapse
            },
            "#BusinessRegistration": {
                afterrender: this.onBusinessRegistrationAfterRender
            },
            "#Bus_Reg_BtnPrint": {
                click: this.onBus_Reg_BtnPrintClick
            },
            "#Bus_Reg_btnCancel": {
                click: this.onBus_Reg_btnCancelClick
            }
        });
    }

});
