{
    "type": "Ext.app.Application",
    "reference": {
        "name": "items",
        "type": "array"
    },
    "codeClass": null,
    "userConfig": {
        "controllers": [
            "LoginSecurity",
            "MenuController"
        ],
        "models": [
            "TreePanelModel"
        ],
        "name": "MyApp",
        "stores": [
            "TreePanelDataStore"
        ],
        "views": [
            "FloorSheetUpload",
            "MyPanel"
        ]
    },
    "configAlternates": {
        "controllers": "typedarray",
        "models": "typedarray",
        "name": "string",
        "stores": "typedarray",
        "views": "typedarray"
    },
    "name": "Application",
    "designerId": "application",
    "cn": [
        {
            "type": "fixedfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "launch",
                "implHandler": [
                    "var me = this;\r",
                    "var clear = false;\r",
                    "var main = me.getController('MyApp.controller.Main');\r",
                    "\r",
                    "\r",
                    "var el = Ext.get('logOUt');\r",
                    "var elLoginTitle = Ext.get('LoginTitle');\r",
                    "\r",
                    "var txtToken = getParameterByName('token');\r",
                    "\r",
                    "if (txtToken.length > 30) {\r",
                    "    var txtModule = getParameterByName('module');\r",
                    "    Ext.Ajax.request({\r",
                    "        url: '../Handlers/Security/SessionHandler.ashx?',\r",
                    "        params: { token: txtToken, module: txtModule, method: 'LoginByToken' },\r",
                    "        success: function (result, request) {\r",
                    "            var obj = Ext.decode(result.responseText);\r",
                    "\r",
                    "            var el = Ext.get('logOUt');\r",
                    "            var elLoginTitle = Ext.get('LoginTitle');\r",
                    "            var elNepDate = Ext.get('nepDate');\r",
                    "            var elOffCode = Ext.get('offCode');\r",
                    "            // alert(\"success: \"+obj.success);\r",
                    "            if (obj.success == \"true\") {\r",
                    "\r",
                    "                //Sets Office Code\r",
                    "                elOffCode.dom.innerHTML = obj.root.Obj.OfficeUser.OfficeCode;\r",
                    "\r",
                    "                //Sets Nepali Date\r",
                    "                GetNepaliDate(function (nepaliDate) {\r",
                    "                    elNepDate.dom.innerHTML = nepaliDate;\r",
                    "                });\r",
                    "\r",
                    "\r",
                    "                el.child('span').dom.innerHTML = \"LogOut\";\r",
                    "                me.getController('MyApp.controller.Main').showMainView();\r",
                    "\r",
                    "                var store = Ext.getStore('TreePanelDataStore');\r",
                    "                if (store)\r",
                    "                store.setRootNode(obj.root.MenuObj);\r",
                    "\r",
                    "            }\r",
                    "            else {\r",
                    "                msg(\"FAILURE\", obj.message);\r",
                    "            }\r",
                    "\r",
                    "        },\r",
                    "\r",
                    "        failure: function (form, action) {\r",
                    "            waitSave.hide();\r",
                    "            var user = me.getController('MyApp.controller.LoginSecurity');\r",
                    "            var valid = user.validateSession(\"default\");\r",
                    "            if (valid) {\r",
                    "                el.child('span').dom.innerHTML = \"LogOut\";\r",
                    "                main.showMainView();\r",
                    "\r",
                    "\r",
                    "                if (txtToken.length < 30) {\r",
                    "                    main.LoadUserFromSession();\r",
                    "                }\r",
                    "            }\r",
                    "            switch (action.failureType) {\r",
                    "                case Ext.form.action.Action.CLIENT_INVALID:\r",
                    "                msg('Failure', 'Form fields may not be submitted with invalid values');\r",
                    "                break;\r",
                    "                case Ext.form.action.Action.CONNECT_FAILURE:\r",
                    "                msg('Failure', 'Ajax communication failed');\r",
                    "                break;\r",
                    "                case Ext.form.action.Action.SERVER_INVALID:\r",
                    "                msg('Failure', action.result.msg);\r",
                    "            }\r",
                    "        }\r",
                    "\r",
                    "    });\r",
                    "}\r",
                    "else {\r",
                    "    var user = me.getController('MyApp.controller.LoginSecurity');\r",
                    "    var valid = user.validateSession(\"default\");\r",
                    "    if (valid) {\r",
                    "        el.child('span').dom.innerHTML = \"LogOut\";\r",
                    "        main.showMainView();\r",
                    "\r",
                    "\r",
                    "        if (txtToken.length < 30) {\r",
                    "            main.LoadUserFromSession();\r",
                    "        }\r",
                    "    }\r",
                    "}\r",
                    "\r",
                    "\r",
                    "el.on('click', function (e, t, eOpts) {\r",
                    "\r",
                    "    if (el.child('span').dom.innerHTML !== \"LogIn\") {\r",
                    "        el.child('span').dom.innerHTML = \"LogIn\";\r",
                    "        elLoginTitle.dom.innerHTML = \"Welcome\";\r",
                    "        clear = user.clearSession();\r",
                    "    }\r",
                    "});\r",
                    ""
                ]
            },
            "configAlternates": {
                "fn": "string",
                "implHandler": "code"
            },
            "name": "launch",
            "designerId": "7a251e9f-4e7a-4973-beb5-6145b61f9ad5"
        }
    ]
}