{
    "type": "Ext.panel.Panel",
    "reference": {
        "name": "items",
        "type": "array"
    },
    "codeClass": null,
    "userConfig": {
        "designer|userClassName": "DepartmentMap",
        "frame": true,
        "title": "Department Map"
    },
    "configAlternates": {
        "designer|userClassName": "string",
        "height": "auto",
        "title": "string",
        "width": "auto",
        "frame": "boolean"
    },
    "name": "MyPanel18",
    "designerId": "64c5a134-c288-4d28-af5a-f96b06e4a5eb",
    "cn": [
        {
            "type": "Ext.form.Panel",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "bodyPadding": 10,
                "frame": true,
                "itemId": "frmDepartmentMap"
            },
            "configAlternates": {
                "bodyPadding": "auto",
                "itemId": "string",
                "frame": "boolean"
            },
            "name": "MyForm14",
            "designerId": "2f755721-193d-424d-9101-629c3e324991",
            "cn": [
                {
                    "type": "Ext.form.field.ComboBox",
                    "reference": {
                        "name": "items",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "displayField": "OfficeName",
                        "emptyText": "- - - Select Office - - -",
                        "fieldLabel": "Office",
                        "forceSelection": true,
                        "itemId": "ddlOffice",
                        "layout|anchor": "100%",
                        "maxWidth": 400,
                        "queryMode": "local",
                        "store": "OfficeShortStore",
                        "valueField": "OfficeCode",
                        "width": 400
                    },
                    "configAlternates": {
                        "displayField": "datafield",
                        "fieldLabel": "string",
                        "forceSelection": "boolean",
                        "itemId": "string",
                        "layout|anchor": "string",
                        "store": "store",
                        "valueField": "datafield",
                        "emptyText": "string",
                        "maxWidth": "number",
                        "queryMode": "string",
                        "width": "auto"
                    },
                    "name": "MyComboBox18",
                    "designerId": "fc8fda51-3714-4f3d-92b5-6c260d460c36",
                    "cn": [
                        {
                            "type": "basiceventbinding",
                            "reference": {
                                "name": "listeners",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "fn": "onDdlOfficeChange",
                                "implHandler": [
                                    "var store=Ext.getStore('DepartmentMapStore');",
                                    "store.removeAll();",
                                    "",
                                    "Ext.Ajax.request({",
                                    "    url: '../Handlers/GeneralMasterParameters/Maintenance/DepartmentMapHandler.ashx',",
                                    "    params: {",
                                    "        method:'GetOfficeDepartment',officeCode:field.getValue()",
                                    "    },",
                                    "    success: function(response){",
                                    "",
                                    "    var data=Ext.decode(response.responseText);",
                                    "    store.removeAll();",
                                    "    store.add(data.root);",
                                    "",
                                    "",
                                    "}",
                                    "});"
                                ],
                                "name": "change",
                                "scope": "me"
                            },
                            "configAlternates": {
                                "fn": "string",
                                "implHandler": "code",
                                "name": "string",
                                "scope": "string"
                            },
                            "name": "onDdlOfficeChange",
                            "designerId": "83712419-3382-449a-8744-f6a96575dd0c"
                        }
                    ]
                },
                {
                    "type": "Ext.grid.Panel",
                    "reference": {
                        "name": "items",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "itemId": "grdDepartment",
                        "store": "DepartmentMapStore",
                        "title": "Departments"
                    },
                    "configAlternates": {
                        "itemId": "string",
                        "store": "store",
                        "title": "string"
                    },
                    "name": "MyGridPanel13",
                    "designerId": "6dd6ac15-2b64-47db-a26f-e3ef36efbd65",
                    "cn": [
                        {
                            "type": "Ext.grid.View",
                            "reference": {
                                "name": "viewConfig",
                                "type": "object"
                            },
                            "codeClass": null,
                            "name": "MyGridView13",
                            "designerId": "9850d083-56fb-4b7d-9f1c-ae6b64c351c7"
                        },
                        {
                            "type": "Ext.grid.column.Column",
                            "reference": {
                                "name": "columns",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "dataIndex": "InstituteCode",
                                "text": "InstituteCode"
                            },
                            "configAlternates": {
                                "dataIndex": "datafield",
                                "text": "string"
                            },
                            "name": "MyColumn115",
                            "designerId": "d203186e-8916-452b-8401-1555d0a1fca0"
                        },
                        {
                            "type": "Ext.grid.column.Column",
                            "reference": {
                                "name": "columns",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "dataIndex": "DeptCode",
                                "text": "DepartmentCode",
                                "width": 312
                            },
                            "configAlternates": {
                                "dataIndex": "datafield",
                                "text": "string",
                                "width": "auto"
                            },
                            "name": "MyColumn118",
                            "designerId": "c256fab2-7a59-4f86-adc2-f1b6e10e7883",
                            "cn": [
                                {
                                    "type": "Ext.form.field.ComboBox",
                                    "reference": {
                                        "name": "editor",
                                        "type": "object"
                                    },
                                    "codeClass": null,
                                    "userConfig": {
                                        "displayField": "DeptName",
                                        "forceSelection": true,
                                        "itemId": "ddlDepartmentCode",
                                        "queryMode": "local",
                                        "store": "DepartmentShortStore",
                                        "valueField": "DeptCode"
                                    },
                                    "configAlternates": {
                                        "displayField": "datafield",
                                        "forceSelection": "boolean",
                                        "itemId": "string",
                                        "store": "store",
                                        "valueField": "datafield",
                                        "queryMode": "string"
                                    },
                                    "name": "MyComboBox26",
                                    "designerId": "57e45ad6-2fe6-4dee-87b9-f3ed9fd0f8dc"
                                }
                            ]
                        },
                        {
                            "type": "Ext.grid.column.Column",
                            "reference": {
                                "name": "columns",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "dataIndex": "Action",
                                "text": "Action"
                            },
                            "configAlternates": {
                                "dataIndex": "datafield",
                                "text": "string"
                            },
                            "name": "MyColumn119",
                            "designerId": "b9b78845-b4ee-462d-a220-3eadf15f06bb",
                            "cn": [
                                {
                                    "type": "Ext.form.field.Text",
                                    "reference": {
                                        "name": "editor",
                                        "type": "object"
                                    },
                                    "codeClass": null,
                                    "userConfig": {
                                        "itemId": "txtAction",
                                        "readOnly": true
                                    },
                                    "configAlternates": {
                                        "itemId": "string",
                                        "readOnly": "boolean"
                                    },
                                    "name": "MyTextField177",
                                    "designerId": "e5f79ebb-82f6-45aa-9bb7-06a4f82693b8"
                                }
                            ]
                        },
                        {
                            "type": "Ext.grid.column.Action",
                            "reference": {
                                "name": "columns",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "itemId": "delDepartmentMap"
                            },
                            "configAlternates": {
                                "itemId": "string"
                            },
                            "name": "MyActionColumn18",
                            "designerId": "0f90230a-5e87-4f8c-bf6a-1a6dcfc9be7d",
                            "cn": [
                                {
                                    "type": "actioncolumnitem",
                                    "reference": {
                                        "name": "items",
                                        "type": "array"
                                    },
                                    "codeClass": null,
                                    "userConfig": {
                                        "icon": "../ITS/resources/images/icons/cancel.png"
                                    },
                                    "configAlternates": {
                                        "icon": "string"
                                    },
                                    "name": "MyActionColumnItem17",
                                    "designerId": "5547e388-dbf5-4cc2-b68a-5aa7d92e23cc",
                                    "cn": [
                                        {
                                            "type": "fixedfunction",
                                            "reference": {
                                                "name": "items",
                                                "type": "array"
                                            },
                                            "codeClass": null,
                                            "userConfig": {
                                                "designer|params": [
                                                    "view",
                                                    "rowIndex",
                                                    "colIndex",
                                                    "item",
                                                    "e",
                                                    "record",
                                                    "row"
                                                ],
                                                "fn": "handler",
                                                "implHandler": [
                                                    "var store = Ext.getStore('DepartmentMapStore');",
                                                    "var grd =  Ext.ComponentQuery.query('#grdDepartment')[0];",
                                                    "var row = store.getAt(rowIndex).data;",
                                                    "",
                                                    "Ext.Msg.confirm('Confirm Action', 'Do you want to Remove the selected Department ?', function(btn) {",
                                                    "    if(btn == 'yes'){",
                                                    "",
                                                    "        /*",
                                                    "        nepaliDateConversion.FiscalYear, OracleDbType.Varchar2, ParameterDirection.Input));",
                                                    "            paramList.Add(SqlHelper.GetOraParam(\":P_MONTH_CODE\", nepaliDateConversion.MonthCode, OracleDbType.Int16, ParameterDirection.Input));",
                                                    "            paramList.Add(SqlHelper.GetOraParam(\":P_ENGLISH_START_DATE\", nepaliDateConversion.EnglishStartDate, OracleDbType.Varchar2, ParameterDirection.Input));",
                                                    "            paramList.Add(SqlHelper.GetOraParam(\":P_NEPALI_START_DATE\", nepaliDateConversion.NepaliStartDate, OracleDbType.Varchar2, ParameterDirection.Input));",
                                                    "            paramList.Add(SqlHelper.GetOraParam(\":P_ENGLISH_END_DATE\", nepaliDateConversion.EnglishEndDate, OracleDbType.Varchar2, ParameterDirection.Input));",
                                                    "            paramList.Add(SqlHelper.GetOraParam(\":P_NEPALI_END_DATE\", nepaliDateConversion.NepaliEndDate, OracleDbType.Varchar2, ParameterDirection.Input));",
                                                    "            paramList.Add(SqlHelper.GetOraParam(\":P_NEPALI_YEAR\", nepaliDateConversion.NepaliYear, OracleDbType.Int16, ParameterDirection.Input));",
                                                    "            paramList.Add(SqlHelper.GetOraParam(\":P_NEPALI_PERIOD\", nepaliDateConversion.NepaliPeriod, OracleDbType.Int16, ParameterDirection.Input));",
                                                    "            paramList.Add(SqlHelper.GetOraParam(\":P_NO_OF_DAYS_IN_MONTH\", nepaliDateConversion.NoOfDays, OracleDbType.Int16, ParameterDirection.Input));",
                                                    "            paramList.Add(SqlHelper.GetOraParam(\":P_CREATED_MODIFIED_ON\", nepaliDateConversion.CreatedOn, OracleDbType.Varchar2, ParameterDirection.Input));",
                                                    "            paramList.Add(SqlHelper.GetOraParam(\":P_CREATED_MODIFIED_BY\", nepaliDateConversion.CreatedBy, OracleDbType.Varchar2, ParameterDirection.Input));",
                                                    "            paramList.Add(SqlHelper.GetOraParam(\":P_INSERT_UPDATE\", nepaliDateConversion.Action, OracleDbType.Varchar2, ParameterDirection.Input));",
                                                    "            paramList.Add(SqlHelper.GetOraParam(\":P_OUT_RESULT_CODE\", null, OracleDbType.Varchar2, ParameterDirection.Output));",
                                                    "            paramList.Add(SqlHelper.GetOraParam(\":P_OUT_RESULT_DESC\", null, OracleDbType.",
                                                    "            */",
                                                    "        var rec={InstituteCode:row.InstituteCode,",
                                                    "         DeptCode:row.DeptCode,",
                                                    "         Action:'D'};",
                                                    "",
                                                    "        var wMsg='Deleting....';",
                                                    "",
                                                    "        var waitSave = watiMsg(wMsg);",
                                                    "",
                                                    "        Ext.Ajax.request({",
                                                    "                    url: '../Handlers/GeneralMasterParamters/Maintenance/DepartmentMapHandler.ashx',",
                                                    "                    params: {",
                                                    "                        method:'Save',",
                                                    "                        departmntMap:JSON.stringify(rec)",
                                                    "                    },",
                                                    "                    success: function(response){",
                                                    "                    waitSave.hide();",
                                                    "                    var out=Ext.decode(response.responseText);",
                                                    "                    console.log(out);",
                                                    "",
                                                    "                    if(out.success===\"true\")",
                                                    "                        {",
                                                    "                            var message=out.root;",
                                                    "                                    msg(\"SUCCESS\",message.OutResultMessage,function(){",
                                                    "                                        grd.bindStore(store);",
                                                    "                                        store.removeAt(rowIndex);",
                                                    "                                    });",
                                                    "",
                                                    "",
                                                    "",
                                                    "                        }",
                                                    "                        else",
                                                    "                            {",
                                                    "                                msg(\"FAILURE\",out.message);",
                                                    "                            }",
                                                    "                    },",
                                                    "                    failure: function ( result, request ) {",
                                                    "                        waitSave.hide();",
                                                    "                        var out=Ext.decode(response.responseText);",
                                                    "                        msg(\"FAILURE\",out.message);",
                                                    "                    }",
                                                    "",
                                                    "                });",
                                                    "",
                                                    "",
                                                    "",
                                                    "        return true;",
                                                    "    }",
                                                    "});"
                                                ]
                                            },
                                            "configAlternates": {
                                                "designer|params": "typedarray",
                                                "fn": "string",
                                                "implHandler": "code"
                                            },
                                            "name": "handler",
                                            "designerId": "d0ee9c54-b94a-4357-b1e9-a190b70700c8"
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "Ext.selection.RowModel",
                            "reference": {
                                "name": "selModel",
                                "type": "object"
                            },
                            "codeClass": "Ext.selection.RowModel",
                            "name": "MyRowSelectionModel12",
                            "designerId": "7df4342d-0ea7-4911-a642-0aaa60a304b2"
                        },
                        {
                            "type": "Ext.toolbar.Toolbar",
                            "reference": {
                                "name": "dockedItems",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "dock": "top"
                            },
                            "configAlternates": {
                                "dock": "string"
                            },
                            "name": "MyToolbar16",
                            "designerId": "604e7d1b-54f3-4bf0-8e50-14f9cbf94f5e",
                            "cn": [
                                {
                                    "type": "Ext.button.Button",
                                    "reference": {
                                        "name": "items",
                                        "type": "array"
                                    },
                                    "codeClass": null,
                                    "userConfig": {
                                        "itemId": "btnAddDepartmentMap",
                                        "layout|flex": null,
                                        "text": "Add Office Department"
                                    },
                                    "configAlternates": {
                                        "itemId": "string",
                                        "layout|flex": "number",
                                        "text": "string"
                                    },
                                    "name": "MyButton32",
                                    "designerId": "0f67f324-b678-4204-9b33-8e9c426c78c0",
                                    "cn": [
                                        {
                                            "type": "basiceventbinding",
                                            "reference": {
                                                "name": "listeners",
                                                "type": "array"
                                            },
                                            "codeClass": null,
                                            "userConfig": {
                                                "fn": "onBtnAddDepartmentMapClick",
                                                "implHandler": [
                                                    "var office=Ext.ComponentQuery.query('#ddlOffice')[0];",
                                                    "if(office.getValue()===''||office.getValue()===null)",
                                                    "    {",
                                                    "        msg('WARNING','Please, Select Office');",
                                                    "        return;",
                                                    "    }",
                                                    "var store =Ext.getStore('DepartmentMapStore');",
                                                    "var rec={InstituteCode:'',",
                                                    "         DeptCode:'',",
                                                    "         Action:'I'};",
                                                    "store.add(rec);",
                                                    ""
                                                ],
                                                "name": "click",
                                                "scope": "me"
                                            },
                                            "configAlternates": {
                                                "fn": "string",
                                                "name": "string",
                                                "scope": "string",
                                                "implHandler": "code"
                                            },
                                            "name": "onBtnAddDepartmentMapClick",
                                            "designerId": "41b9836c-96e0-4c24-8eb3-82fafe55bab0"
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "Ext.grid.plugin.RowEditing",
                            "reference": {
                                "name": "plugins",
                                "type": "array"
                            },
                            "codeClass": "Ext.grid.plugin.RowEditing",
                            "name": "MyRowEditingPlugin16",
                            "designerId": "579c2d6a-a091-4781-b8a1-1e88c892fec8",
                            "cn": [
                                {
                                    "type": "basiceventbinding",
                                    "reference": {
                                        "name": "listeners",
                                        "type": "array"
                                    },
                                    "codeClass": null,
                                    "userConfig": {
                                        "fn": "onRowEditingValidateedit",
                                        "implHandler": [
                                            "var errMsg='';",
                                            "var office=Ext.ComponentQuery.query('#ddlOffice')[0];",
                                            "var department=Ext.ComponentQuery.query('#ddlDepartmentCode')[0];",
                                            "var action=Ext.ComponentQuery.query('#txtAction')[0];",
                                            "",
                                            "if(department.getValue()===null ||department.getValue()===\"\")",
                                            "    {",
                                            "        errMsg+=\"Please, Select Department\";",
                                            "    }",
                                            "",
                                            "",
                                            "if(errMsg!=='')",
                                            "    {",
                                            "        msg(\"WARNING\",errMsg);",
                                            "        return;",
                                            "    }",
                                            "/*",
                                            "p_category_no                               IN           NUMBER,",
                                            "                                 p_category_desc                             IN           VARCHAR2,",
                                            "                                 p_category_initial                          IN           VARCHAR2,",
                                            "                                 p_tran_office_code                          IN           VARCHAR2,       */",
                                            "",
                                            "var rec={InstituteCode:office.getValue(),",
                                            "         DeptCode:department.getValue(),",
                                            "         Action:action.getValue()};",
                                            "",
                                            "",
                                            "",
                                            "var wMsg='';",
                                            "if(action.getValue()==='I')",
                                            "    {",
                                            "        wMsg='Inserting....';",
                                            "    }",
                                            "else",
                                            "    {",
                                            "        wMsg='Updating....';",
                                            "    }",
                                            "var waitSave = watiMsg(wMsg);",
                                            "",
                                            "Ext.Ajax.request({",
                                            "            url: '../Handlers/GeneralMasterParameters/Maintenance/DepartmentMapHandler.ashx',",
                                            "            params: {",
                                            "                method:'Save',",
                                            "                departmentMap:JSON.stringify(rec)",
                                            "            },",
                                            "            success: function(response){",
                                            "            waitSave.hide();",
                                            "            var out=Ext.decode(response.responseText);",
                                            "            console.log(out);",
                                            "",
                                            "            if(out.success===\"true\")",
                                            "                {",
                                            "                    var message=out.root;",
                                            "                            msg(\"SUCCESS\",message.OutResultMessage,function(){",
                                            "                                var grd = Ext.ComponentQuery.query('#grdDepartment')[0];",
                                            "",
                                            "                                var record = grd.getSelectionModel().getSelection()[0];",
                                            "                                record.set('Action','U');",
                                            "",
                                            "                            });",
                                            "",
                                            "",
                                            "",
                                            "",
                                            "                }",
                                            "                else",
                                            "                    {",
                                            "                        msg(\"FAILURE\",out.message);",
                                            "                    }",
                                            "            },",
                                            "            failure: function ( result, request ) {",
                                            "                waitSave.hide();",
                                            "                var out=Ext.decode(response.responseText);",
                                            "                msg(\"FAILURE\",out.message);",
                                            "            }",
                                            "",
                                            "        });",
                                            ""
                                        ],
                                        "name": "validateedit",
                                        "scope": "me"
                                    },
                                    "configAlternates": {
                                        "fn": "string",
                                        "implHandler": "code",
                                        "name": "string",
                                        "scope": "string"
                                    },
                                    "name": "onRowEditingValidateedit",
                                    "designerId": "be8874c1-f90d-42c7-b53d-9a71cc7f209e"
                                },
                                {
                                    "type": "basiceventbinding",
                                    "reference": {
                                        "name": "listeners",
                                        "type": "array"
                                    },
                                    "codeClass": null,
                                    "userConfig": {
                                        "fn": "onRowEditingCanceledit",
                                        "name": "canceledit",
                                        "scope": "me"
                                    },
                                    "configAlternates": {
                                        "fn": "string",
                                        "name": "string",
                                        "scope": "string"
                                    },
                                    "name": "onRowEditingCanceledit",
                                    "designerId": "3f0a4693-10c3-437f-941c-ad4724fc0f62"
                                }
                            ]
                        },
                        {
                            "type": "basiceventbinding",
                            "reference": {
                                "name": "listeners",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "fn": "onGrdDepartmentBeforeRender",
                                "implHandler": [
                                    "var grid = Ext.ComponentQuery.query('#grdDepartment')[0];",
                                    "",
                                    "        grid.columns[1].renderer = function(value, metaData, record, rowIndex, colIndex, store, view) {",
                                    "            var temp=\"\";",
                                    "",
                                    "",
                                    "            var items=Ext.getStore('DepartmentShortStore').data.items;",
                                    "",
                                    "",
                                    "            for(var i=0;i<items.length;i++)",
                                    "            {",
                                    "                ",
                                    "                if(items[i].data.DeptCode==value)",
                                    "                {",
                                    "                    temp=items[i].data.DeptName;",
                                    "                    break;",
                                    "                }",
                                    "            }",
                                    "",
                                    "",
                                    "            return temp;",
                                    "        };"
                                ],
                                "name": "beforerender",
                                "scope": "me"
                            },
                            "configAlternates": {
                                "fn": "string",
                                "implHandler": "code",
                                "name": "string",
                                "scope": "string"
                            },
                            "name": "onGrdDepartmentBeforeRender",
                            "designerId": "1a7f8a55-da2f-409e-99ad-fce57946ab13"
                        }
                    ]
                },
                {
                    "type": "basiceventbinding",
                    "reference": {
                        "name": "listeners",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "fn": "onFrmDepartmentMapAfterRender",
                        "implHandler": [
                            "var store=Ext.getStore('OfficeShortStore');",
                            "store.removeAll();",
                            "",
                            "Ext.Ajax.request({",
                            "    url: '../Handlers/GeneralMasterParameters/Office/OfficeHandler.ashx',",
                            "    params: {",
                            "        method:'GetOfficeShort'",
                            "    },",
                            "    success: function(response){",
                            "",
                            "    var data=Ext.decode(response.responseText);",
                            "    store.removeAll();",
                            "    store.add(data.root);",
                            "",
                            "",
                            "}",
                            "});",
                            "",
                            "",
                            "var deptStore=Ext.getStore('DepartmentShortStore');",
                            "store.removeAll();",
                            "",
                            "Ext.Ajax.request({",
                            "    url: '../Handlers/GeneralMasterParameters/Maintenance/DepartmentHandler.ashx',",
                            "    params: {",
                            "        method:'GetDepartmentShort'",
                            "    },",
                            "    success: function(response){",
                            "",
                            "    var data=Ext.decode(response.responseText);",
                            "    deptStore.removeAll();",
                            "    deptStore.add(data.root);",
                            "",
                            "",
                            "}",
                            "});"
                        ],
                        "name": "afterrender",
                        "scope": "me"
                    },
                    "configAlternates": {
                        "fn": "string",
                        "implHandler": "code",
                        "name": "string",
                        "scope": "string"
                    },
                    "name": "onFrmDepartmentMapAfterRender",
                    "designerId": "b0964480-f3e0-45b4-85a1-c2c68328dd6b"
                }
            ]
        }
    ]
}