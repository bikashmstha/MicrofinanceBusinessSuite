/*
 * File: app/view/AmendedAssmnt.js
 *
 * This file was generated by Sencha Architect version 2.2.3.
 * http://www.sencha.com/products/architect/
 *
 * This file requires use of the Ext JS 4.1.x library, under independent license.
 * License of Sencha Architect does not include license for Ext JS 4.1.x. For more
 * details see http://www.sencha.com/license or contact license@sencha.com.
 *
 * This file will be auto-generated each and everytime you save your project.
 *
 * Do NOT hand edit this file.
 */

Ext.define('MyApp.view.AmendedAssmnt', {
    extend: 'Ext.panel.Panel',

    frame: true,
    itemId: 'pnlAmendedAssmnt',
    width: 860,
    autoScroll: true,
    title: 'आयकर निर्धारण र संशोधन प्रबिष्ठि',

    initComponent: function() {
        var me = this;

        Ext.applyIf(me, {
            items: [
                {
                    xtype: 'form',
                    frame: true,
                    itemId: 'frmSelfAssessmentPaa',
                    margin: 5,
                    bodyPadding: 10,
                    items: [
                        {
                            xtype: 'container',
                            itemId: 'cntHeaderPaa',
                            margin: '0 0 0 280',
                            items: [
                                {
                                    xtype: 'displayfield',
                                    itemId: 'lblSubmissionNoPaa',
                                    style: 'font-size:20px',
                                    width: 400,
                                    fieldLabel: 'आयकर निर्धारण र संशोधन प्रबिष्ठि',
                                    labelSeparator: ' ',
                                    labelStyle: 'font-size:20px',
                                    labelWidth: 400,
                                    fieldStyle: 'font-weight:bold;padding-top:8px;'
                                }
                            ]
                        },
                        {
                            xtype: 'label',
                            hidden: true,
                            itemId: 'lblActionPaa',
                            margin: '15 0 -5 0',
                            style: '{color:red;}',
                            text: 'Updating ...'
                        },
                        {
                            xtype: 'fieldset',
                            height: 118,
                            margin: '30 0 5 0 ',
                            title: '',
                            items: [
                                {
                                    xtype: 'textfield',
                                    itemId: 'txtOfficeCodePaa',
                                    margin: '5 0 5 0',
                                    maxWidth: 140,
                                    width: 120,
                                    fieldLabel: 'कार्यालय कोड',
                                    labelWidth: 80,
                                    allowBlank: false,
                                    enforceMaxLength: false,
                                    maxLength: 12,
                                    minLength: 12
                                },
                                {
                                    xtype: 'textfield',
                                    disabled: true,
                                    itemId: 'txtSubmissionNoPaa',
                                    margin: '2 2 5 2',
                                    fieldLabel: 'कर निर्धारण (आदेश) / सूचना नम्बर',
                                    labelWidth: 180,
                                    enableKeyEvents: true,
                                    enforceMaxLength: true,
                                    maxLength: 12,
                                    minLength: 12
                                },
                                {
                                    xtype: 'textfield',
                                    itemId: 'txtAssmntDatePaa',
                                    margin: '2 2 5 2',
                                    width: 282,
                                    fieldLabel: 'कर निर्धारण (आदेश) / सूचना मिति',
                                    labelWidth: 180,
                                    allowBlank: false,
                                    emptyText: 'YYYY.MM.DD',
                                    enforceMaxLength: true,
                                    maskRe: /[0-9.]/,
                                    maxLength: 10,
                                    minLength: 9,
                                    listeners: {
                                        blur: {
                                            fn: me.onTxtMaDatePaaBlur,
                                            scope: me
                                        }
                                    }
                                },
                                {
                                    xtype: 'textfield',
                                    itemId: 'txtPanPaa',
                                    margin: '2 2 5 2',
                                    fieldLabel: 'स्थायी  लेखा  नम्बर. ',
                                    labelWidth: 180,
                                    emptyText: '  |   |   |   |   |   |   |   |',
                                    enableKeyEvents: true,
                                    enforceMaxLength: true,
                                    maxLength: 9,
                                    minLength: 9,
                                    listeners: {
                                        blur: {
                                            fn: me.onTxtPanPaaBlur,
                                            scope: me
                                        }
                                    }
                                }
                            ]
                        },
                        {
                            xtype: 'panel',
                            frame: true,
                            height: 200,
                            margin: '0 0 5 0',
                            layout: {
                                columns: 6,
                                type: 'table'
                            },
                            bodyPadding: 10,
                            collapseFirst: false,
                            title: ' फर्म सम्बन्धी विवरण',
                            items: [
                                {
                                    xtype: 'container',
                                    cls: 'extTbl',
                                    height: 180,
                                    width: 795,
                                    layout: {
                                        columns: 6,
                                        type: 'table'
                                    },
                                    items: [
                                        {
                                            xtype: 'textfield',
                                            colspan: 6,
                                            itemId: 'txtNamePaa',
                                            margin: '5px 0 0 0',
                                            width: 780,
                                            fieldLabel: 'नाम ',
                                            labelWidth: 73,
                                            readOnly: true
                                        },
                                        {
                                            xtype: 'label',
                                            colspan: 1,
                                            margin: '5px 0 0 0',
                                            text: 'ठेगाना '
                                        },
                                        {
                                            xtype: 'label',
                                            margin: '5px 0 0 0',
                                            style: 'margin-right:30px;',
                                            text: 'घर नं .'
                                        },
                                        {
                                            xtype: 'label',
                                            margin: '5px 0 0 0',
                                            style: 'margin-right:30px;',
                                            text: 'वार्ड नं .'
                                        },
                                        {
                                            xtype: 'label',
                                            margin: '5px 0 0 0',
                                            style: 'margin-right:30px;',
                                            text: 'गांउ / टोल र बाटोको नाम'
                                        },
                                        {
                                            xtype: 'radiogroup',
                                            itemId: 'rbtnsLocationPaa',
                                            margin: '5px 0 0 0',
                                            width: 200,
                                            fieldLabel: '',
                                            columns: 2,
                                            items: [
                                                {
                                                    xtype: 'radiofield',
                                                    name: 'loc',
                                                    value: 'MM',
                                                    readOnly: true,
                                                    boxLabel: 'म. न. पा.',
                                                    inputValue: 'MM'
                                                },
                                                {
                                                    xtype: 'radiofield',
                                                    name: 'loc',
                                                    value: 'SM',
                                                    readOnly: true,
                                                    boxLabel: 'उ. म. न. पा.',
                                                    inputValue: 'SM'
                                                },
                                                {
                                                    xtype: 'radiofield',
                                                    name: 'loc',
                                                    value: 'MN',
                                                    readOnly: true,
                                                    boxLabel: 'न. पा.',
                                                    inputValue: 'MN'
                                                },
                                                {
                                                    xtype: 'radiofield',
                                                    name: 'loc',
                                                    value: 'VD',
                                                    readOnly: true,
                                                    boxLabel: 'गा. वि. स.',
                                                    inputValue: 'VD'
                                                }
                                            ]
                                        },
                                        {
                                            xtype: 'label',
                                            margin: '5px 0 0 0',
                                            style: 'margin-right:50px;',
                                            text: 'जिल्ला'
                                        },
                                        {
                                            xtype: 'textfield',
                                            colspan: 2,
                                            itemId: 'txtHouseNoPaa',
                                            margin: '5 0 0 80',
                                            width: 50,
                                            readOnly: true
                                        },
                                        {
                                            xtype: 'textfield',
                                            itemId: 'txtWardNoPaa',
                                            margin: '',
                                            width: 50,
                                            readOnly: true
                                        },
                                        {
                                            xtype: 'textfield',
                                            itemId: 'txtToleNamePaa',
                                            margin: '',
                                            width: 140,
                                            readOnly: true
                                        },
                                        {
                                            xtype: 'textfield',
                                            itemId: 'txtVDCNamePaa',
                                            margin: '',
                                            width: 200,
                                            readOnly: true
                                        },
                                        {
                                            xtype: 'textfield',
                                            itemId: 'txtDistrictNamePaa',
                                            margin: '',
                                            width: 125,
                                            readOnly: true
                                        },
                                        {
                                            xtype: 'textfield',
                                            colspan: 2,
                                            itemId: 'txtPhonePaa',
                                            margin: '5px 0 0 0',
                                            width: 150,
                                            fieldLabel: 'फोन ',
                                            labelWidth: 75,
                                            readOnly: true,
                                            enforceMaxLength: false
                                        },
                                        {
                                            xtype: 'textfield',
                                            colspan: 2,
                                            itemId: 'txtMobilePaa',
                                            margin: '5px 0 0 0',
                                            width: 207,
                                            fieldLabel: 'मोबाइल ',
                                            labelWidth: 62,
                                            readOnly: true
                                        },
                                        {
                                            xtype: 'textfield',
                                            colspan: 2,
                                            itemId: 'txtEmailPaa',
                                            margin: '5px 0 0 0',
                                            width: 360,
                                            fieldLabel: 'इमेल ',
                                            labelWidth: 60,
                                            readOnly: true
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            xtype: 'panel',
                            frame: true,
                            margin: '0 0 5 0',
                            bodyPadding: 10,
                            title: '१.  संशोधित कर निर्धारण आदेश',
                            items: [
                                {
                                    xtype: 'container',
                                    itemId: 'cntFiscalYearPaa',
                                    margin: '5 0 0 0 ',
                                    layout: {
                                        type: 'table'
                                    },
                                    items: [
                                        {
                                            xtype: 'combobox',
                                            itemId: 'cboFiscalYearPaa',
                                            fieldLabel: 'कर निर्धारणमा संशोधन गर्न लागेको आयवर्ष',
                                            labelWidth: 250,
                                            emptyText: 'Select ...',
                                            displayField: 'fiscalYear',
                                            store: 'FiscalYear',
                                            valueField: 'fiscalYear'
                                        },
                                        {
                                            xtype: 'label',
                                            colspan: 4,
                                            margin: '-15 0 0 5',
                                            width: 400,
                                            text: '( भर्ने उदाहरण २०६८.०६९ )'
                                        }
                                    ]
                                },
                                {
                                    xtype: 'combobox',
                                    itemId: 'cboAssmntTypePaa',
                                    width: 535,
                                    fieldLabel: 'संशोधन गर्न लागेका साविकको क.नि.को किसिम',
                                    labelWidth: 253,
                                    emptyText: 'Select ...',
                                    displayField: 'Name',
                                    queryMode: 'local',
                                    store: 'AssmntTypePaa',
                                    valueField: 'Value'
                                },
                                {
                                    xtype: 'button',
                                    itemId: 'btnUpdateAnxPaa',
                                    margin: '0 0 5 323',
                                    padding: 5,
                                    iconCls: 'icon-annex',
                                    text: 'Update Annex'
                                },
                                {
                                    xtype: 'button',
                                    itemId: 'btnTransferBackPaa',
                                    margin: '0 0 5 5',
                                    padding: 5,
                                    iconCls: 'icon-back',
                                    text: 'Transfer Back'
                                },
                                {
                                    xtype: 'gridpanel',
                                    itemId: 'grdAnxsReasonsPaa',
                                    margin: '0 0 5 0',
                                    width: 535,
                                    title: ' संलग्न गर्नु पर्ने कागजहरू',
                                    store: 'AnxsReasonsPaa',
                                    columns: [
                                        {
                                            xtype: 'gridcolumn',
                                            width: 500,
                                            dataIndex: 'Name',
                                            text: 'अनुसूचीहरू / कारणहरू'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            renderer: function(value, metaData, record, rowIndex, colIndex, store, view) {
                                                if(rowIndex == 6)
                                                {

                                                    return '<span style="text-decoration:underline;color:blue;cursor:pointer">Enter Reasons</span>';
                                                }
                                                else
                                                {
                                                    return '<span style="text-decoration:underline;color:blue;cursor:pointer">Enter Annex</span>';
                                                }
                                            },
                                            hidden: true,
                                            itemId: 'actionAnxsReasons',
                                            dataIndex: 'ID',
                                            text: ''
                                        }
                                    ],
                                    selModel: Ext.create('Ext.selection.CheckboxModel', {

                                    })
                                }
                            ]
                        },
                        {
                            xtype: 'panel',
                            frame: true,
                            height: 128,
                            margin: '0 0 5 0',
                            layout: {
                                columns: 2,
                                type: 'table'
                            },
                            bodyPadding: 10,
                            title: '२.  संशोधित कर निर्धारण आदेश ( प्रशासकीय पुनरावलोकन / पुनरावेदनमा भएको निर्णयको लागी मात्र)',
                            items: [
                                {
                                    xtype: 'checkboxgroup',
                                    colspan: 2,
                                    itemId: 'chkDecisionTypePaa',
                                    width: 600,
                                    fieldLabel: 'निर्णयको किसिम',
                                    items: [
                                        {
                                            xtype: 'checkboxfield',
                                            itemId: 'chkReAppealPaa',
                                            style: 'cursor:pointer',
                                            width: 400,
                                            labelWidth: 150,
                                            value: 'AR',
                                            boxLabel: 'प्रशासकीय पुनरावालोकनमा भएको निर्णय',
                                            listeners: {
                                                change: {
                                                    fn: me.onChkReAppealPaaChange,
                                                    scope: me
                                                }
                                            }
                                        },
                                        {
                                            xtype: 'checkboxfield',
                                            itemId: 'chkAppealPaa',
                                            style: 'cursor:pointer',
                                            value: 'AD',
                                            boxLabel: 'पुनरावेदनम भएको निर्णय'
                                        }
                                    ]
                                },
                                {
                                    xtype: 'textfield',
                                    disabled: true,
                                    itemId: 'txtRegNoPaa',
                                    fieldLabel: 'दर्ता / आदेश नं.'
                                },
                                {
                                    xtype: 'textfield',
                                    disabled: true,
                                    itemId: 'txtRegDatePaa',
                                    fieldLabel: 'दर्ता / आदेश मिति',
                                    emptyText: 'YYYY.MM.DD',
                                    enforceMaxLength: true,
                                    maskRe: /[0-9.]/,
                                    maxLength: 10,
                                    listeners: {
                                        blur: {
                                            fn: me.onTxtRegDatePaaBlur,
                                            scope: me
                                        }
                                    }
                                },
                                {
                                    xtype: 'textfield',
                                    disabled: true,
                                    itemId: 'txtDecisionNoPaa',
                                    fieldLabel: 'निर्णय दर्ता नम्बर'
                                },
                                {
                                    xtype: 'textfield',
                                    disabled: true,
                                    itemId: 'txtDecisionDatePaa',
                                    fieldLabel: 'निर्णय दर्ता मिति',
                                    emptyText: 'YYYY.MM.DD',
                                    enforceMaxLength: true,
                                    maskRe: /[0-9.]/,
                                    maxLength: 10,
                                    listeners: {
                                        blur: {
                                            fn: me.onTxtDecisionDatePaaBlur,
                                            scope: me
                                        }
                                    }
                                }
                            ]
                        },
                        {
                            xtype: 'panel',
                            frame: true,
                            bodyPadding: 10,
                            title: '३.  संशोधित करको गणना',
                            items: [
                                {
                                    xtype: 'container',
                                    layout: {
                                        columns: 2,
                                        type: 'table'
                                    },
                                    items: [
                                        {
                                            xtype: 'textfield',
                                            itemId: 'txtDateUptoPaa',
                                            width: 310,
                                            fieldLabel: 'क) शुल्क वा ब्याज गणना गरेको मिति',
                                            labelWidth: 210,
                                            emptyText: 'YYYY.MM.DDD',
                                            enforceMaxLength: true,
                                            maskRe: /[0-9.]/,
                                            maxLength: 10,
                                            listeners: {
                                                blur: {
                                                    fn: me.onTxtInterestPaaBlur,
                                                    scope: me
                                                }
                                            }
                                        },
                                        {
                                            xtype: 'displayfield',
                                            margin: '-10 0 0 5',
                                            fieldLabel: 'सम्म',
                                            labelSeparator: ' '
                                        }
                                    ]
                                },
                                {
                                    xtype: 'textfield',
                                    itemId: 'txtTotalAssessedTaxablePaa',
                                    margin: '5 0',
                                    fieldLabel: 'ख) संशोधन गरिएको आयवर्षको जम्मा कर योग्य आय',
                                    labelSeparator: ' ',
                                    labelWidth: 300,
                                    fieldCls: 'TxtRight',
                                    maskRe: /[0-9]/,
                                    maxLength: 10
                                },
                                {
                                    xtype: 'gridpanel',
                                    height: 527,
                                    itemId: 'grdTotAssTaxablePaa',
                                    margin: '5 0',
                                    title: '१. संशोधित करको गणना',
                                    hideHeaders: true,
                                    scroll: 'none',
                                    store: 'Charge',
                                    viewConfig: {
                                        width: 1000
                                    },
                                    columns: [
                                        {
                                            xtype: 'gridcolumn',
                                            margin: '0 0 0 10',
                                            maxWidth: 700,
                                            width: 700,
                                            defaultWidth: 700,
                                            dataIndex: 'Description',
                                            text: 'Charge'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            maxWidth: 300,
                                            width: 300,
                                            defaultWidth: 300,
                                            dataIndex: 'Amount',
                                            text: 'Value'
                                        }
                                    ]
                                },
                                {
                                    xtype: 'gridpanel',
                                    height: 127,
                                    itemId: 'grdSpecialChargePaa',
                                    margin: '5 0',
                                    autoScroll: true,
                                    title: '२. विशेष शुल्कको गणना',
                                    hideHeaders: true,
                                    scroll: 'none',
                                    viewConfig: {
                                        width: 1000
                                    },
                                    columns: [
                                        {
                                            xtype: 'gridcolumn',
                                            margin: '0 0 0 10',
                                            maxWidth: 700,
                                            width: 700,
                                            defaultWidth: 700,
                                            dataIndex: 'Description',
                                            text: 'Charge'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            maxWidth: 300,
                                            width: 300,
                                            defaultWidth: 300,
                                            dataIndex: 'Value',
                                            text: 'Value'
                                        }
                                    ]
                                },
                                {
                                    xtype: 'displayfield',
                                    margin: '5 0',
                                    fieldLabel: 'ग) कर योग्य आय गणना गर्दा थप समावेश गर्नु पर्ने रकमहरू र खर्च कट्टी गर्न नदिईएको कारणहरू',
                                    labelSeparator: ' ',
                                    labelWidth: 500
                                },
                                {
                                    xtype: 'container',
                                    items: [
                                        {
                                            xtype: 'toolbar',
                                            items: [
                                                {
                                                    xtype: 'button',
                                                    itemId: 'btnAddReasonPaa',
                                                    iconCls: 'icon-add',
                                                    text: 'Add'
                                                }
                                            ]
                                        },
                                        {
                                            xtype: 'gridpanel',
                                            height: 150,
                                            itemId: 'grdReasonsPaa',
                                            margin: '0 0 5 0',
                                            autoScroll: true,
                                            title: '',
                                            scroll: 'vertical',
                                            store: 'ReasonsPaa',
                                            viewConfig: {
                                                width: 1000
                                            },
                                            columns: [
                                                {
                                                    xtype: 'rownumberer'
                                                },
                                                {
                                                    xtype: 'gridcolumn',
                                                    width: 680,
                                                    defaultWidth: 680,
                                                    dataIndex: 'Basis',
                                                    text: 'विवरण र कारण',
                                                    editor: {
                                                        xtype: 'textfield',
                                                        itemId: 'txtReasonPaa',
                                                        width: 500
                                                    }
                                                },
                                                {
                                                    xtype: 'gridcolumn',
                                                    defaultWidth: 300,
                                                    align: 'right',
                                                    dataIndex: 'Amount',
                                                    text: 'रकम (रू)',
                                                    editor: {
                                                        xtype: 'textfield',
                                                        itemId: 'txtAmountPaa',
                                                        width: 300,
                                                        fieldCls: 'TxtRight',
                                                        enforceMaxLength: true,
                                                        maskRe: /[0-9]/,
                                                        maxLength: 10
                                                    }
                                                },
                                                {
                                                    xtype: 'actioncolumn',
                                                    items: [
                                                        {
                                                            handler: function(view, rowIndex, colIndex, item, e) {
                                                                var store = Ext.getStore("ReasonsPaa");
                                                                var row = store.getAt(rowIndex).data;

                                                                //var txtTotCredit = Ext.ComponentQuery.query('#txtTotalCreditAnx10')[0];
                                                                //var creditAmt = (row.TotAmount === "")?0:row.CreditAmount;
                                                                //var newTotCredit = 0;

                                                                Ext.Msg.confirm('Confirm Action', 'Do you want to Remove ?', function(btn) {
                                                                    if(btn == 'yes'){

                                                                        //newTotCredit = parseFloat(txtTotCredit.getValue())-parseFloat(creditAmt);        
                                                                        //txtTotCredit.setValue(newTotCredit);

                                                                        if(row.Action === "E")
                                                                        {
                                                                            row.Action = "D";        
                                                                            store.filter(function(item){
                                                                                return item.get("Action")!= 'D';
                                                                            });


                                                                            view.bindStore(store); 
                                                                        }
                                                                        else
                                                                        {
                                                                            store.removeAt(rowIndex);
                                                                        }

                                                                        return true;
                                                                    }
                                                                }, this);
                                                            },
                                                            icon: '../ITS/resources/images/icons/cancel.png',
                                                            iconCls: 'iconMargin'
                                                        }
                                                    ]
                                                }
                                            ],
                                            plugins: [
                                                Ext.create('Ext.grid.plugin.RowEditing', {
                                                    pluginId: 'pluginReasonsPaa'
                                                })
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            xtype: 'container',
                            height: 28,
                            itemId: 'cntButtonsPaa',
                            margin: '5 0 0 5',
                            padding: '0 0 0 435',
                            layout: {
                                align: 'stretch',
                                pack: 'end',
                                type: 'hbox'
                            },
                            items: [
                                {
                                    xtype: 'button',
                                    itemId: 'btnSavePaa',
                                    margin: '',
                                    padding: 5,
                                    iconCls: 'icon-save',
                                    text: 'Save'
                                },
                                {
                                    xtype: 'button',
                                    itemId: 'btnEditPaa',
                                    margin: '0 5 0 5',
                                    padding: 5,
                                    iconCls: 'icon-edit',
                                    text: 'Edit'
                                },
                                {
                                    xtype: 'button',
                                    itemId: 'btnSubmitPaa',
                                    margin: '0 5 0 0',
                                    padding: 5,
                                    iconCls: 'icon-ok',
                                    text: 'Submit'
                                },
                                {
                                    xtype: 'button',
                                    itemId: 'btnCancelPaa',
                                    padding: 5,
                                    iconCls: 'icon-cancel',
                                    text: 'Cancel'
                                }
                            ]
                        }
                    ]
                }
            ]
        });

        me.callParent(arguments);
    },

    onTxtMaDatePaaBlur: function(component, e, eOpts) {
        return validateFutureDate(field.getValue(),"Y",function(){ field.focus();});
    },

    onTxtPanPaaBlur: function(component, e, eOpts) {
        var me = this;

        /*
        if(field.getValue !== "")
        {
        return ValidatePan(field.getValue(),"00",function(){field.focus();});
        }

        return true;

        */
    },

    onChkReAppealPaaChange: function(field, newValue, oldValue, eOpts) {

    },

    onTxtRegDatePaaBlur: function(component, e, eOpts) {
        return validateFutureDate(field.getValue(),"Y",function(){ field.focus();});
    },

    onTxtDecisionDatePaaBlur: function(component, e, eOpts) {
        return validateFutureDate(field.getValue(),"Y",function(){ field.focus();});
    },

    onTxtInterestPaaBlur: function(component, e, eOpts) {
        return validateFutureDate(field.getValue(),"Y",function(){ field.focus();});
    }

});