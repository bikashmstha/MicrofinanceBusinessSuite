/*
 * File: app/controller/VatReport.js
 *
 * This file was generated by Sencha Architect version 2.2.3.
 * http://www.sencha.com/products/architect/
 *
 * This file requires use of the Ext JS 4.1.x library, under independent license.
 * License of Sencha Architect does not include license for Ext JS 4.1.x. For more
 * details see http://www.sencha.com/license or contact license@sencha.com.
 *
 * This file will be auto-generated each and everytime you save your project.
 *
 * Do NOT hand edit this file.
 */

Ext.define('MyApp.controller.VatReport', {
    extend: 'Ext.app.Controller',

    stores: [
        'NepaliMonthStore',
        'OfficeWithChildStore',
        'VatSavedReportStore',
        'VatAmountFigure'
    ],

    onBtn_VatGenerateReportClick: function(button, e, eOpts) {
        var year=null;
        var month=null;
        var date='';

        var isActive=false;
        var interestPenalty=false;

        var me=this;

        var officeName=Ext.ComponentQuery.query('#cmb_VatOfficeName')[0].getValue();

        var officeCode=Ext.get('offCode').dom.innerHTML;

        var Form = Ext.ComponentQuery.query('#frmVatReport')[0].getForm();

        var rptType=Ext.ComponentQuery.query('#hdn_NF_VSR_VRR')[0].getValue();

        var amountFigure=Ext.ComponentQuery.query('#cbo_vatFigure')[0].getValue();

        var skipAmount=Ext.ComponentQuery.query('#cbo_vatSkipAmount')[0].getValue();

        isActive=Ext.ComponentQuery.query('#chkbox_VatSaveReport')[0].getValue();
        interestPenalty=Ext.ComponentQuery.query('#chkbox_VatInterestPenalty')[0].getValue();

        if(!Form.isValid())
        {
            msg("WARNING","Please Enter the required field.");
            return;
        }
        if(rptType==='VAT Statistics Report' || rptType==='Revenue Report' || rptType==='Outstanding Report')
        {
            month=Ext.ComponentQuery.query('#cmb_VatMonth')[0].getValue();
            year=Ext.ComponentQuery.query('#txt_VatYear')[0].getValue();



            var y=2054;
            var m=8;

            if(year<y)
            {
                msg("WARNING","हजुरले हालेको बर्षमा मूल्य अभिबृद्धि कर लागु गरेको थिएन् । ");
                return;
            }
            else if(month!==null)
            {
                if(year==y && month<m)
                {
                    msg("WARNING","हजुरले हालेको महिना २०५४ सालमा मूल्य अभिबृद्धि कर लागु गरेको थिएन् ।");
                    return;
                } 
            }

        }

        if(officeName===null)
        {
            msg("WARNING","Please select any office name.");
        }

        else if(rptType==='Non-Filer Report')
        {
            date=Ext.ComponentQuery.query('#txt_VatDate')[0].getValue();
            if(date==='')
            {
                msg("WARNING","Please Enter the date.");   
                return;
            }
            else
            {

                me.Operation(officeCode,rptType,year,month,date,amountFigure,skipAmount,isActive,interestPenalty);
                me.ClearControls();
            }
        }
        else if(rptType==='VAT Statistics Report')
        {
            if(year==='')
            {
                msg("WARNING","Please Enter the year.");
            }
            else if(month===null)
            {
                msg("WARNING","Please select any month.");

            }
            else
            {
                me.Operation(officeCode,rptType,year,month,date,amountFigure,skipAmount,isActive,interestPenalty);
                me.ClearControls();
            }
        }
        else if(rptType==='Revenue Report')
        {


            if(year==='')
            {
                msg("WARNING","Please Enter the year.");
            }
            else if(amountFigure===null)
            {
                msg("WARNING","Please select any amount in figure.");
                return;
            }
            else
            {
                me.Operation(officeCode,rptType,year,month,date,amountFigure,skipAmount,isActive,interestPenalty);
                me.ClearControls();
            }

        }
        else if(rptType==='Outstanding Report')
        {

            if(year==='')
            {
                msg("WARNING","Please Enter the year.");
            }
            else if(month===null)
            {
                msg("WARNING","Please select any month.");

            }
            else if(skipAmount===null)
            {
                msg("WARNING","Please select any skip amount.");
                return;
            }
            else
            {
                me.Operation(officeCode,rptType,year,month,date,amountFigure,skipAmount,isActive,interestPenalty);
                me.ClearControls();
            }

        }

    },

    onBtn_VatViewReportClick: function(button, e, eOpts) {


        var rid=Ext.ComponentQuery.query('#txt_VatReportID')[0].getValue();

        var rptType=Ext.ComponentQuery.query('#hdn_NF_VSR_VRR')[0].getValue();

        var officeCode=Ext.ComponentQuery.query('#hdnOfficeCode')[0].getValue();

        var officeName=Ext.ComponentQuery.query('#cmb_VatOfficeName')[0].getValue();

        if(rid==="")
        {
            msg("WARNING","Please enter the report id");
            return;
        }


        if(rptType==='Non-Filer Report')
        {
            var Data={
                rid:rid,
                jobName:'GEN_NF',
                Status:''
            };

            Ext.Ajax.request({
                url: '../Handlers/VAT/Reports/NFVSRVRRReportHandler.ashx?method=CheckReportIDStatus',
                params: {

                    data:JSON.stringify(Data)
                },
                success: function(response){
                    var resp=Ext.decode(response.responseText);
                    var vrid=null;
                    var vjobStatus='';

                    if(resp.success==="Yes")
                    {
                        vrid=resp.root.rid;
                        vjobStatus=resp.message;
                        if(vjobStatus==='Y')
                        {
                            var obj={
                                rid:vrid
                            };
                            var url="../Reporting/VPR_NON_FILER/ReportHandlers/VPR_NON_FILERHandler.ashx";
                            var winOption="width=730,height=345,left=100,top=100,resizable=yes,scrollbars=yes";
                            OpenWindowWithPost(url,winOption,"NewFile",obj);



                        }
                        else if(vjobStatus==='F')
                        {
                            msg('INFO','Job Failed.');
                        }
                        else
                        {
                            msg('INFO','Job not complete yet check later');
                        }
                        Ext.ComponentQuery.query('#txt_VatReportID')[0].setValue(rid);
                        Ext.ComponentQuery.query('#lbl_ReportIDMsg')[0].setValue("Remember your report id for viewing report later.");

                    }
                    else
                    {
                        alert("Report is denied");
                    }


                },
                failure:function(result, response){
                    msg('ERROR OCURRED !!!', 'Error');                 
                }

            });
        }
        else if(rptType==='VAT Statistics Report')
        {
            var vsrData={
                rid:rid,
                jobName:'VAT_STAT',
                Status:''
            };

            Ext.Ajax.request({
                url: '../Handlers/VAT/Reports/NFVSRVRRReportHandler.ashx?method=CheckReportIDStatus',
                params: {

                    data:JSON.stringify(vsrData)
                },
                success: function(response){
                    var resp=Ext.decode(response.responseText);
                    var vrid=null;
                    var vjobStatus='';

                    if(resp.success==="Yes")
                    {
                        vrid=resp.root.rid;
                        vjobStatus=resp.message;
                        if(vjobStatus==='Y')
                        {
                            var obj={
                                rid:vrid

                            };
                            var url="../Reporting/VPR_STATISTICS/ReportHandlers/VPR_STATHandler.ashx";
                            var winOption="width=730,height=345,left=100,top=100,resizable=yes,scrollbars=yes";
                            OpenWindowWithPost(url,winOption,"NewFile",obj);



                        }
                        else if(vjobStatus==='F')
                        {
                            msg('INFO','Job Failed.');
                        }
                        else
                        {
                            msg('INFO','Job not complete yet check later');
                        }
                        Ext.ComponentQuery.query('#txt_VatReportID')[0].setValue(rid);
                        Ext.ComponentQuery.query('#lbl_ReportIDMsg')[0].setValue("Remember your report id for viewing report later.");

                    }
                    else
                    {
                        alert("Report is denied");
                    }


                },
                failure:function(result, response){
                    msg('ERROR OCURRED !!!', 'Error');                 
                }

            });

        }
        else if(rptType==='Revenue Report')
        {
            var vrrData={
                rid:rid,
                jobName:'REV_REP',
                Status:''
            };

            Ext.Ajax.request({
                url: '../Handlers/VAT/Reports/NFVSRVRRReportHandler.ashx?method=CheckReportIDStatus',
                params: {

                    data:JSON.stringify(vrrData)
                },
                success: function(response){
                    var resp=Ext.decode(response.responseText);
                    var vrid=null;
                    var vjobStatus='';

                    if(resp.success==="Yes")
                    {
                        vrid=resp.root.rid;
                        vjobStatus=resp.message;
                        if(vjobStatus==='Y')
                        {
                            var obj={
                                rid:vrid

                            };
                            var url="../Reporting/VPR_REVENUE/ReportHandlers/VPR_REVHandler.ashx";
                            var winOption="width=730,height=345,left=100,top=100,resizable=yes,scrollbars=yes";
                            OpenWindowWithPost(url,winOption,"NewFile",obj);



                        }
                        else if(vjobStatus==='F')
                        {
                            msg('INFO','Job Failed.');
                        }
                        else
                        {
                            msg('INFO','Job not complete yet check later');
                        }
                        Ext.ComponentQuery.query('#txt_VatReportID')[0].setValue(rid);
                        Ext.ComponentQuery.query('#lbl_ReportIDMsg')[0].setValue("Remember your report id for viewing report later.");

                    }
                    else
                    {
                        alert("Report is denied");
                    }


                },
                failure:function(result, response){
                    msg('ERROR OCURRED !!!', 'Error');                 
                }

            });
        }
        else if(rptType==='Outstanding Report')
        {
            var vorData={
                rid:rid,
                jobName:'POP_OUT',
                Status:''

            };

            Ext.Ajax.request({
                url: '../Handlers/VAT/Reports/NFVSRVRRReportHandler.ashx?method=CheckReportIDStatus',
                params: {

                    data:JSON.stringify(vorData)
                },
                success: function(response){
                    var resp=Ext.decode(response.responseText);
                    var vrid=null;
                    var vjobStatus='';

                    if(resp.success==="Yes")
                    {
                        vrid=resp.root.rid;
                        vjobStatus=resp.message;
                        if(vjobStatus==='Y')
                        {
                            var obj={
                                rid:vrid,
                                officeCode:officeCode,
                                officeName:officeName

                            };
                            var url="../Reporting/VPR_OUTSTANDING/ReportHandlers/VPR_OUTSTANDHandler.ashx";
                            var winOption="width=730,height=345,left=100,top=100,resizable=yes,scrollbars=yes";
                            OpenWindowWithPost(url,winOption,"NewFile",obj);



                        }
                        else if(vjobStatus==='F')
                        {
                            msg('INFO','Job Failed.');
                        }
                        else
                        {
                            msg('INFO','Job not complete yet check later');
                        }
                        Ext.ComponentQuery.query('#txt_VatReportID')[0].setValue(rid);
                        Ext.ComponentQuery.query('#lbl_ReportIDMsg')[0].setValue("Remember your report id for viewing report later.");

                    }
                    else
                    {
                        alert("Report is denied");
                    }


                },
                failure:function(result, response){
                    msg('ERROR OCURRED !!!', 'Error');                 
                }

            });
        }

    },

    onFrmVatReportAfterRender: function(component, eOpts) {
        var map = Ext.getCmp('CntSiteMapPath');
        var val = map.html;
        var arr = val.split(">>");
        var module = arr[arr.length-2].trim();

        //alert(module);


        var offCode=null;
        offCode=Ext.get('offCode').dom.innerHTML;

        Ext.ComponentQuery.query('#hdnOfficeCode')[0].setValue(offCode);
        //alert(offCode);


        var leaf = arr[arr.length-1].trim();

        Ext.ComponentQuery.query('#hdn_NF_VSR_VRR')[0].setValue(leaf);


        var date=Ext.ComponentQuery.query('#txt_VatDate')[0];
        var month=Ext.ComponentQuery.query('#cmb_VatMonth')[0];
        var year=Ext.ComponentQuery.query('#txt_VatYear')[0];

        var saveReportStat=Ext.ComponentQuery.query('#cbo_VatReportDateStat')[0];

        var saveReportRev=Ext.ComponentQuery.query('#cbo_VatReportDateRev')[0];


        var saveReportOut=Ext.ComponentQuery.query('#cbo_VatReportDateOut')[0];

        var saveReportActive=Ext.ComponentQuery.query('#chkbox_VatSaveReport')[0];
        var amountFigure=Ext.ComponentQuery.query('#cbo_vatFigure')[0];

        var skipAmount=Ext.ComponentQuery.query('#cbo_vatSkipAmount')[0];
        var interestPenalty=Ext.ComponentQuery.query('#chkbox_VatInterestPenalty')[0];

        //var checkVatReport=Ext.ComponentQuery.query('#fieldSet_CheckVatReport')[0];
        var strSavedReport='';

        date.hide();
        month.hide();
        year.hide();

        var me=this;

        var jobName='';
        //alert(leaf);

        Ext.ComponentQuery.query('#lbl_ReportIDMsg')[0].hide();
        Ext.ComponentQuery.query('#lbl_WaitingMsg')[0].hide();

        if(leaf==='Non-Filer Report')
        {
            date.show();
            date.allowBlank=false;
            year.hide();
            month.hide();
            saveReportStat.setVisible(false);
            saveReportRev.setVisible(false);
            saveReportOut.setVisible(false);

            saveReportActive.setVisible(false);
            amountFigure.setVisible(false);
            skipAmount.setVisible(false);
            interestPenalty.setVisible(false);


            jobName='GEN_NF';

            me.GetLatestJobStatus(jobName);

            //checkVatReport.setVisible(true);
        }
        else if(leaf==='VAT Statistics Report')
        {
            year.show();
            year.allowBlank=false;
            month.show();
            month.allowBlank=false;
            date.hide();
            saveReportStat.setVisible(true);
            saveReportRev.setVisible(false);
            saveReportOut.setVisible(false);

            saveReportActive.setVisible(true);
            amountFigure.setVisible(false);

            skipAmount.setVisible(false);
            interestPenalty.setVisible(false);

            strSavedReport=Ext.getStore('VatSavedReportStore');

            strSavedReport.removeAll();
            //  checkVatReport.setVisible(false);


            jobName='VAT_STAT';

            me.GetLatestJobStatus(jobName);


            Ext.Ajax.request({
                url: '../Handlers/VAT/Reports/NFVSRVRRReportHandler.ashx?method=GetStatisticsData',

                success: function(response){

                    var resp=Ext.decode(response.responseText);

                    //console.log(resp.root);
                    var data=resp.root;



                    //console.log(strSavedReport);



                    strSavedReport.add(data);


                },
                failure:function(result, request){
                    msg('ERROR OCURRED !!!', 'Error');                 
                }

            });


        }
        else if(leaf==='Revenue Report')
        {

            year.show();
            year.allowBlank=false;
            month.hide();
            date.hide();

            saveReportStat.setVisible(false);
            saveReportRev.setVisible(true);
            saveReportOut.setVisible(false);

            saveReportActive.setVisible(true);
            amountFigure.setVisible(true);

            skipAmount.setVisible(false);
            interestPenalty.setVisible(false);
            //  checkVatReport.setVisible(false);

            strSavedReport=Ext.getStore('VatSavedReportStore');

            strSavedReport.removeAll();

            jobName='REV_REP';

            me.GetLatestJobStatus(jobName);



            Ext.Ajax.request({
                url: '../Handlers/VAT/Reports/NFVSRVRRReportHandler.ashx?method=GetRevenueData',

                success: function(response){

                    var resp=Ext.decode(response.responseText);

                    //console.log(resp.root);
                    var data=resp.root;



                    //console.log(strSavedReport);



                    strSavedReport.add(data);


                },
                failure:function(result, request){
                    msg('ERROR OCURRED !!!', 'Error');                 
                }

            });
        }
        else if(leaf==='Outstanding Report')
        {
            year.show();
            year.allowBlank=false;
            month.show();
            date.hide();

            saveReportStat.setVisible(false);
            saveReportRev.setVisible(false);
            saveReportOut.setVisible(true);

            saveReportActive.setVisible(true);
            amountFigure.setVisible(false);

            skipAmount.setVisible(true);
            interestPenalty.setVisible(true);
            //  checkVatReport.setVisible(false);

            strSavedReport=Ext.getStore('VatSavedReportStore');

            strSavedReport.removeAll();

            jobName='POP_OUT';

            me.GetLatestJobStatus(jobName);


            Ext.Ajax.request({
                url: '../Handlers/VAT/Reports/NFVSRVRRReportHandler.ashx?method=GetOutstandingData',

                success: function(response){

                    var resp=Ext.decode(response.responseText);

                    //console.log(resp.root);
                    var data=resp.root;



                    //console.log(strSavedReport);



                    strSavedReport.add(data);


                },
                failure:function(result, request){
                    msg('ERROR OCURRED !!!', 'Error');                 
                }

            });
        }


        var strOfficeWithChild=Ext.getStore('OfficeWithChildStore');
        strOfficeWithChild.removeAll();

        Ext.Ajax.request({
            url: '../Handlers/Common/OfficeHandler.ashx?method=GetOfficeByParentWithType',
            params: {

                parentID:offCode
            },
            success: function(response){

                var resp=Ext.decode(response.responseText);

                // console.log(resp.root.Address);

                strOfficeWithChild.add(resp.root);

                //alert(resp.message);
            },
            failure:function(result, request){
                msg('ERROR OCURRED !!!', 'Error');                 
            }

        });



    },

    onBtn_VatCancelClick: function(button, e, eOpts) {
        var me=this;

        me.ClearControls();


    },

    Operation: function(officeCode,rptType,year,month,date,amountFigure,skipAmount,isActive,interestPenalty) {
        var vPostFlag='';
        var vInterestPenalty='';

        if(isActive===true)
        {
            vPostFlag='Y';
        }
        if(interestPenalty===true)
        {
            vInterestPenalty='Y';
        }
        var data={

            officeCode:officeCode,
            year:year,
            Month:month,
            Date:date,
            rptType:rptType

        };
        Ext.Ajax.request({
            url: '../Handlers/VAT/Reports/NFVSRVRRReportHandler.ashx?method=GetRPTData',
            params: {

                data:JSON.stringify(data)
            },
            success: function(response){

                var resp=Ext.decode(response.responseText);

                if(resp.root.message==='Yes')
                {
                    Ext.Msg.confirm('Confirm Action', 'There is Data in table.Do you want to run Report from there or Populate new one.?', function(btn) {
                        if(btn == 'yes'){

                        }
                        else 
                        {
                            return;
                        }
                    });

                }
                else if(rptType==='Non-Filer Report')
                {
                    // alert('There is no data found.');
                    var NFData={
                        officeCode:officeCode,
                        Date:date,
                        rid:null
                    };

                    Ext.Ajax.request({
                        url: '../Handlers/VAT/Reports/NFVSRVRRReportHandler.ashx?method=SaveNFData',
                        params: {

                            NFData:JSON.stringify(NFData)
                        },
                        success: function(response){
                            var resp=Ext.decode(response.responseText);
                            var rid=null;
                            var vCheckServer='';
                            // var officeAddress=Ext.ComponentQuery.query('#hdn_OfficeAddress')[0].getValue();
                            if(resp.success==="Yes")
                            {

                                vCheckServer=resp.message;
                                if(vCheckServer==='F')
                                {
                                    msg('INFO','Server busy.Please try later.');
                                }
                                else
                                {
                                    rid=resp.message;
                                    Ext.ComponentQuery.query('#txt_VatReportID')[0].setValue(rid);
                                    Ext.ComponentQuery.query('#lbl_ReportIDMsg')[0].show();
                                    Ext.ComponentQuery.query('#lbl_WaitingMsg')[0].show();

                                }



                            }
                            else
                            {
                                alert("Report is denied");
                            }


                        },
                        failure:function(result, response){
                            msg('ERROR OCURRED !!!', 'Error');                 
                        }

                    });
                }
                else if(rptType==='VAT Statistics Report')
                {

                    var VSRData={
                        year:year,
                        month:month,
                        postFlag:vPostFlag, 
                        rid:null
                    };
                    Ext.Ajax.request({
                        url: '../Handlers/VAT/Reports/NFVSRVRRReportHandler.ashx?method=SaveVSRData',
                        params: {

                            VSRData:JSON.stringify(VSRData)
                        },
                        success: function(response){
                            var resp=Ext.decode(response.responseText);
                            var rid=null;
                            var vCheckServer='';
                            //         var officeAddress=Ext.ComponentQuery.query('#hdn_OfficeAddress')[0].getValue();
                            if(resp.success==="Yes")
                            {

                                vCheckServer=resp.message;
                                if(vCheckServer==='F')
                                {
                                    msg('INFO','Server busy.Please try later.');
                                }
                                else
                                {
                                    rid=resp.message;
                                    Ext.ComponentQuery.query('#txt_VatReportID')[0].setValue(rid);
                                    Ext.ComponentQuery.query('#lbl_ReportIDMsg')[0].show();
                                    Ext.ComponentQuery.query('#lbl_WaitingMsg')[0].show();

                                }



                            }
                            else
                            {
                                alert("Report is denied");
                            }


                        },
                        failure:function(result, response){
                            msg('ERROR OCURRED !!!', 'Error');                 
                        }

                    });


                }
                else if(rptType==='Revenue Report')
                {
                    var VRRData={
                        year:year,
                        rid:null,
                        amountFigure:amountFigure,
                        postFlag:vPostFlag
                    };
                    Ext.Ajax.request({
                        url: '../Handlers/VAT/Reports/NFVSRVRRReportHandler.ashx?method=SaveVRRData',
                        params: {

                            VRRData:JSON.stringify(VRRData)
                        },
                        success: function(response){
                            var resp=Ext.decode(response.responseText);
                            var rid=null;
                            var vCheckServer='';
                            //var officeAddress=Ext.ComponentQuery.query('#hdn_OfficeAddress')[0].getValue();
                            if(resp.success==="Yes")
                            {

                                vCheckServer=resp.message;
                                if(vCheckServer==='F')
                                {
                                    msg('INFO','Server busy.Please try later.');
                                }
                                else
                                {
                                    rid=resp.message;
                                    Ext.ComponentQuery.query('#txt_VatReportID')[0].setValue(rid);
                                    Ext.ComponentQuery.query('#lbl_ReportIDMsg')[0].show();
                                    Ext.ComponentQuery.query('#lbl_WaitingMsg')[0].show();

                                }



                            }
                            else
                            {
                                alert("Report is denied");
                            }


                        },
                        failure:function(result, response){
                            msg('ERROR OCURRED !!!', 'Error');                 
                        }

                    });

                }
                else if(rptType==='Outstanding Report')
                {
                    var VORData={
                        year:year,
                        Month:month,
                        officeCode:officeCode,
                        skipAmount:skipAmount,
                        rid:null,
                        postFlag:vPostFlag,
                        amountInterestPenalty:vInterestPenalty
                    };
                    Ext.Ajax.request({
                        url: '../Handlers/VAT/Reports/NFVSRVRRReportHandler.ashx?method=SaveVORData',
                        params: {

                            VORData:JSON.stringify(VORData)
                        },
                        success: function(response){
                            var resp=Ext.decode(response.responseText);
                            var rid=null;
                            var vCheckServer='';
                            //var officeAddress=Ext.ComponentQuery.query('#hdn_OfficeAddress')[0].getValue();
                            if(resp.success==="Yes")
                            {

                                vCheckServer=resp.message;
                                if(vCheckServer==='F')
                                {
                                    msg('INFO','Server busy.Please try later.');
                                }
                                else
                                {
                                    rid=resp.message;
                                    Ext.ComponentQuery.query('#txt_VatReportID')[0].setValue(rid);
                                    Ext.ComponentQuery.query('#lbl_ReportIDMsg')[0].show();
                                    Ext.ComponentQuery.query('#lbl_WaitingMsg')[0].show();

                                }



                            }
                            else
                            {
                                alert("Report is denied");
                            }


                        },
                        failure:function(result, response){
                            msg('ERROR OCURRED !!!', 'Error');                 
                        }

                    });

                }
            },
            failure:function(result, response){
                msg('ERROR OCURRED !!!', 'Error');                 
            }

        });

    },

    GetLatestJobStatus: function(jobName) {
        Ext.Ajax.request({
            url:'../Handlers/Common/JobStatusHandler.ashx?method=GetLatestJobStatus',
            params:{jobName:jobName},
            success:function(result, request)
            {
                var resp = Ext.decode(result.responseText);    
                var data=resp.root;

                Ext.ComponentQuery.query('#txt_VatReportID')[0].setValue(data.RID);

                Ext.ComponentQuery.query('#hdn_ReportID')[0].setValue(data.RID);

            },

            failure:function(result, request){


                var errMsg = "Error in ";

                msg("FAILURE",errMsg);
                return;                 
            }

        });

    },

    ClearControls: function() {
        Ext.ComponentQuery.query('#cmb_VatOfficeName')[0].reset();
        Ext.ComponentQuery.query('#txt_VatDate')[0].reset();
        Ext.ComponentQuery.query('#txt_VatYear')[0].reset();
        Ext.ComponentQuery.query('#cmb_VatMonth')[0].reset();
        Ext.ComponentQuery.query('#cbo_vatFigure')[0].reset();
        Ext.ComponentQuery.query('#cbo_vatSkipAmount')[0].reset();
        Ext.ComponentQuery.query('#chkbox_VatSaveReport')[0].reset();
        Ext.ComponentQuery.query('#chkbox_VatInterestPenalty')[0].reset();
        Ext.ComponentQuery.query('#cbo_VatReportDateStat')[0].reset();
        Ext.ComponentQuery.query('#cbo_VatReportDateRev')[0].reset();
        Ext.ComponentQuery.query('#cbo_VatReportDateOut')[0].reset();

    },

    init: function(application) {
        this.control({
            "#btn_VatGenerateReport": {
                click: this.onBtn_VatGenerateReportClick
            },
            "#btn_VatViewReport": {
                click: this.onBtn_VatViewReportClick
            },
            "#frmVatReport": {
                afterrender: this.onFrmVatReportAfterRender
            },
            "#btn_VatCancel": {
                click: this.onBtn_VatCancelClick
            }
        });
    }

});
