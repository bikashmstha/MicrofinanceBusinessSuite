/*
 * File: app/view/ExciseRegistrationAU.js
 *
 * This file was generated by Sencha Architect version 2.2.3.
 * http://www.sencha.com/products/architect/
 *
 * This file requires use of the Ext JS 4.1.x library, under independent license.
 * License of Sencha Architect does not include license for Ext JS 4.1.x. For more
 * details see http://www.sencha.com/license or contact license@sencha.com.
 *
 * This file will be auto-generated each and everytime you save your project.
 *
 * Do NOT hand edit this file.
 */

Ext.define('MyApp.view.ExciseRegistrationAU', {
    extend: 'Ext.panel.Panel',

    frame: true,
    id: 'ExciseRegistrationAU',
    itemId: 'ExciseRegistrationAU',
    autoScroll: true,
    autoDestroy: false,
    layout: {
        type: 'fit'
    },
    bodyPadding: 5,
    manageHeight: false,
    title: 'EXCISE Registration',

    initComponent: function() {
        var me = this;

        Ext.applyIf(me, {
            items: [
                {
                    xtype: 'tabpanel',
                    itemId: 'ExciseRegistrationAUSteps',
                    activeTab: 0,
                    items: [
                        {
                            xtype: 'panel',
                            frame: true,
                            height: 660,
                            itemId: 'ExciseRegistrationAUStep1',
                            maxHeight: 660,
                            autoScroll: true,
                            bodyPadding: 5,
                            bodyStyle: 'text-align:center;',
                            title: 'Step 1',
                            items: [
                                {
                                    xtype: 'fieldset',
                                    height: 270,
                                    maxHeight: 270,
                                    style: 'vertical-align:top;',
                                    autoScroll: true,
                                    layout: {
                                        columns: 5,
                                        type: 'table'
                                    },
                                    title: 'Add New Permit',
                                    items: [
                                        {
                                            xtype: 'container',
                                            colspan: 3,
                                            height: 220,
                                            width: 525,
                                            autoScroll: true,
                                            items: [
                                                {
                                                    xtype: 'combobox',
                                                    itemId: 'Excise_Reg_AddPerm_PermType',
                                                    width: 500,
                                                    fieldLabel: 'Permit ',
                                                    emptyText: '-- Choose --',
                                                    displayField: 'ItemNameEnglish',
                                                    queryMode: 'local',
                                                    store: 'Excise_Reg_AddPerm_PerTypStore',
                                                    valueField: 'ItemCode'
                                                },
                                                {
                                                    xtype: 'checkboxgroup',
                                                    itemId: 'Excise_Reg_AddPerm_PermFor',
                                                    minHeight: 50,
                                                    renderData: [
                                                        'asdasd',
                                                        'qweqwe',
                                                        'cvcvb'
                                                    ],
                                                    width: 400,
                                                    autoScroll: true,
                                                    fieldLabel: 'Permit For ',
                                                    columns: 1,
                                                    vertical: true
                                                },
                                                {
                                                    xtype: 'textfield',
                                                    itemId: 'Excise_Reg_AddPerm_FromDate',
                                                    fieldLabel: 'From Date ',
                                                    emptyText: 'yyyy.mm.dd',
                                                    listeners: {
                                                        blur: {
                                                            fn: me.onExcise_Reg_AddPerm_FromDateBlur,
                                                            scope: me
                                                        }
                                                    }
                                                },
                                                {
                                                    xtype: 'textfield',
                                                    itemId: 'Excise_Reg_AddPerm_ToDate',
                                                    fieldLabel: 'To Date ',
                                                    emptyText: 'yyyy.mm.dd',
                                                    listeners: {
                                                        blur: {
                                                            fn: me.onExcise_Reg_AddPerm_ToDateBlur,
                                                            scope: me
                                                        }
                                                    }
                                                },
                                                {
                                                    xtype: 'numberfield',
                                                    itemId: 'Excise_Reg_AddPerm_PenaltyAmt',
                                                    fieldLabel: 'Penalty Amount (If Applicable) ',
                                                    enforceMaxLength: true,
                                                    maxLength: 22,
                                                    hideTrigger: true
                                                },
                                                {
                                                    xtype: 'container',
                                                    height: 30,
                                                    margin: '5 0',
                                                    padding: '',
                                                    items: [
                                                        {
                                                            xtype: 'button',
                                                            itemId: 'Excise_Reg_AddPerm_btnAdd',
                                                            margin: '0 0 20 85',
                                                            iconCls: 'btn-add',
                                                            text: 'Add'
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            xtype: 'container',
                                            colspan: 2,
                                            margin: '-110 0 0 0',
                                            items: [
                                                {
                                                    xtype: 'textfield',
                                                    hidden: true,
                                                    itemId: 'Excise_Reg_AddPerm_Asset',
                                                    fieldLabel: 'Asset ',
                                                    labelWidth: 180,
                                                    listeners: {
                                                        blur: {
                                                            fn: me.onExcise_Reg_AddPerm_AssetBlur,
                                                            scope: me
                                                        }
                                                    }
                                                },
                                                {
                                                    xtype: 'displayfield',
                                                    itemId: 'Excise_Reg_AddPerm_PermRate',
                                                    fieldLabel: 'Permit Rate ',
                                                    labelWidth: 180
                                                },
                                                {
                                                    xtype: 'displayfield',
                                                    itemId: 'Excise_Reg_AddPerm_PhyControl',
                                                    fieldLabel: 'Physical Control Required ',
                                                    labelWidth: 180
                                                },
                                                {
                                                    xtype: 'displayfield',
                                                    itemId: 'Excise_Reg_AddPerm_LicReq',
                                                    fieldLabel: 'Licence Required ',
                                                    labelWidth: 180
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    xtype: 'gridpanel',
                                    itemId: 'Excise_Reg_AddPerm_Grd_Permits',
                                    title: 'List Of Permits',
                                    columnLines: true,
                                    emptyText: 'No Records',
                                    store: 'Excise_Reg_AddPerm_PerListStore',
                                    columns: [
                                        {
                                            xtype: 'gridcolumn',
                                            dataIndex: 'PanNo',
                                            text: 'PanNo'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            dataIndex: 'SubmissionNo',
                                            text: 'SubmissionNo'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            dataIndex: 'ItemCode',
                                            text: 'ItemCode'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            dataIndex: 'FromDate',
                                            text: 'FromDate'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            dataIndex: 'PermitFrom',
                                            text: 'PermitFrom'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            dataIndex: 'PermitTo',
                                            text: 'PermitTo'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            dataIndex: 'PermitStatus',
                                            text: 'PermitStatus'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            dataIndex: 'ExciseRate',
                                            text: 'ExciseRate'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            dataIndex: 'PermitNo',
                                            text: 'PermitNo'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            dataIndex: 'RegistrationFor',
                                            text: 'RegistrationFor'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            dataIndex: 'FinAmount',
                                            text: 'FinAmount'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            dataIndex: 'UnderPhyCtrl',
                                            text: 'UnderPhyCtrl'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            dataIndex: 'ProdRepRequired',
                                            text: 'ProdRepRequired'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            dataIndex: 'ApprovedBy',
                                            text: 'ApprovedBy'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            dataIndex: 'ApprovedDate',
                                            text: 'ApprovedDate'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            dataIndex: 'PenaltyAmount',
                                            text: 'PenaltyAmount'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            dataIndex: 'Action',
                                            text: 'Action'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            dataIndex: 'ActivityList',
                                            text: 'ActivityList'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            dataIndex: 'ItemNameEnglish',
                                            text: 'ItemNameEnglish'
                                        },
                                        {
                                            xtype: 'actioncolumn',
                                            hidden: true,
                                            width: 80,
                                            defaultWidth: 50,
                                            flex: 1,
                                            icon: '',
                                            items: [
                                                {
                                                    handler: function(view, rowIndex, colIndex, item, e, record, row) {
                                                        var grd=Ext.ComponentQuery.query('#Excise_Reg_AddPerm_Grd_Permits')[0];

                                                        grd.getSelectionModel().select(rowIndex);

                                                        var  permListStore=grd.getStore();

                                                        var perm=permListStore.getAt(rowIndex).data;
                                                        console.log(perm);
                                                        var actList=perm.RegPermitActivities;

                                                        var combobox=Ext.ComponentQuery.query('#Excise_Reg_AddPerm_PermType')[0];
                                                        combobox.setValue(perm.ItemCode);
                                                        combobox.disable();
                                                        Ext.ComponentQuery.query('#Excise_Reg_AddPerm_FromDate')[0].setValue(perm.PermitFrom);
                                                        Ext.ComponentQuery.query('#Excise_Reg_AddPerm_ToDate')[0].setValue(perm.PermitTo);
                                                        Ext.ComponentQuery.query('#Excise_Reg_AddPerm_PenaltyAmt')[0].setValue(perm.PenaltyAmount);
                                                        Ext.ComponentQuery.query('#Excise_Reg_AddPerm_Asset')[0].setValue(perm.FinAmount);
                                                        Ext.ComponentQuery.query('#Excise_Reg_AddPerm_PermRate')[0].setValue(perm.ExciseRate);
                                                        var ctrlFor=Ext.ComponentQuery.query('#Excise_Reg_AddPerm_PermFor')[0];


                                                        ctrlFor.items.each(function(item) {  
                                                            item.setValue(false);
                                                        });



                                                        ctrlFor.items.each(function(item) { 

                                                            for(var v=0;v<actList.length;v++)
                                                            {        
                                                                if(item.id==actList[v].ActivityID)
                                                                {
                                                                    item.setValue(true);
                                                                }  
                                                            }



                                                        });
                                                    },
                                                    altText: 'Edit Permit',
                                                    icon: '../ITS/resources/images/icons/pencil.png',
                                                    tooltip: 'Edit'
                                                }
                                            ]
                                        },
                                        {
                                            xtype: 'actioncolumn',
                                            width: 80,
                                            defaultWidth: 50,
                                            flex: 1,
                                            icon: '',
                                            iconCls: '',
                                            items: [
                                                {
                                                    handler: function(view, rowIndex, colIndex, item, e, record, row) {
                                                        Ext.Msg.confirm('Confirm Action', 'Do you want to Remove ?', function(btn) {
                                                            if(btn == 'yes'){



                                                                var grd =  Ext.ComponentQuery.query('#Excise_Reg_AddPerm_Grd_Permits')[0];
                                                                var store = grd.getStore();
                                                                var row = store.getAt(rowIndex).data;

                                                                if(row.Action != "A")
                                                                {    
                                                                    row.Action = "D";
                                                                    grd.bindStore(store); 

                                                                    store.filter(function(item){
                                                                        return item.get("Action")!= 'D';
                                                                    });
                                                                }
                                                                else
                                                                {    store.removeAt(rowIndex);            
                                                                }

                                                                return true;
                                                            }
                                                        }, this);
                                                    },
                                                    icon: '../ITS/resources/images/icons/cancel.png',
                                                    iconCls: '',
                                                    tooltip: 'Delete Permit'
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    xtype: 'container',
                                    height: 30,
                                    margin: '5 0',
                                    items: [
                                        {
                                            xtype: 'button',
                                            itemId: 'Excise_Reg_AddPerm_btnBack',
                                            margin: '0 5 0 105',
                                            iconCls: 'btn-add',
                                            text: 'Back'
                                        },
                                        {
                                            xtype: 'button',
                                            itemId: 'Excise_Reg_AddPerm_btnSave',
                                            iconCls: 'icon-save',
                                            text: 'Save'
                                        },
                                        {
                                            xtype: 'button',
                                            itemId: 'Excise_Reg_AddPerm_btnCancel',
                                            margin: '0 0 0 5',
                                            iconCls: 'icon-cancel',
                                            text: 'Cancel'
                                        },
                                        {
                                            xtype: 'button',
                                            itemId: 'Excise_Reg_AddPerm_btnNext',
                                            margin: '0 0 0 5',
                                            iconCls: 'btn-add',
                                            text: 'Next'
                                        }
                                    ]
                                },
                                {
                                    xtype: 'container',
                                    height: 25,
                                    margin: '10 0',
                                    style: 'text-align:right;',
                                    items: [
                                        {
                                            xtype: 'button',
                                            hidden: true,
                                            iconCls: 'icon-ok',
                                            text: 'Submit'
                                        },
                                        {
                                            xtype: 'button',
                                            hidden: true,
                                            iconCls: 'icon-cancel',
                                            text: 'Cancel'
                                        },
                                        {
                                            xtype: 'button',
                                            hidden: true,
                                            itemId: 'Excise_Reg_Next',
                                            iconCls: 'icon-cancel',
                                            text: 'Next'
                                        },
                                        {
                                            xtype: 'hiddenfield',
                                            itemId: 'Excise_Reg_RedirectURL',
                                            fieldLabel: 'Label'
                                        },
                                        {
                                            xtype: 'hiddenfield',
                                            itemId: 'VAT_Reg_PanAction',
                                            fieldLabel: 'Label'
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            xtype: 'panel',
                            frame: true,
                            itemId: 'ExciseRegistrationAUStep2',
                            layout: {
                                align: 'stretch',
                                type: 'vbox'
                            },
                            bodyPadding: 5,
                            title: 'Step 2',
                            items: [
                                {
                                    xtype: 'fieldset',
                                    minHeight: 230,
                                    style: 'vertical-align: top;',
                                    layout: {
                                        align: 'stretch',
                                        padding: '2 0 0 0',
                                        type: 'hbox'
                                    },
                                    title: 'Add Goods',
                                    items: [
                                        {
                                            xtype: 'container',
                                            flex: 1,
                                            items: [
                                                {
                                                    xtype: 'combobox',
                                                    itemId: 'Excise_Reg_AddGoods_cboPerm',
                                                    width: 500,
                                                    fieldLabel: 'Permit',
                                                    emptyText: '-- Choose --',
                                                    displayField: 'ItemNameEnglish',
                                                    queryMode: 'local',
                                                    store: 'Excise_Reg_AddGoods_PerListStore',
                                                    valueField: 'ItemCode'
                                                },
                                                {
                                                    xtype: 'gridpanel',
                                                    itemId: 'Excise_Reg_AddGoods_grdGoods',
                                                    title: 'My Grid Panel',
                                                    store: 'Excise_Reg_AddGoods_GoodsStore',
                                                    selModel: Ext.create('Ext.selection.CheckboxModel', {

                                                    }),
                                                    columns: [
                                                        {
                                                            xtype: 'gridcolumn',
                                                            dataIndex: 'ItemCode',
                                                            text: 'ItemCode'
                                                        },
                                                        {
                                                            xtype: 'gridcolumn',
                                                            dataIndex: 'ItemNameEnglish',
                                                            text: 'ItemNameEnglish'
                                                        },
                                                        {
                                                            xtype: 'gridcolumn',
                                                            dataIndex: 'ItemNameNepali',
                                                            text: 'ItemNameNepali'
                                                        },
                                                        {
                                                            xtype: 'gridcolumn',
                                                            dataIndex: 'Spec',
                                                            text: 'Spec'
                                                        },
                                                        {
                                                            xtype: 'gridcolumn',
                                                            dataIndex: 'BaseUnit',
                                                            text: 'BaseUnit'
                                                        },
                                                        {
                                                            xtype: 'gridcolumn',
                                                            dataIndex: 'Unit',
                                                            text: 'Unit'
                                                        },
                                                        {
                                                            xtype: 'gridcolumn',
                                                            dataIndex: 'RateOrPer',
                                                            text: 'RateOrPer'
                                                        },
                                                        {
                                                            xtype: 'gridcolumn',
                                                            dataIndex: 'Amount',
                                                            text: 'Amount'
                                                        },
                                                        {
                                                            xtype: 'gridcolumn',
                                                            dataIndex: 'Action',
                                                            text: 'Action'
                                                        }
                                                    ]
                                                },
                                                {
                                                    xtype: 'container',
                                                    height: 30,
                                                    margin: '5 0',
                                                    items: [
                                                        {
                                                            xtype: 'button',
                                                            itemId: 'Excise_Reg_AddGoods_btnAdd',
                                                            margin: '0 0 0 105',
                                                            iconCls: 'btn-add',
                                                            text: 'Add'
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            xtype: 'container',
                                            flex: 1,
                                            padding: '27 0 0 15',
                                            items: [
                                                {
                                                    xtype: 'gridpanel',
                                                    itemId: 'Excise_Reg_AddGoods_grdPermitGoods',
                                                    title: 'List Of Goods',
                                                    store: 'Excise_Reg_AddGoods_PermGoodsStore',
                                                    columns: [
                                                        {
                                                            xtype: 'gridcolumn',
                                                            width: 32,
                                                            dataIndex: 'PanNo',
                                                            text: 'PanNo'
                                                        },
                                                        {
                                                            xtype: 'gridcolumn',
                                                            dataIndex: 'SubmissionNo',
                                                            text: 'SubmissionNo'
                                                        },
                                                        {
                                                            xtype: 'gridcolumn',
                                                            dataIndex: 'ItemCode',
                                                            text: 'ItemCode'
                                                        },
                                                        {
                                                            xtype: 'gridcolumn',
                                                            dataIndex: 'FrmDate',
                                                            text: 'FrmDate'
                                                        },
                                                        {
                                                            xtype: 'gridcolumn',
                                                            dataIndex: 'PermitFrom',
                                                            text: 'PermitFrom'
                                                        },
                                                        {
                                                            xtype: 'gridcolumn',
                                                            dataIndex: 'GoodsCode',
                                                            text: 'GoodsCode'
                                                        },
                                                        {
                                                            xtype: 'gridcolumn',
                                                            dataIndex: 'FromDate',
                                                            text: 'FromDate'
                                                        },
                                                        {
                                                            xtype: 'gridcolumn',
                                                            dataIndex: 'ToDate',
                                                            text: 'ToDate'
                                                        },
                                                        {
                                                            xtype: 'gridcolumn',
                                                            dataIndex: 'GoodsNameEnglish',
                                                            text: 'GoodsNameEnglish'
                                                        },
                                                        {
                                                            xtype: 'gridcolumn',
                                                            dataIndex: 'GoodsNameNepali',
                                                            text: 'GoodsNameNepali'
                                                        },
                                                        {
                                                            xtype: 'actioncolumn',
                                                            width: 80,
                                                            defaultWidth: 50,
                                                            flex: 1,
                                                            icon: '',
                                                            iconCls: '',
                                                            items: [
                                                                {
                                                                    handler: function(view, rowIndex, colIndex, item, e, record, row) {
                                                                        Ext.Msg.confirm('Confirm Action', 'Do you want to Remove ?', function(btn) {
                                                                            if(btn == 'yes'){



                                                                                var grd =  Ext.ComponentQuery.query('#Excise_Reg_AddGoods_grdPermitGoods')[0];
                                                                                var store = grd.getStore();
                                                                                var row = store.getAt(rowIndex).data;

                                                                                if(row.Action != "A")
                                                                                {    
                                                                                    row.Action = "D";
                                                                                    grd.bindStore(store); 

                                                                                    store.filter(function(item){
                                                                                        return item.get("Action")!= 'D';
                                                                                    });
                                                                                }
                                                                                else
                                                                                {    store.removeAt(rowIndex);            
                                                                                }

                                                                                return true;
                                                                            }
                                                                        }, this);


                                                                    },
                                                                    icon: '../ITS/resources/images/icons/cancel.png',
                                                                    iconCls: '',
                                                                    tooltip: 'Delete Goods'
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    xtype: 'container',
                                    margin: '',
                                    items: [
                                        {
                                            xtype: 'button',
                                            itemId: 'Excise_Reg_AddPerm_btnBack',
                                            margin: '0 0 0 105',
                                            iconCls: 'btn-add',
                                            text: 'Back'
                                        },
                                        {
                                            xtype: 'button',
                                            itemId: 'Excise_Reg_AddGoods_btnSave',
                                            margin: '0 0 0 5',
                                            iconCls: 'icon-save',
                                            text: 'Save'
                                        },
                                        {
                                            xtype: 'button',
                                            itemId: 'Excise_Reg_AddGoods_btnCancel',
                                            margin: '0 0 0 5',
                                            iconCls: 'icon-cancel',
                                            text: 'Cancel'
                                        },
                                        {
                                            xtype: 'button',
                                            itemId: 'Excise_Reg_AddPerm_btnNext',
                                            margin: '0 0 0 5',
                                            iconCls: 'btn-add',
                                            text: 'Next'
                                        }
                                    ]
                                },
                                {
                                    xtype: 'container',
                                    height: 25,
                                    margin: '10 0',
                                    style: 'text-align:right;',
                                    items: [
                                        {
                                            xtype: 'button',
                                            hidden: true,
                                            itemId: 'Excise_Reg_Next',
                                            iconCls: 'icon-cancel',
                                            text: 'Next'
                                        },
                                        {
                                            xtype: 'hiddenfield',
                                            itemId: 'Excise_Reg_RedirectURL',
                                            fieldLabel: 'Label'
                                        },
                                        {
                                            xtype: 'hiddenfield',
                                            itemId: 'VAT_Reg_PanAction',
                                            fieldLabel: 'Label'
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            xtype: 'panel',
                            frame: true,
                            height: 1060,
                            itemId: 'ExciseRegistrationAUStep3',
                            maxHeight: 1060,
                            autoScroll: true,
                            bodyPadding: 5,
                            title: 'Step 3',
                            items: [
                                {
                                    xtype: 'fieldset',
                                    maxWidth: 1500,
                                    minWidth: 1500,
                                    title: 'Add Work Places',
                                    items: [
                                        {
                                            xtype: 'combobox',
                                            anchor: '100%',
                                            itemId: 'Excise_Reg_AddWP_Permit',
                                            maxWidth: 500,
                                            width: 500,
                                            fieldLabel: 'Permit',
                                            labelWidth: 150,
                                            emptyText: '-- Choose --',
                                            displayField: 'ItemNameEnglish',
                                            queryMode: 'local',
                                            store: 'Excise_Reg_AddWP_PermStore',
                                            valueField: 'ItemCode'
                                        },
                                        {
                                            xtype: 'textfield',
                                            cls: 'unicode',
                                            itemId: 'Excise_Reg_AddWP_PlaceName',
                                            width: 400,
                                            fieldLabel: 'Place Name ',
                                            labelWidth: 150,
                                            msgTarget: 'side',
                                            enableKeyEvents: true,
                                            enforceMaxLength: true,
                                            maxLength: 100,
                                            listeners: {
                                                keypress: {
                                                    fn: me.onExcise_Reg_AddWP_PlaceNameKeypress,
                                                    scope: me
                                                },
                                                keyup: {
                                                    fn: me.onExcise_Reg_AddWP_PlaceNameKeyup,
                                                    scope: me
                                                },
                                                change: {
                                                    fn: me.onExcise_Reg_AddWP_PlaceNameChange,
                                                    scope: me
                                                },
                                                focus: {
                                                    fn: me.onExcise_Reg_AddWP_PlaceNameFocus,
                                                    scope: me
                                                }
                                            }
                                        },
                                        {
                                            xtype: 'textfield',
                                            cls: 'unicode',
                                            itemId: 'Excise_Reg_AddWP_Purpose',
                                            width: 400,
                                            fieldLabel: 'Purpose',
                                            labelWidth: 150,
                                            msgTarget: 'side',
                                            enableKeyEvents: true,
                                            enforceMaxLength: true,
                                            maxLength: 200,
                                            listeners: {
                                                keypress: {
                                                    fn: me.onExcise_Reg_AddWP_PurposeKeypress,
                                                    scope: me
                                                },
                                                keyup: {
                                                    fn: me.onExcise_Reg_AddWP_PurposeKeyup,
                                                    scope: me
                                                },
                                                change: {
                                                    fn: me.onExcise_Reg_AddWP_PurposeChange,
                                                    scope: me
                                                },
                                                focus: {
                                                    fn: me.onExcise_Reg_AddWP_PurposeFocus,
                                                    scope: me
                                                }
                                            }
                                        },
                                        {
                                            xtype: 'combobox',
                                            itemId: 'Excise_Reg_AddWP_AddrType',
                                            fieldLabel: 'Address Type ',
                                            labelWidth: 150,
                                            emptyText: '-- Choose --',
                                            displayField: 'AddressTypeDescEn',
                                            queryMode: 'local',
                                            store: 'Excise_Reg_AddWP_AddressTypeStore',
                                            valueField: 'AddrsTypeID'
                                        },
                                        {
                                            xtype: 'fieldcontainer',
                                            height: 220,
                                            layout: {
                                                align: 'stretch',
                                                type: 'vbox'
                                            },
                                            items: [
                                                {
                                                    xtype: 'container',
                                                    layout: {
                                                        columns: 3,
                                                        type: 'table'
                                                    },
                                                    items: [
                                                        {
                                                            xtype: 'combobox',
                                                            itemId: 'Excise_Reg_AddWP_cboDistrict',
                                                            margin: '2 10 2 0',
                                                            maxHeight: 100,
                                                            fieldLabel: '',
                                                            labelWidth: 150,
                                                            emptyText: '-- Choose --',
                                                            displayField: 'DistrictNameNp',
                                                            store: 'Excise_Reg_AddWP_cboDistrictStore',
                                                            valueField: 'DistrictCode',
                                                            listeners: {
                                                                change: {
                                                                    fn: me.onExcise_Reg_AddWP_cboDistrictChange,
                                                                    scope: me
                                                                }
                                                            }
                                                        },
                                                        {
                                                            xtype: 'radiogroup',
                                                            colspan: 1,
                                                            itemId: 'Excise_Reg_AddWP_LocationType',
                                                            margin: '0 0 0 10px',
                                                            width: 250,
                                                            fieldLabel: '',
                                                            items: [
                                                                {
                                                                    xtype: 'radiofield',
                                                                    itemId: 'Excise_Reg_LocationType1',
                                                                    name: 'T1LocationType',
                                                                    boxLabel: '...',
                                                                    checked: true
                                                                },
                                                                {
                                                                    xtype: 'radiofield',
                                                                    itemId: 'Excise_Reg_LocationType2',
                                                                    name: 'T1LocationType',
                                                                    boxLabel: '-'
                                                                },
                                                                {
                                                                    xtype: 'radiofield',
                                                                    itemId: 'Excise_Reg_LocationType3',
                                                                    name: 'T1LocationType',
                                                                    boxLabel: '..'
                                                                },
                                                                {
                                                                    xtype: 'radiofield',
                                                                    itemId: 'Excise_Reg_LocationType4',
                                                                    name: 'T1LocationType',
                                                                    boxLabel: '...'
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            xtype: 'textfield',
                                                            cls: 'unicode',
                                                            itemId: 'Excise_Reg_AddWP_VDC',
                                                            margin: '0 0 0 10px',
                                                            fieldLabel: '',
                                                            labelWidth: 150,
                                                            enableKeyEvents: true,
                                                            enforceMaxLength: true,
                                                            maxLength: 60,
                                                            listeners: {
                                                                keypress: {
                                                                    fn: me.onExcise_Reg_AddWP_VDCKeypress,
                                                                    scope: me
                                                                },
                                                                keyup: {
                                                                    fn: me.onExcise_Reg_AddWP_VDCKeyup,
                                                                    scope: me
                                                                },
                                                                change: {
                                                                    fn: me.onExcise_Reg_AddWP_VDCChange,
                                                                    scope: me
                                                                },
                                                                focus: {
                                                                    fn: me.onExcise_Reg_AddWP_VDCFocus,
                                                                    scope: me
                                                                }
                                                            }
                                                        },
                                                        {
                                                            xtype: 'textfield',
                                                            cls: 'unicode',
                                                            itemId: 'Excise_Reg_AddWP_Tole',
                                                            margin: '2 10 2 0',
                                                            fieldLabel: '',
                                                            labelWidth: 150,
                                                            enableKeyEvents: true,
                                                            enforceMaxLength: true,
                                                            maxLength: 120,
                                                            listeners: {
                                                                keypress: {
                                                                    fn: me.onExcise_Reg_AddWP_ToleKeypress,
                                                                    scope: me
                                                                },
                                                                keyup: {
                                                                    fn: me.onExcise_Reg_AddWP_ToleKeyup,
                                                                    scope: me
                                                                },
                                                                change: {
                                                                    fn: me.onExcise_Reg_AddWP_ToleChange,
                                                                    scope: me
                                                                },
                                                                focus: {
                                                                    fn: me.onExcise_Reg_AddWP_ToleFocus,
                                                                    scope: me
                                                                }
                                                            }
                                                        },
                                                        {
                                                            xtype: 'textfield',
                                                            colspan: 2,
                                                            cls: 'unicode',
                                                            itemId: 'Excise_Reg_AddWP_HouseNo',
                                                            margin: '0 0 0 10px',
                                                            fieldLabel: ' ',
                                                            labelWidth: 257,
                                                            enableKeyEvents: true,
                                                            enforceMaxLength: true,
                                                            maxLength: 20,
                                                            listeners: {
                                                                keypress: {
                                                                    fn: me.onExcise_Reg_AddWP_HouseNoKeypress,
                                                                    scope: me
                                                                },
                                                                keyup: {
                                                                    fn: me.onExcise_Reg_AddWP_HouseNoKeyup,
                                                                    scope: me
                                                                },
                                                                change: {
                                                                    fn: me.onExcise_Reg_AddWP_HouseNoChange,
                                                                    scope: me
                                                                },
                                                                focus: {
                                                                    fn: me.onExcise_Reg_AddWP_HouseNoFocus,
                                                                    scope: me
                                                                }
                                                            }
                                                        },
                                                        {
                                                            xtype: 'numberfield',
                                                            itemId: 'Excise_Reg_AddWP_WardNo',
                                                            margin: '2 10 2 0',
                                                            fieldLabel: ' ',
                                                            labelWidth: 150,
                                                            enforceMaxLength: true,
                                                            maxLength: 2,
                                                            hideTrigger: true
                                                        },
                                                        {
                                                            xtype: 'combobox',
                                                            colspan: 2,
                                                            hidden: true,
                                                            itemId: 'Excise_Reg_AddWP_Region',
                                                            margin: '0 0 0 10px',
                                                            fieldLabel: '',
                                                            labelWidth: 258,
                                                            displayField: 'Office',
                                                            queryMode: 'local',
                                                            store: 'Excise_Reg_AddWP_RegionStore',
                                                            valueField: 'AreaNo'
                                                        }
                                                    ]
                                                },
                                                {
                                                    xtype: 'container',
                                                    items: [
                                                        {
                                                            xtype: 'gridpanel',
                                                            itemId: 'Excise_Reg_AddWP_GrdContact',
                                                            width: 352,
                                                            store: 'Excise_Reg_AddWP_Contact',
                                                            columns: [
                                                                {
                                                                    xtype: 'gridcolumn',
                                                                    width: 100,
                                                                    dataIndex: 'Key',
                                                                    text: ' '
                                                                },
                                                                {
                                                                    xtype: 'gridcolumn',
                                                                    width: 250,
                                                                    dataIndex: 'Value',
                                                                    text: '',
                                                                    editor: {
                                                                        xtype: 'textfield'
                                                                    }
                                                                }
                                                            ],
                                                            plugins: [
                                                                Ext.create('Ext.grid.plugin.CellEditing', {

                                                                })
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            xtype: 'label',
                                            margin: '5 0',
                                            style: 'text-decoration: underline;',
                                            text: 'Four Points '
                                        },
                                        {
                                            xtype: 'container',
                                            height: 65,
                                            layout: {
                                                type: 'table'
                                            },
                                            items: [
                                                {
                                                    xtype: 'textfield',
                                                    cls: 'unicode',
                                                    itemId: 'Excise_Reg_AddWP_East',
                                                    margin: '12 5 0 0',
                                                    fieldLabel: '     East',
                                                    labelAlign: 'top',
                                                    labelSeparator: ' ',
                                                    labelStyle: 'text-align:center',
                                                    enableKeyEvents: true,
                                                    enforceMaxLength: true,
                                                    maxLength: 100,
                                                    listeners: {
                                                        keypress: {
                                                            fn: me.onExcise_Reg_AddWP_EastKeypress,
                                                            scope: me
                                                        },
                                                        keyup: {
                                                            fn: me.onExcise_Reg_AddWP_EastKeyup,
                                                            scope: me
                                                        },
                                                        change: {
                                                            fn: me.onExcise_Reg_AddWP_EastChange,
                                                            scope: me
                                                        },
                                                        focus: {
                                                            fn: me.onExcise_Reg_AddWP_EastFocus,
                                                            scope: me
                                                        }
                                                    }
                                                },
                                                {
                                                    xtype: 'textfield',
                                                    cls: 'unicode',
                                                    itemId: 'Excise_Reg_AddWP_West',
                                                    margin: '12 5 0 0',
                                                    fieldLabel: 'West',
                                                    labelAlign: 'top',
                                                    labelSeparator: ' ',
                                                    labelStyle: 'text-align:center',
                                                    enableKeyEvents: true,
                                                    enforceMaxLength: true,
                                                    maxLength: 100,
                                                    listeners: {
                                                        keypress: {
                                                            fn: me.onExcise_Reg_AddWP_WestKeypress,
                                                            scope: me
                                                        },
                                                        keyup: {
                                                            fn: me.onExcise_Reg_AddWP_WestKeyup,
                                                            scope: me
                                                        },
                                                        change: {
                                                            fn: me.onExcise_Reg_AddWP_WestChange,
                                                            scope: me
                                                        },
                                                        focus: {
                                                            fn: me.onExcise_Reg_AddWP_WestFocus,
                                                            scope: me
                                                        }
                                                    }
                                                },
                                                {
                                                    xtype: 'textfield',
                                                    cls: 'unicode',
                                                    itemId: 'Excise_Reg_AddWP_North',
                                                    margin: '12 5 0 0',
                                                    fieldLabel: 'North',
                                                    labelAlign: 'top',
                                                    labelSeparator: ' ',
                                                    labelStyle: 'text-align:center',
                                                    enableKeyEvents: true,
                                                    enforceMaxLength: true,
                                                    maxLength: 100,
                                                    listeners: {
                                                        keypress: {
                                                            fn: me.onExcise_Reg_AddWP_NorthKeypress,
                                                            scope: me
                                                        },
                                                        keyup: {
                                                            fn: me.onExcise_Reg_AddWP_NorthKeyup,
                                                            scope: me
                                                        },
                                                        change: {
                                                            fn: me.onExcise_Reg_AddWP_NorthChange,
                                                            scope: me
                                                        },
                                                        focus: {
                                                            fn: me.onExcise_Reg_AddWP_NorthFocus,
                                                            scope: me
                                                        }
                                                    }
                                                },
                                                {
                                                    xtype: 'textfield',
                                                    cls: 'unicode',
                                                    itemId: 'Excise_Reg_AddWP_South',
                                                    margin: '12 5 0 0',
                                                    fieldLabel: 'South',
                                                    labelAlign: 'top',
                                                    labelSeparator: ' ',
                                                    labelStyle: 'text-align:center',
                                                    enableKeyEvents: true,
                                                    enforceMaxLength: true,
                                                    maxLength: 100,
                                                    listeners: {
                                                        keypress: {
                                                            fn: me.onExcise_Reg_AddWP_SouthKeypress,
                                                            scope: me
                                                        },
                                                        keyup: {
                                                            fn: me.onExcise_Reg_AddWP_SouthKeyup,
                                                            scope: me
                                                        },
                                                        change: {
                                                            fn: me.onExcise_Reg_AddWP_SouthChange,
                                                            scope: me
                                                        },
                                                        focus: {
                                                            fn: me.onExcise_Reg_AddWP_SouthFocus,
                                                            scope: me
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            xtype: 'container',
                                            items: [
                                                {
                                                    xtype: 'button',
                                                    itemId: 'Excise_Reg_AddWP_bnAddWP',
                                                    margin: '10 0 0 0',
                                                    iconCls: 'btn-add',
                                                    text: 'Add'
                                                }
                                            ]
                                        },
                                        {
                                            xtype: 'gridpanel',
                                            height: 100,
                                            itemId: 'Excise_Reg_AddWP_grdWPList',
                                            margin: '10 0 0 0 ',
                                            title: 'List Of Work Places',
                                            store: 'Excise_Reg_AddWP_WPListStore',
                                            columns: [
                                                {
                                                    xtype: 'gridcolumn',
                                                    dataIndex: 'PanNo',
                                                    text: 'PanNo'
                                                },
                                                {
                                                    xtype: 'gridcolumn',
                                                    dataIndex: 'SubmissionNo',
                                                    text: 'SubmissionNo'
                                                },
                                                {
                                                    xtype: 'gridcolumn',
                                                    dataIndex: 'ItemCode',
                                                    text: 'ItemCode'
                                                },
                                                {
                                                    xtype: 'gridcolumn',
                                                    dataIndex: 'FromDate',
                                                    text: 'FromDate'
                                                },
                                                {
                                                    xtype: 'gridcolumn',
                                                    dataIndex: 'PermitFrom',
                                                    text: 'PermitFrom'
                                                },
                                                {
                                                    xtype: 'gridcolumn',
                                                    dataIndex: 'Seq',
                                                    text: 'Seq'
                                                },
                                                {
                                                    xtype: 'gridcolumn',
                                                    dataIndex: 'WorkPlaceNo',
                                                    text: 'WorkPlaceNo'
                                                },
                                                {
                                                    xtype: 'gridcolumn',
                                                    dataIndex: 'Placename',
                                                    text: 'Placename'
                                                },
                                                {
                                                    xtype: 'gridcolumn',
                                                    dataIndex: 'Purpose',
                                                    text: 'Purpose'
                                                },
                                                {
                                                    xtype: 'actioncolumn',
                                                    items: [
                                                        {
                                                            handler: function(view, rowIndex, colIndex, item, e, record, row) {
                                                                var godownWindow = Ext.create('MyApp.view.GodownAddress',{
                                                                    autoScroll: true,
                                                                    width:1300,
                                                                    height:500,
                                                                    modal:true
                                                                });

                                                                godownWindow.index=rowIndex;


                                                                var store = Ext.getStore('Excise_Reg_AddWP_WPListStore');
                                                                var currrow = store.getAt(rowIndex).data;

                                                                var gdnStore=Ext.getStore('Excise_Reg_AddGodown_GDNListStore');
                                                                gdnStore.loadData(currrow.Godowns);

                                                                godownWindow.show();
                                                            },
                                                            icon: '../ITS/resources/images/icons/Upload.png',
                                                            tooltip: 'Add / Edit Godown/s'
                                                        }
                                                    ]
                                                },
                                                {
                                                    xtype: 'actioncolumn',
                                                    width: 80,
                                                    defaultWidth: 50,
                                                    flex: 1,
                                                    icon: '',
                                                    iconCls: '',
                                                    items: [
                                                        {
                                                            handler: function(view, rowIndex, colIndex, item, e, record, row) {
                                                                var grd=Ext.ComponentQuery.query('#Excise_Reg_AddWP_grdWPList')[0];

                                                                grd.getSelectionModel().select(rowIndex);

                                                                var  WPListStore=grd.getStore();

                                                                var WP=WPListStore.getAt(rowIndex).data;
                                                                var WPAddress=WP.WorkPlaceAddress;
                                                                var Address=WPAddress.Address;


                                                                Ext.ComponentQuery.query('#Excise_Reg_AddWP_Permit')[0].setValue(WP.ItemCode);
                                                                Ext.ComponentQuery.query('#Excise_Reg_AddWP_PlaceName')[0].setValue(WP.Placename);

                                                                Ext.ComponentQuery.query('#Excise_Reg_AddWP_Purpose')[0].setValue(WP.Purpose);

                                                                Ext.ComponentQuery.query('#Excise_Reg_AddWP_AddrType')[0].setValue("");





                                                                Ext.ComponentQuery.query('#Excise_Reg_AddWP_cboDistrict')[0].setValue(Address.DistrictCode);
                                                                Ext.ComponentQuery.query('#Excise_Reg_AddWP_Tole')[0].setValue(Address.StreetName);

                                                                Ext.ComponentQuery.query('#Excise_Reg_AddWP_WardNo')[0].setValue(Address.WardNo);

                                                                Ext.ComponentQuery.query('#Excise_Reg_AddWP_VDC')[0].setValue(Address.VdcTown);

                                                                Ext.ComponentQuery.query('#Excise_Reg_AddWP_HouseNo')[0].setValue(Address.HouseNo);

                                                                Ext.ComponentQuery.query('#Excise_Reg_AddWP_Region')[0].setValue(Address.AreaCode);


                                                                Ext.ComponentQuery.query('#Excise_Reg_AddWP_East')[0].setValue(WPAddress.East);

                                                                Ext.ComponentQuery.query('#Excise_Reg_AddWP_West')[0].setValue(WPAddress.West);

                                                                Ext.ComponentQuery.query('#Excise_Reg_AddWP_North')[0].setValue(WPAddress.North);

                                                                Ext.ComponentQuery.query('#Excise_Reg_AddWP_South')[0].setValue(WPAddress.South);



                                                                var Contact= Ext.getStore('Excise_Reg_AddWP_Contact');


                                                                Contact.getAt(3).set({Value:Address.Telephone});    
                                                                //Contact.getAt(2).set({Value:Address.Telephone});
                                                                Contact.getAt(1).set({Value:Address.Fax});
                                                                Contact.getAt(0).set({Value:Address.Email});



                                                            },
                                                            icon: '../ITS/resources/images/icons/pencil.png',
                                                            iconCls: '',
                                                            tooltip: 'Edit Workplace'
                                                        }
                                                    ]
                                                },
                                                {
                                                    xtype: 'actioncolumn',
                                                    width: 80,
                                                    defaultWidth: 50,
                                                    flex: 1,
                                                    icon: '',
                                                    iconCls: '',
                                                    items: [
                                                        {
                                                            handler: function(view, rowIndex, colIndex, item, e, record, row) {
                                                                Ext.Msg.confirm('Confirm Action', 'Do you want to Remove ?', function(btn) {
                                                                    if(btn == 'yes'){



                                                                        var grd =  Ext.ComponentQuery.query('#Excise_Reg_AddWP_grdWPList')[0];
                                                                        var store = grd.getStore();
                                                                        var row = store.getAt(rowIndex).data;

                                                                        if(row.Action != "A")
                                                                        {    
                                                                            row.Action = "D";
                                                                            grd.bindStore(store); 

                                                                            store.filter(function(item){
                                                                                return item.get("Action")!= 'D';
                                                                            });
                                                                        }
                                                                        else
                                                                        {    store.removeAt(rowIndex);            
                                                                        }

                                                                        return true;
                                                                    }
                                                                }, this);
                                                            },
                                                            icon: '../ITS/resources/images/icons/cancel.png',
                                                            iconCls: '',
                                                            tooltip: 'Delete Workplace'
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    xtype: 'container',
                                    margin: '',
                                    items: [
                                        {
                                            xtype: 'button',
                                            itemId: 'Excise_Reg_AddWP_btnBack',
                                            margin: '0 0 0 105',
                                            iconCls: 'btn-add',
                                            text: 'Back'
                                        },
                                        {
                                            xtype: 'button',
                                            itemId: 'Excise_Reg_AddWP_btnSave',
                                            margin: '0 0 0 5',
                                            iconCls: 'icon-save',
                                            text: 'Save'
                                        },
                                        {
                                            xtype: 'button',
                                            itemId: 'Excise_Reg_AddWP_btnCancel',
                                            margin: '0 0 0 5',
                                            iconCls: 'icon-cancel',
                                            text: 'Cancel'
                                        },
                                        {
                                            xtype: 'button',
                                            itemId: 'Excise_Reg_AddWP_btnNext',
                                            margin: '0 0 0 5',
                                            iconCls: 'btn-add',
                                            text: 'Next'
                                        }
                                    ]
                                },
                                {
                                    xtype: 'container',
                                    height: 25,
                                    margin: '10 0',
                                    style: 'text-align:right;',
                                    items: [
                                        {
                                            xtype: 'button',
                                            hidden: true,
                                            itemId: 'Excise_Reg_Next',
                                            iconCls: 'icon-cancel',
                                            text: 'Next'
                                        },
                                        {
                                            xtype: 'hiddenfield',
                                            itemId: 'Excise_Reg_RedirectURL',
                                            fieldLabel: 'Label'
                                        },
                                        {
                                            xtype: 'hiddenfield',
                                            itemId: 'VAT_Reg_PanAction',
                                            fieldLabel: 'Label'
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            xtype: 'panel',
                            frame: true,
                            height: 700,
                            itemId: 'ExciseRegistrationAUStep4',
                            maxHeight: 700,
                            autoScroll: true,
                            bodyPadding: 5,
                            title: 'Step 4',
                            tabConfig: {
                                xtype: 'tab',
                                itemId: 'Excise_Reg_Stages_cboPermit'
                            },
                            items: [
                                {
                                    xtype: 'label',
                                    style: 'text-decoration:underline;',
                                    text: 'Production Stages Setup for Work Places'
                                },
                                {
                                    xtype: 'combobox',
                                    itemId: 'Excise_Reg_Stages_cboPermit',
                                    margin: '5 0 0 0',
                                    minWidth: 500,
                                    width: 500,
                                    fieldLabel: 'Permit ',
                                    emptyText: '-- Choose --',
                                    displayField: 'ItemNameEnglish',
                                    queryMode: 'local',
                                    store: 'Excise_Reg_Stages_cboPermitStore',
                                    valueField: 'ItemCode'
                                },
                                {
                                    xtype: 'container',
                                    margin: '10 0 0 0',
                                    maxWidth: 850,
                                    minWidth: 850,
                                    width: 850,
                                    layout: {
                                        columns: 2,
                                        type: 'table'
                                    },
                                    items: [
                                        {
                                            xtype: 'gridpanel',
                                            height: 175,
                                            itemId: 'Excise_Reg_Stages_WpList',
                                            maxWidth: 355,
                                            width: 355,
                                            title: 'Work Places',
                                            store: 'Excise_Reg_Stages_permWpStore',
                                            columns: [
                                                {
                                                    xtype: 'gridcolumn',
                                                    dataIndex: 'WorkPlaceNo',
                                                    text: 'WorkPlaceNo'
                                                },
                                                {
                                                    xtype: 'gridcolumn',
                                                    dataIndex: 'Placename',
                                                    text: 'Placename'
                                                },
                                                {
                                                    xtype: 'gridcolumn',
                                                    dataIndex: 'Purpose',
                                                    text: 'Purpose'
                                                }
                                            ],
                                            selModel: Ext.create('Ext.selection.CheckboxModel', {

                                            })
                                        },
                                        {
                                            xtype: 'gridpanel',
                                            height: 175,
                                            itemId: 'Excise_Reg_Stages_PermitStages',
                                            margin: '0 0 0 10',
                                            maxWidth: 455,
                                            minWidth: 455,
                                            width: 455,
                                            title: 'Stages',
                                            store: 'Excise_Reg_Stages_PermitStagesStore',
                                            columns: [
                                                {
                                                    xtype: 'gridcolumn',
                                                    dataIndex: 'StageDescEng',
                                                    text: 'StageDescEng'
                                                },
                                                {
                                                    xtype: 'gridcolumn',
                                                    dataIndex: 'StageNo',
                                                    text: 'StageNo'
                                                },
                                                {
                                                    xtype: 'gridcolumn',
                                                    dataIndex: 'ItemCode',
                                                    text: 'ItemCode'
                                                },
                                                {
                                                    xtype: 'gridcolumn',
                                                    dataIndex: 'StageDescNep',
                                                    text: 'StageDescNep'
                                                }
                                            ],
                                            selModel: Ext.create('Ext.selection.CheckboxModel', {

                                            })
                                        }
                                    ]
                                },
                                {
                                    xtype: 'container',
                                    margin: '10 0',
                                    items: [
                                        {
                                            xtype: 'button',
                                            itemId: 'Excise_Reg_Stages_btnAdd',
                                            icon: 'btn-add',
                                            text: 'Add'
                                        }
                                    ]
                                },
                                {
                                    xtype: 'gridpanel',
                                    itemId: 'Excise_Reg_Stages_ProductionStagesUsedList',
                                    width: 830,
                                    title: 'Work Place Stages',
                                    store: 'Excise_Reg_Stages_ProductionStagesUsedStore',
                                    columns: [
                                        {
                                            xtype: 'gridcolumn',
                                            dataIndex: 'SubmissionNo',
                                            text: 'SubmissionNo'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            dataIndex: 'WorkPlaceNo',
                                            text: 'WorkPlaceNo'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            dataIndex: 'ItemNameEnglish',
                                            text: 'ItemNameEnglish'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            dataIndex: 'StageDescEng',
                                            text: 'StageDescEng'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            dataIndex: 'ItemCode',
                                            text: 'ItemCode'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            dataIndex: 'StageNo',
                                            text: 'StageNo'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            dataIndex: 'StageDescNep',
                                            text: 'StageDescNep'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            dataIndex: 'Action',
                                            text: 'Action'
                                        },
                                        {
                                            xtype: 'actioncolumn',
                                            width: 80,
                                            defaultWidth: 50,
                                            flex: 1,
                                            icon: '',
                                            iconCls: '',
                                            items: [
                                                {
                                                    handler: function(view, rowIndex, colIndex, item, e, record, row) {
                                                        Ext.Msg.confirm('Confirm Action', 'Do you want to Remove ?', function(btn) {
                                                            if(btn == 'yes'){



                                                                var grd =  Ext.ComponentQuery.query('#Excise_Reg_Stages_ProductionStagesUsedList')[0];
                                                                var store = grd.getStore();
                                                                var row = store.getAt(rowIndex).data;

                                                                if(row.Action != "A")
                                                                {    
                                                                    row.Action = "D";
                                                                    grd.bindStore(store); 

                                                                    store.filter(function(item){
                                                                        return item.get("Action")!= 'D';
                                                                    });
                                                                }
                                                                else
                                                                {    store.removeAt(rowIndex);            
                                                                }

                                                                return true;
                                                            }
                                                        }, this);


                                                    },
                                                    icon: '../ITS/resources/images/icons/cancel.png',
                                                    iconCls: '',
                                                    tooltip: 'Delete Stage'
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    xtype: 'container',
                                    margin: '10 0 0 0',
                                    items: [
                                        {
                                            xtype: 'button',
                                            itemId: 'Excise_Reg_Stages_btnBack',
                                            margin: '0 0 0 105',
                                            text: 'Back'
                                        },
                                        {
                                            xtype: 'button',
                                            itemId: 'Excise_Reg_Stages_btnSave',
                                            margin: '0 0 0 5',
                                            iconCls: 'icon-save',
                                            text: 'Save'
                                        },
                                        {
                                            xtype: 'button',
                                            itemId: 'Excise_Reg_Stages_btnCancel',
                                            margin: '0 0 0 5',
                                            iconCls: 'icon-cancel',
                                            text: 'Cancel'
                                        },
                                        {
                                            xtype: 'button',
                                            itemId: 'Excise_Reg_Stages_btnNext',
                                            margin: '0 0 0 5',
                                            text: 'Next'
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            xtype: 'panel',
                            frame: true,
                            itemId: 'ExciseRegistrationAUStep5',
                            bodyPadding: 5,
                            title: 'Step 5',
                            items: [
                                {
                                    xtype: 'combobox',
                                    itemId: 'Excise_Reg_StagesIpOp_cboPermit',
                                    minWidth: 500,
                                    width: 500,
                                    fieldLabel: 'Permit ',
                                    labelWidth: 150,
                                    emptyText: '-- Choose --',
                                    displayField: 'ItemNameEnglish',
                                    queryMode: 'local',
                                    store: 'Excise_Reg_Stages_cboPermitStore',
                                    valueField: 'ItemCode'
                                },
                                {
                                    xtype: 'gridpanel',
                                    itemId: 'Excise_Reg_StagesIpOp_Stages',
                                    title: 'Stages',
                                    store: 'Excise_Reg_StagesIpOp_StagesStore',
                                    columns: [
                                        {
                                            xtype: 'gridcolumn',
                                            dataIndex: 'PanNo',
                                            text: 'PanNo'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            dataIndex: 'SubmissionNo',
                                            text: 'SubmissionNo'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            dataIndex: 'WorkPlaceNo',
                                            text: 'WorkPlaceNo'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            dataIndex: 'ItemCode',
                                            text: 'ItemCode'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            dataIndex: 'StageNo',
                                            text: 'StageNo'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            dataIndex: 'ItemNameEnglish',
                                            text: 'ItemNameEnglish'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            dataIndex: 'StageDescEng',
                                            text: 'StageDescEng'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            dataIndex: 'StageDescNep',
                                            text: 'StageDescNep'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            dataIndex: 'Action',
                                            text: 'Action'
                                        }
                                    ],
                                    selModel: Ext.create('Ext.selection.RowModel', {
                                        listeners: {
                                            selectionchange: {
                                                fn: me.onRowselectionmodelSelectionChange,
                                                scope: me
                                            }
                                        }
                                    })
                                },
                                {
                                    xtype: 'container',
                                    cls: 'tteesstt',
                                    margin: '5 0 0 0',
                                    padding: '5 0 0 0',
                                    width: 800,
                                    layout: {
                                        columns: 2,
                                        type: 'table'
                                    },
                                    items: [
                                        {
                                            xtype: 'container',
                                            colspan: 1,
                                            height: 200,
                                            autoScroll: true,
                                            items: [
                                                {
                                                    xtype: 'gridpanel',
                                                    itemId: 'Excise_Reg_StagesIpOp_IPRawMaterial',
                                                    width: 350,
                                                    title: 'Input Raw Materials',
                                                    store: 'Excise_Reg_StagesIpOp_IPRawMaterialStore',
                                                    columns: [
                                                        {
                                                            xtype: 'gridcolumn',
                                                            dataIndex: 'RawMaterialId',
                                                            text: 'RawMaterialId'
                                                        },
                                                        {
                                                            xtype: 'gridcolumn',
                                                            dataIndex: 'MaterialDescNep',
                                                            text: 'MaterialDescNep'
                                                        },
                                                        {
                                                            xtype: 'gridcolumn',
                                                            dataIndex: 'MaterialDescEng',
                                                            text: 'MaterialDescEng'
                                                        }
                                                    ],
                                                    selModel: Ext.create('Ext.selection.CheckboxModel', {

                                                    })
                                                }
                                            ]
                                        },
                                        {
                                            xtype: 'container',
                                            colspan: 1,
                                            height: 200,
                                            autoScroll: true,
                                            items: [
                                                {
                                                    xtype: 'gridpanel',
                                                    itemId: 'Excise_Reg_StagesIpOp_OPRawMaterial',
                                                    margin: '0 0 0 10',
                                                    width: 350,
                                                    title: 'Output Raw Materials',
                                                    store: 'Excise_Reg_StagesIpOp_OPRawMaterialStore',
                                                    columns: [
                                                        {
                                                            xtype: 'gridcolumn',
                                                            dataIndex: 'RawMaterialId',
                                                            text: 'RawMaterialId'
                                                        },
                                                        {
                                                            xtype: 'gridcolumn',
                                                            dataIndex: 'MaterialDescNep',
                                                            text: 'MaterialDescNep'
                                                        },
                                                        {
                                                            xtype: 'gridcolumn',
                                                            dataIndex: 'MaterialDescEng',
                                                            text: 'MaterialDescEng'
                                                        }
                                                    ],
                                                    selModel: Ext.create('Ext.selection.CheckboxModel', {

                                                    })
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    xtype: 'container',
                                    margin: '10 0 0 0',
                                    items: [
                                        {
                                            xtype: 'button',
                                            itemId: 'Excise_Reg_StagesIpOp_btnBack',
                                            margin: '0 0 0 105',
                                            text: 'Back'
                                        },
                                        {
                                            xtype: 'button',
                                            itemId: 'Excise_Reg_StagesIpOp_btnSave',
                                            margin: '0 0 0 5',
                                            iconCls: 'icon-save',
                                            text: 'Save'
                                        },
                                        {
                                            xtype: 'button',
                                            itemId: 'Excise_Reg_StagesIpOp_btnCancel',
                                            margin: '0 0 0 5',
                                            iconCls: 'icon-cancel',
                                            text: 'Cancel'
                                        },
                                        {
                                            xtype: 'button',
                                            itemId: 'Excise_Reg_StagesIpOp_btnNext',
                                            margin: '0 0 0 5',
                                            text: 'Next'
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            xtype: 'panel',
                            frame: true,
                            itemId: 'ExciseRegistrationAUStep6',
                            layout: {
                                columns: 1,
                                type: 'table'
                            },
                            bodyPadding: 5,
                            bodyStyle: 'text-align:center;',
                            title: 'Step 6',
                            items: [
                                {
                                    xtype: 'label',
                                    text: 'Your may Submit your Registration Request Now. '
                                },
                                {
                                    xtype: 'button',
                                    itemId: 'Exc_Reg_btnSubmit',
                                    text: 'Submit Registration'
                                },
                                {
                                    xtype: 'label',
                                    text: 'Or'
                                },
                                {
                                    xtype: 'button',
                                    itemId: 'Exc_Reg_btnChangeDetails',
                                    text: 'Click here to make changes to your registration details '
                                }
                            ]
                        }
                    ]
                }
            ]
        });

        me.callParent(arguments);
    },

    onExcise_Reg_AddPerm_FromDateBlur: function(component, e, eOpts) {
        validateFutureDate(component.getValue(),'N',function(){component.focus();});

    },

    onExcise_Reg_AddPerm_ToDateBlur: function(component, e, eOpts) {
        validateFutureDate(component.getValue(),'N',function(){component.focus();});

    },

    onExcise_Reg_AddPerm_AssetBlur: function(component, e, eOpts) {
        var combobox=Ext.ComponentQuery.query('#Excise_Reg_AddPerm_PermType')[0];
        var value = combobox.getValue();
        var record = combobox.findRecord(combobox.valueField || combobox.displayField, value);
        var index = combobox.store.indexOf(record);

        var store=Ext.getStore('Excise_Reg_AddPerm_PerTypStore');

        var asset=Ext.ComponentQuery.query('#Excise_Reg_AddPerm_Asset')[0].getValue();    

        var perAmount=Number(store.getAt(index).data.PerAmount);    
        var rate=Number(store.getAt(index).data.Rate);
        var minAmount=Number(store.getAt(index).data.MinAmount);
        var maxAmount=Number(store.getAt(index).data.MaxAmount);    
        var permAmt=0;



        var q=asset/perAmount;
        var q1=String.split(q,'.')[0];   

        permAmt=Number(q1)*Number(rate);

        if(permAmt<minAmount)
        {
            permAmt=minAmount;
        }
        else if(permAmt>maxAmount)
        {
            permAmt=maxAmount;
        }

        Ext.ComponentQuery.query('#Excise_Reg_AddPerm_PermRate')[0].setValue(permAmt);
    },

    onExcise_Reg_AddWP_PlaceNameKeypress: function(textfield, e, eOpts) {
        return unicodeKeyPress(textfield,e, eOpts);
    },

    onExcise_Reg_AddWP_PlaceNameKeyup: function(textfield, e, eOpts) {
        unicodeKeyUp(textfield,e, eOpts);
    },

    onExcise_Reg_AddWP_PlaceNameChange: function(field, newValue, oldValue, eOpts) {
        unicodeChange(field, newValue, oldValue, eOpts);
    },

    onExcise_Reg_AddWP_PlaceNameFocus: function(component, e, eOpts) {
        unicodeFocus(component, eOpts);
    },

    onExcise_Reg_AddWP_PurposeKeypress: function(textfield, e, eOpts) {
        return unicodeKeyPress(textfield,e, eOpts);
    },

    onExcise_Reg_AddWP_PurposeKeyup: function(textfield, e, eOpts) {
        unicodeKeyUp(textfield,e, eOpts);
    },

    onExcise_Reg_AddWP_PurposeChange: function(field, newValue, oldValue, eOpts) {
        unicodeChange(field, newValue, oldValue, eOpts);
    },

    onExcise_Reg_AddWP_PurposeFocus: function(component, e, eOpts) {
        unicodeFocus(component, eOpts);
    },

    onExcise_Reg_AddWP_cboDistrictChange: function(field, newValue, oldValue, eOpts) {
        var combobox=Ext.ComponentQuery.query('#Excise_Reg_AddWP_cboDistrict')[0];
        var value = combobox.getValue();
        var record = combobox.findRecord(combobox.valueField || combobox.displayField, value);
        var index = combobox.store.indexOf(record);


        var store=Ext.ComponentQuery.query('#Excise_Reg_AddWP_cboDistrict')[0].getStore();

        console.log(store.getAt(index).data);
        /*
        var areas=store.getAt(index).data.DistrictAreas;
        var len=areas.length;
        var arr=[];
        var Office="";
        for(var i=0;i<len;i++)
        {
        if(Office!=areas[i].Office && areas[i].Level==2)
        {
        arr.push(areas[i]);
        Office=areas[i].Office;
        }
        }
        var desStore=Ext.ComponentQuery.query('#Excise_Reg_AddWP_Region')[0].getStore();
        desStore.loadData(arr);
        */
    },

    onExcise_Reg_AddWP_VDCKeypress: function(textfield, e, eOpts) {
        return unicodeKeyPress(textfield,e, eOpts);
    },

    onExcise_Reg_AddWP_VDCKeyup: function(textfield, e, eOpts) {
        unicodeKeyUp(textfield,e, eOpts);
    },

    onExcise_Reg_AddWP_VDCChange: function(field, newValue, oldValue, eOpts) {
        unicodeChange(field, newValue, oldValue, eOpts);
    },

    onExcise_Reg_AddWP_VDCFocus: function(component, e, eOpts) {
        unicodeFocus(component, eOpts);
    },

    onExcise_Reg_AddWP_ToleKeypress: function(textfield, e, eOpts) {
        return unicodeKeyPress(textfield,e, eOpts);
    },

    onExcise_Reg_AddWP_ToleKeyup: function(textfield, e, eOpts) {
        unicodeKeyUp(textfield,e, eOpts);
    },

    onExcise_Reg_AddWP_ToleChange: function(field, newValue, oldValue, eOpts) {
        unicodeChange(field, newValue, oldValue, eOpts);
    },

    onExcise_Reg_AddWP_ToleFocus: function(component, e, eOpts) {
        unicodeFocus(component, eOpts);
    },

    onExcise_Reg_AddWP_HouseNoKeypress: function(textfield, e, eOpts) {
        return unicodeKeyPress(textfield,e, eOpts);
    },

    onExcise_Reg_AddWP_HouseNoKeyup: function(textfield, e, eOpts) {
        unicodeKeyUp(textfield,e, eOpts);
    },

    onExcise_Reg_AddWP_HouseNoChange: function(field, newValue, oldValue, eOpts) {
        unicodeChange(field, newValue, oldValue, eOpts);
    },

    onExcise_Reg_AddWP_HouseNoFocus: function(component, e, eOpts) {
        unicodeFocus(component, eOpts);
    },

    onExcise_Reg_AddWP_EastKeypress: function(textfield, e, eOpts) {
        return unicodeKeyPress(textfield,e, eOpts);
    },

    onExcise_Reg_AddWP_EastKeyup: function(textfield, e, eOpts) {
        unicodeKeyUp(textfield,e, eOpts);
    },

    onExcise_Reg_AddWP_EastChange: function(field, newValue, oldValue, eOpts) {
        unicodeChange(field, newValue, oldValue, eOpts);
    },

    onExcise_Reg_AddWP_EastFocus: function(component, e, eOpts) {
        unicodeFocus(component, eOpts);
    },

    onExcise_Reg_AddWP_WestKeypress: function(textfield, e, eOpts) {
        return unicodeKeyPress(textfield,e, eOpts);
    },

    onExcise_Reg_AddWP_WestKeyup: function(textfield, e, eOpts) {
        unicodeKeyUp(textfield,e, eOpts);
    },

    onExcise_Reg_AddWP_WestChange: function(field, newValue, oldValue, eOpts) {
        unicodeChange(field, newValue, oldValue, eOpts);
    },

    onExcise_Reg_AddWP_WestFocus: function(component, e, eOpts) {
        unicodeFocus(component, eOpts);
    },

    onExcise_Reg_AddWP_NorthKeypress: function(textfield, e, eOpts) {
        return unicodeKeyPress(textfield,e, eOpts);
    },

    onExcise_Reg_AddWP_NorthKeyup: function(textfield, e, eOpts) {
        unicodeKeyUp(textfield,e, eOpts);
    },

    onExcise_Reg_AddWP_NorthChange: function(field, newValue, oldValue, eOpts) {
        unicodeChange(field, newValue, oldValue, eOpts);
    },

    onExcise_Reg_AddWP_NorthFocus: function(component, e, eOpts) {
        unicodeFocus(component, eOpts);
    },

    onExcise_Reg_AddWP_SouthKeypress: function(textfield, e, eOpts) {
        return unicodeKeyPress(textfield,e, eOpts);
    },

    onExcise_Reg_AddWP_SouthKeyup: function(textfield, e, eOpts) {
        unicodeKeyUp(textfield,e, eOpts);
    },

    onExcise_Reg_AddWP_SouthChange: function(field, newValue, oldValue, eOpts) {
        unicodeChange(field, newValue, oldValue, eOpts);
    },

    onExcise_Reg_AddWP_SouthFocus: function(component, e, eOpts) {
        unicodeFocus(component, eOpts);
    },

    onRowselectionmodelSelectionChange: function(model, selected, eOpts) {
        var str=Ext.getStore('Excise_Reg_StagesIpOp_StagesStore');
        var sel=Ext.ComponentQuery.query('#Excise_Reg_StagesIpOp_Stages')[0].getSelectionModel().getSelection()[0];
        var indx=str.indexOf(sel);


        var grdIP=Ext.ComponentQuery.query('#Excise_Reg_StagesIpOp_IPRawMaterial')[0];
        var ipSelection=grdIP.getSelectionModel();
        var grdOP=Ext.ComponentQuery.query('#Excise_Reg_StagesIpOp_OPRawMaterial')[0];
        var opSelection=grdOP.getSelectionModel();

        if(selected[0])
        {
            var store=Ext.getStore('Excise_Reg_StagesIpOp_IPRawMaterialStore');
            var store1=Ext.getStore('Excise_Reg_StagesIpOp_OPRawMaterialStore');
            Ext.Ajax.request({
                url: '../Handlers/Excise/LookUps/PSMaterialHandler.ashx?method=GetPSInputRawMaterials',
                params:{
                    itemCode:selected[0].data.ItemCode,
                    stageNo:selected[0].data.StageNo
                },
                success: function ( result, request ) {
                    var data = Ext.decode(result.responseText); 
                    if(data.root)
                    {   
                        store.loadData(data.root);  


                        /////
                        Ext.Ajax.request({
                            url: '../Handlers/Excise/LookUps/PSMaterialHandler.ashx?method=GetPSOutputRawMaterials',
                            params:{
                                itemCode:selected[0].data.ItemCode,
                                stageNo:selected[0].data.StageNo
                            },
                            success: function ( result, request ) {
                                var data = Ext.decode(result.responseText); 
                                if(data.root)
                                {   
                                    store1.loadData(data.root); 

                                    /////////////////                            
                                    var count=store.getCount(); 
                                    var pSMaterialIps = str.getAt(indx).get('PSMaterialIps');
                                    var count1=pSMaterialIps.length;
                                    for(var i=0;i<count;i++)
                                    {
                                        var psMatIp=store.getAt(i);
                                        console.log('psMatIp',psMatIp);                                
                                        var itmCode=psMatIp.get('ItemCode');
                                        var stageNo=psMatIp.get('StageNo');
                                        var rawMatId=psMatIp.get('RawMaterialId');

                                        for(var j=0;j<count1;j++)
                                        {
                                            var psMatIp1=pSMaterialIps[j];

                                            var itmCode1=psMatIp1.ItemCode;
                                            var stageNo1=psMatIp1.StageNo;
                                            var rawMatId1=psMatIp1.RawMaterialID;

                                            if(itmCode==itmCode1 && stageNo==stageNo1 && rawMatId==rawMatId1)
                                            {
                                                ipSelection.select(i,true);
                                                break;

                                            }

                                        }
                                    }


                                    //////////////////

                                    /////////////////                            
                                    var counta=store1.getCount(); 
                                    var pSMaterialOps = str.getAt(indx).get('PSMaterialOps');                            
                                    var counta1=pSMaterialOps.length;

                                    for(var k=0;k<counta;k++)
                                    {

                                        var psMatOp=store1.getAt(k);
                                        console.log('psMatOp',psMatOp);                                
                                        var itmCodea=psMatOp.get('ItemCode');
                                        var stageNoa=psMatOp.get('StageNo');
                                        var rawMatIda=psMatOp.get('RawMaterialId');

                                        for(var l=0;l<counta1;l++)
                                        {
                                            var psMatOpa1=pSMaterialOps[l];

                                            var itmCodea1=psMatOpa1.ItemCode;
                                            var stageNoa1=psMatOpa1.StageNo;
                                            var rawMatIda1=psMatOpa1.RawMaterialID;

                                            if(itmCodea==itmCodea1 && stageNoa==stageNoa1 && rawMatIda==rawMatIda1)
                                            {
                                                opSelection.select(k,true);
                                                break;

                                            }

                                        }
                                    }


                                    //////////////////
                                } 

                            },
                            failure: function ( result, request ) {
                                Ext.Msg.show({
                                    title: 'Failure',
                                    msg: 'ERROR OCURRED !!!' ,
                                    buttons: Ext.MessageBox.OK,
                                    icon:Ext.Msg.ERROR
                                });
                            }

                        });
                        /////
                    }

                },
                failure: function ( result, request ) {
                    Ext.Msg.show({
                        title: 'Failure',
                        msg: 'ERROR OCURRED !!!' ,
                        buttons: Ext.MessageBox.OK,
                        icon:Ext.Msg.ERROR
                    });
                }

            });
        }
    }

});