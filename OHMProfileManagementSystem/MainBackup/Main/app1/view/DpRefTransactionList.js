/*
 * File: app/view/DpRefTransactionList.js
 *
 * This file was generated by Sencha Architect version 2.2.2.
 * http://www.sencha.com/products/architect/
 *
 * This file requires use of the Ext JS 4.0.x library, under independent license.
 * License of Sencha Architect does not include license for Ext JS 4.0.x. For more
 * details see http://www.sencha.com/license or contact license@sencha.com.
 *
 * This file will be auto-generated each and everytime you save your project.
 *
 * Do NOT hand edit this file.
 */

Ext.define('MyApp.view.DpRefTransactionList', {
    extend: 'Ext.panel.Panel',

    frame: true,
    id: 'pnlTDSTranList',
    itemId: 'pnlTDSTranList',
    title: 'Transaction Lists',

    initComponent: function() {
        var me = this;

        Ext.applyIf(me, {
            items: [
                {
                    xtype: 'form',
                    frame: true,
                    height: 150,
                    id: 'frmDRTLSearch',
                    itemId: 'frmDRTLSearch',
                    margin: '20 0 0 0',
                    bodyPadding: 10,
                    items: [
                        {
                            xtype: 'container',
                            margin: '0 0 0 150',
                            items: [
                                {
                                    xtype: 'label',
                                    id: 'lblDRTLSearch',
                                    itemId: 'lblDRTLSearch',
                                    text: 'Search Filters'
                                }
                            ]
                        },
                        {
                            xtype: 'container',
                            height: 68,
                            margin: '10 150 0 150',
                            items: [
                                {
                                    xtype: 'toolbar',
                                    items: [
                                        {
                                            xtype: 'button',
                                            id: 'btnDRTLReset',
                                            itemId: 'btnDRTLReset',
                                            maxHeight: 25,
                                            maxWidth: 80,
                                            text: 'Reset'
                                        },
                                        {
                                            xtype: 'button',
                                            id: 'btnDRTLSearch',
                                            itemId: 'btnDRTLSearch',
                                            text: 'Search'
                                        }
                                    ]
                                },
                                {
                                    xtype: 'form',
                                    frame: true,
                                    height: 60,
                                    id: 'frmDLRTFilters',
                                    itemId: 'frmDLRTFilters',
                                    layout: {
                                        align: 'stretch',
                                        type: 'hbox'
                                    },
                                    bodyPadding: 10,
                                    items: [
                                        {
                                            xtype: 'combobox',
                                            flex: 1,
                                            id: 'cboDRLTUser',
                                            itemId: 'cboDRLTUser',
                                            maxWidth: 150,
                                            allowBlank: false,
                                            emptyText: '--select--',
                                            displayField: 'UserDesc',
                                            queryMode: 'local',
                                            store: 'DOfficerAgency',
                                            valueField: 'UserDesc'
                                        },
                                        {
                                            xtype: 'combobox',
                                            flex: 1,
                                            id: 'cboDRLTLike',
                                            itemId: 'cboDRLTLike',
                                            maxWidth: 150,
                                            labelWidth: 50,
                                            allowBlank: false,
                                            emptyText: '--select--',
                                            displayField: 'Display',
                                            queryMode: 'local',
                                            store: 'DLike',
                                            valueField: 'Display'
                                        },
                                        {
                                            xtype: 'textfield',
                                            flex: 1,
                                            id: 'txtDRLTType',
                                            itemId: 'txtDRLTType',
                                            maxHeight: 24,
                                            maxWidth: 150,
                                            allowBlank: false
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    xtype: 'panel',
                    frame: true,
                    height: 250,
                    items: [
                        {
                            xtype: 'gridpanel',
                            height: 230,
                            id: 'grdDRLTTranList',
                            itemId: 'grdDRLTTranList',
                            autoScroll: true,
                            store: 'DRefOfficerTranList',
                            columns: [
                                {
                                    xtype: 'rownumberer',
                                    width: 35,
                                    text: 'S.No.'
                                },
                                {
                                    xtype: 'actioncolumn',
                                    width: 25,
                                    defaultWidth: 50,
                                    items: [
                                        {
                                            handler: function(view, rowIndex, colIndex, item, e) {
                                                var grd = Ext.ComponentQuery.query("#grdDRLTTranList")[0];

                                                var data = grd.getStore('DOfficerTranList').getAt(rowIndex);
                                                var hdnaction = Ext.ComponentQuery.query("#hdnDRTLaction")[0];
                                                hdnaction.setValue("");

                                                var status = data.get('RecStatus');

                                                if(status=="F")
                                                {
                                                    hdnaction.setValue("view");
                                                }
                                                else if(status=="V")
                                                {
                                                    msg("INFO","The transaction is already Verified!");
                                                }
                                                else
                                                {
                                                    msg("WARNING","The transaction should be finalized to perform this operation!");
                                                }
                                            },
                                            icon: '../ITS/resources/images/icons/search.png',
                                            iconCls: 'iconMargin',
                                            tooltip: 'View'
                                        }
                                    ]
                                },
                                {
                                    xtype: 'gridcolumn',
                                    width: 120,
                                    dataIndex: 'TranNo',
                                    text: 'Claim No.'
                                },
                                {
                                    xtype: 'gridcolumn',
                                    width: 300,
                                    dataIndex: 'Username',
                                    text: 'Diplomat User'
                                },
                                {
                                    xtype: 'gridcolumn',
                                    width: 60,
                                    defaultWidth: 60,
                                    dataIndex: 'DateType',
                                    text: 'Date Type'
                                },
                                {
                                    xtype: 'gridcolumn',
                                    dataIndex: 'FromDate',
                                    text: 'From Date'
                                },
                                {
                                    xtype: 'gridcolumn',
                                    dataIndex: 'ToDate',
                                    text: 'To Date'
                                },
                                {
                                    xtype: 'gridcolumn',
                                    dataIndex: 'NFStatus',
                                    text: 'Status'
                                },
                                {
                                    xtype: 'actioncolumn',
                                    items: [
                                        {
                                            handler: function(view, rowIndex, colIndex, item, e) {
                                                var grd = Ext.ComponentQuery.query("#grdDRLTTranList")[0];

                                                var data = grd.getStore('DOfficerTranList').getAt(rowIndex);

                                                var status = data.get('RecStatus');
                                                var hdncode = Ext.ComponentQuery.query("#hdnDRTLcode")[0].getValue();

                                                if(status=="F")
                                                {
                                                    param = {'TranNo':data.get('TranNo')};//'uid' : '1234'
                                                    url="../../../Reporting/DiplomaticRefund/ReportHandlers/DiplomaticRefundReportHandler.ashx";
                                                    winOption="width=730,height=345,left=100,top=100,resizable=yes,scrollbars=yes";
                                                    OpenWindowWithPost(url,winOption,"NewFile", param);
                                                }
                                                else if(status=="V")
                                                {
                                                    param = {'OfficeCode':hdncode,'TranNo':data.get('TranNo')};//'uid' : '1234'
                                                    url="../../../Reporting/DiplomaticRefund/ReportHandlers/DipRefundListStatusReportHandler.ashx";
                                                    winOption="width=730,height=345,left=100,top=100,resizable=yes,scrollbars=yes";
                                                    OpenWindowWithPost(url,winOption,"NewFile", param);
                                                }
                                                else
                                                {
                                                    msg("WARNING","The transaction should be finalized to perform print operation");
                                                }
                                            },
                                            icon: '../ITS/resources/images/icons/print.png',
                                            iconCls: 'iconMargin',
                                            tooltip: 'Click to Print'
                                        }
                                    ]
                                }
                            ],
                            dockedItems: [
                                {
                                    xtype: 'hiddenfield',
                                    dock: 'left',
                                    id: 'hdnDRTLuser',
                                    itemId: 'hdnDRTLuser',
                                    fieldLabel: 'Label'
                                }
                            ]
                        },
                        {
                            xtype: 'hiddenfield',
                            id: 'hdnDRTLaction',
                            itemId: 'hdnDRTLaction',
                            fieldLabel: 'Label'
                        },
                        {
                            xtype: 'hiddenfield',
                            id: 'hdnDRTLcode',
                            itemId: 'hdnDRTLcode',
                            fieldLabel: 'Label'
                        }
                    ]
                }
            ]
        });

        me.callParent(arguments);
    }

});