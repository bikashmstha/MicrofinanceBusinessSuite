/*
 * File: app/controller/TaxPayerLoginWithPan.js
 *
 * This file was generated by Sencha Architect version 2.2.3.
 * http://www.sencha.com/products/architect/
 *
 * This file requires use of the Ext JS 4.1.x library, under independent license.
 * License of Sencha Architect does not include license for Ext JS 4.1.x. For more
 * details see http://www.sencha.com/license or contact license@sencha.com.
 *
 * This file will be auto-generated each and everytime you save your project.
 *
 * Do NOT hand edit this file.
 */

Ext.define('MyApp.controller.TaxPayerLoginWithPan', {
    extend: 'Ext.app.Controller',

    onTPLWithPan_btnLoginClick: function(button, e, eOpts) {
        var pan=Ext.ComponentQuery.query('#TPLWithPan_txtPan')[0].getValue();
        var userName=Ext.ComponentQuery.query('#TPLWithPan_txtUserName')[0].getValue();
        var password=Ext.ComponentQuery.query('#TPLWithPan_txtPassword')[0].getValue();
        var form=Ext.ComponentQuery.query("#frmTaxPayerLoginWithPan")[0].getForm();



        if(!form.isValid())
        {
            msg("WARNING","Enter Required  Fields");
            return false;
        }


        Ext.Ajax.request({
            url:"../Handlers/E-SystemServices/Taxpayer/TaxPayerValidLoginHandler.ashx",

            params: {
                pan:pan,
                TPName:userName,
                TPPassword:password

            },
            success: function(response){

                var resp=Ext.decode(response.responseText);
                if(resp.success==='True')
                {
                    var uiConfig='';
                    if(userName==password)
                    {
                        uiConfig = {menuLink:'ChangeTaxpayerLoginUserPass',pageTitle:'TaxpayerLoginUserPassword'};
                        DynamicUI(uiConfig,function(){

                            Ext.ComponentQuery.query("#txtChangeTaxpayerLoginPan")[0].setValue(pan);
                            Ext.ComponentQuery.query('#txtChangeTaxpayerLoginPan')[0].setReadOnly(true);
                            Ext.ComponentQuery.query('#txtChangeTaxpayerLoginUserName')[0].setValue(userName);
                            Ext.ComponentQuery.query('#txtChangeTaxpayerLoginUserName')[0].setReadOnly(true);
                            Ext.ComponentQuery.query("#txtChangeTaxpayerLoginOldPassWord")[0].setValue(password);
                            Ext.ComponentQuery.query('#txtChangeTaxpayerLoginOldPassWord')[0].setReadOnly(true);
                        });

                    }
                    else
                    {        
                        uiConfig = {menuLink:'TaxPayerVerification',pageTitle:'TaxPayer Verification'};
                        DynamicUI(uiConfig,function(){


                        });
                    }



                }

                if(resp.success === "False")
                {
                    msg("FAILURE",resp.message);
                    return;
                }

            },
            failure: function ( result, request ){



                msg("FAILURE","Login Failed !!!");
                return;
            }
        });
    },

    onTPLWithPan_btnCancelClick: function(button, e, eOpts) {
        Ext.ComponentQuery.query('#TPLWithPan_txtPan')[0].reset();
        Ext.ComponentQuery.query('#TPLWithPan_txtPan')[0].focus();
        Ext.ComponentQuery.query('#TPLWithPan_txtUserName')[0].reset();
        Ext.ComponentQuery.query('#TPLWithPan_txtPassword')[0].reset();
    },

    init: function(application) {
        this.control({
            "#TPLWithPan_btnLogin": {
                click: this.onTPLWithPan_btnLoginClick
            },
            "#TPLWithPan_btnCancel": {
                click: this.onTPLWithPan_btnCancelClick
            }
        });
    }

});
