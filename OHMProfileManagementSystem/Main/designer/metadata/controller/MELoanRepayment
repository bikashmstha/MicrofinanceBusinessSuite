{
    "type": "Ext.app.Controller",
    "reference": {
        "name": "items",
        "type": "array"
    },
    "codeClass": null,
    "userConfig": {
        "designer|userClassName": "MELoanRepayment",
        "stores": [
            "MELoanProductStore",
            "MeLoanRepayStore",
            "MEFieldAssistantStore",
            "ContraAccountStore",
            "MELoanSearchStore",
            "MeLoanRepaymentDetailsStore"
        ]
    },
    "configAlternates": {
        "designer|userClassName": "string",
        "stores": "typedarray"
    },
    "name": "MyController",
    "designerId": "f3678d77-9a2f-4b27-a97d-ce27d2465815",
    "cn": [
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "#frm-MELoanRepayment",
                "designer|params": [
                    "component",
                    "eOpts"
                ],
                "designer|targetType": "MyForm14",
                "fn": "onFrmMELoanRepaymentAfterRender",
                "implHandler": [
                    "Ext.ComponentQuery.query('#txtPaymentDateAD')[0].setValue(getMisDateAD());",
                    "Ext.ComponentQuery.query('#txtPaymentDateBS')[0].setValue(getMisDateBS());",
                    "var productName ='';",
                    "",
                    "        Ext.Ajax.request({",
                    "            url: '../Handlers/Finance/Transaction/LoanTransaction/MeLoanProductHandler.ashx',",
                    "            params: {",
                    "                method:'GetMeLoanProduct'",
                    "            },",
                    "            success: function(response){",
                    "",
                    "            var data=Ext.decode(response.responseText);",
                    "            var meLoanProductStore=Ext.getStore('MELoanProductStore');",
                    "            meLoanProductStore.removeAll();",
                    "            meLoanProductStore.add(data.root);",
                    "",
                    "",
                    "        }",
                    "        });",
                    "var empName ='';",
                    "",
                    "",
                    "        Ext.Ajax.request({",
                    "            url: '../Handlers/Supervisor/EmployeeHandler.ashx',",
                    "            params: {",
                    "                method:'GetFieldAssistants',",
                    "                officeCode:getOfficeCode(),empName:empName",
                    "            },",
                    "            success: function(response){",
                    "",
                    "            var data=Ext.decode(response.responseText);",
                    "            var meFieldAssistantStore=Ext.getStore('MEFieldAssistantStore');",
                    "            meFieldAssistantStore.removeAll();",
                    "            meFieldAssistantStore.add(data.root);",
                    "",
                    "",
                    "        }",
                    "        });",
                    " Ext.Ajax.request({",
                    "                     url: '../Handlers/Finance/Maintenance/AccountHeadEntryHandler.ashx',",
                    "                    params: {",
                    "                        method:'GetContraAccount',",
                    "                         offCode:getOfficeCode()",
                    "",
                    "                    },",
                    "                    success: function(response){",
                    "",
                    "                        var data=Ext.decode(response.responseText);",
                    "                        var contraAccountStore =Ext.getStore('ContraAccountStore');",
                    "                        contraAccountStore.removeAll();",
                    "                        contraAccountStore.add(data.root);",
                    "",
                    "                    }",
                    "                });",
                    "",
                    "Ext.Ajax.request({",
                    "                     url: '../Handlers/Finance/Transaction/LoanTransaction/MeLoanRepayHandler.ashx',",
                    "                    params: {",
                    "                        method:'GetMeLoanRepaySearch',",
                    "                         offCode:getOfficeCode(),clientName:''",
                    "",
                    "                    },",
                    "                    success: function(response){",
                    "",
                    "                        var data=Ext.decode(response.responseText);",
                    "                        var meLoanSearchStore =Ext.getStore('MELoanSearchStore');",
                    "                        meLoanSearchStore.removeAll();",
                    "                        meLoanSearchStore.add(data.root);",
                    "",
                    "                    }",
                    "                });",
                    "",
                    "",
                    "",
                    "",
                    ""
                ],
                "name": "afterrender",
                "scope": "me"
            },
            "configAlternates": {
                "fn": "string",
                "name": "string",
                "scope": "string",
                "designer|controlQuery": "string",
                "designer|params": "typedarray",
                "designer|targetType": "view",
                "implHandler": "code"
            },
            "name": "onFrmMELoanRepaymentAfterRender",
            "designerId": "2261c85d-c7b2-4d39-b72f-a0fa0bf54d83"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "#ddlLoanProductCode",
                "designer|params": [
                    "field",
                    "newValue",
                    "oldValue",
                    "eOpts"
                ],
                "designer|targetType": "MyComboBox40",
                "fn": "onDdlLoanProductCodeChange",
                "implHandler": [
                    "var productCode = Ext.ComponentQuery.query(\"#ddlLoanProductCode\")[0].getValue();",
                    "var clientName='';",
                    "",
                    "Ext.Ajax.request({",
                    "                    url: '../Handlers/Finance/Transaction/LoanTransaction/MeLoanRepayHandler.ashx',",
                    "                    params: {",
                    "                        method:'GetMeLoanRepay',",
                    "                        offCode:getOfficeCode(),productCode:productCode,clientName:clientName",
                    "                    },",
                    "                    success: function(response){",
                    "",
                    "                    var data=Ext.decode(response.responseText);",
                    "                    var meLoanRepayStore=Ext.getStore('MeLoanRepayStore');",
                    "                    meLoanRepayStore.removeAll();",
                    "                    meLoanRepayStore.add(data.root);",
                    "                    }",
                    "});",
                    "",
                    ""
                ],
                "name": "change",
                "scope": "me"
            },
            "configAlternates": {
                "fn": "string",
                "name": "string",
                "scope": "string",
                "designer|controlQuery": "string",
                "designer|params": "typedarray",
                "designer|targetType": "view",
                "implHandler": "code"
            },
            "name": "onDdlLoanProductCodeChange",
            "designerId": "ddc64e35-caf2-4a83-8c72-6599e29f1b30"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "#btnSearch",
                "designer|params": [
                    "button",
                    "e",
                    "eOpts"
                ],
                "designer|targetType": "MyButton38",
                "fn": "onBtnSearchClick",
                "implHandler": [
                    "var repaymentNo = Ext.ComponentQuery.query(\"#ddlLoanProductCode\")[0].getValue();",
                    "var clientName='';",
                    "var loanDno=Ext.ComponentQuery.query(\"#ddlLoanNoS\")[0].getValue();",
                    "var dateFrom=Ext.ComponentQuery.query(\"#txtPaymentDateBSS\")[0].getValue();",
                    "var dateTo='';",
                    "",
                    "",
                    "        Ext.Ajax.request({",
                    "                            url: '../Handlers/Finance/Transaction/LoanTransaction/MeLoanRepayDetailHandler.ashx',",
                    "                            params: {",
                    "                                method:'GetMeLoanRepayDetail',",
                    "                                offCode:getOfficeCode(),clientName:clientName,loanDno:loanDno,dateFrom:dateFrom,dateTo:dateTo",
                    "                            },",
                    "                            success: function(response){",
                    "",
                    "                            var data=Ext.decode(response.responseText);",
                    "                            var meLoanRepaymentDetailsStore=Ext.getStore('MeLoanRepaymentDetailsStore');",
                    "                            meLoanRepaymentDetailsStore.removeAll();",
                    "                            meLoanRepaymentDetailsStore.add(data.root);",
                    "                            }",
                    "        });"
                ],
                "name": "click",
                "scope": "me"
            },
            "configAlternates": {
                "fn": "string",
                "name": "string",
                "scope": "string",
                "designer|controlQuery": "string",
                "designer|params": "typedarray",
                "designer|targetType": "view",
                "implHandler": "code"
            },
            "name": "onBtnSearchClick",
            "designerId": "ef64127b-99ba-4e00-aca4-09ae7f59946d"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "#btnLoanRepayment",
                "designer|params": [
                    "button",
                    "e",
                    "eOpts"
                ],
                "designer|targetType": "MyButton37",
                "fn": "onBtnLoanRepaymentClick",
                "implHandler": [
                    "var loanNo=Ext.ComponentQuery.query('#ddlLoanNo')[0].getValue();",
                    "var paymentDate=Ext.ComponentQuery.query('#txtPaymentDateBS')[0].getValue();",
                    "var paidAmt=Ext.ComponentQuery.query('#txtPastPrinciple')[0].getValue();",
                    "var totalBalance=Ext.ComponentQuery.query('#ddlLoanNo')[0].getValue();",
                    "var totalPrincileOutStanding=Ext.ComponentQuery.query('#ddlLoanNo')[0].getValue();",
                    "var pastPrincipalDue=Ext.ComponentQuery.query('#ddlLoanNo')[0].getValue();",
                    "var currentPrincipalSchedule=Ext.ComponentQuery.query('#ddlLoanNo')[0].getValue();",
                    "var pastInterestDue=Ext.ComponentQuery.query('#ddlLoanNo')[0].getValue();",
                    "var interestAmt=Ext.ComponentQuery.query('#txtCurrentInterest')[0].getValue();",
                    "var penaltyAmt=Ext.ComponentQuery.query('#ddlLoanNo')[0].getValue();",
                    "var principalPaidAmt=Ext.ComponentQuery.query('#ddlLoanNo')[0].getValue();",
                    "var interestPaidAmt=Ext.ComponentQuery.query('#ddlLoanNo')[0].getValue();",
                    "var penaltyPaidAmt=Ext.ComponentQuery.query('#ddlLoanNo')[0].getValue();",
                    "var adjustFromSaving=Ext.ComponentQuery.query('#ddlLoanNo')[0].getValue();",
                    "var savingAccountNo=Ext.ComponentQuery.query('#ddlLoanNo')[0].getValue();",
                    "var contralAccount=Ext.ComponentQuery.query('#ddlContraAccount')[0].getValue();",
                    "var voucherNo=Ext.ComponentQuery.query('#txtChequeNo')[0].getValue();",
                    "var employeeId=Ext.ComponentQuery.query('#ddlLoanNo')[0].getValue();",
                    "var totalPrincipalPaidAmt=Ext.ComponentQuery.query('#ddlLoanNo')[0].getValue();",
                    "var totalInterestPaidAmt=Ext.ComponentQuery.query('#ddlLoanNo')[0].getValue();",
                    "var totalInterestPaidAmt=Ext.ComponentQuery.query('#ddlLoanNo')[0].getValue();",
                    "var remarks=Ext.ComponentQuery.query('#ddlLoanNo')[0].getValue();",
                    "var tranOfficeCode=Ext.ComponentQuery.query('#ddlLoanNo')[0].getValue();",
                    "var user=Ext.ComponentQuery.query('#ddlLoanNo')[0].getValue();",
                    "var fiscalYear=Ext.ComponentQuery.query('#ddlLoanNo')[0].getValue();",
                    "var loanRepaymentNo=Ext.ComponentQuery.query('#ddlLoanNo')[0].getValue();",
                    "",
                    " var objmeLoanRepayment={",
                    "        \t\t        LoanNo:loanNo,",
                    "                        PaymentDate:paymentDate,",
                    "                        PaidAmount:paidAmt,",
                    "                        TotalBalance:totalBalance,",
                    "                        TotalPrincipalOutstanding:totalPrincileOutStanding,",
                    "                        PastPrincipalDue:loanNo,",
                    "                        CurrentPrincipalSchedule:loanNo,",
                    "                        PastInterestDue:loanNo,",
                    "                        InterestAmount:loanNo,",
                    "                        PenaltyAmount:loanNo,",
                    "                        PrincipalPaidAmount:loanNo,",
                    "                        InterestPaidAmount:loanNo,",
                    "                        PenaltyPaidAmount:loanNo,",
                    "                        AdjustFromSaving:loanNo,",
                    "                        SavingAccountNo:loanNo,",
                    "                        ContraAccount:loanNo,",
                    "                        VoucherNo:voucherNo,",
                    "                        EmployeeId:loanNo,",
                    "                        TotalPrincipalPaidAmount:loanNo,",
                    "        \t\t\t\tTotalInterestPaidAmount:loanNo,",
                    "                        TotalPenaltyPaidAmount:loanNo,",
                    "                        Remarks:loanNo,",
                    "                        TranOfficeCode:tranOfficeCode,",
                    "                        User1:user,",
                    "                        Action:loanNo,",
                    "                        OutFiscalYear:fiscalYear,",
                    "                        OutLoanRepaymentNo:loanRepaymentNo};",
                    "         Ext.Ajax.request",
                    "                ({",
                    "                    method: 'POST',",
                    "                    url: '../Handlers/Finance/Transaction/LoanTransaction/MfLoanRepaymentHandler.ashx?method=SaveLoanRepayment',",
                    "                    params:{mfLoanRepayment:JSON.stringify(objmeLoanRepayment)},",
                    "",
                    "                    waitMsg: 'Please wait',",
                    "                    success: function(result, request) {",
                    "                        wait.hide();",
                    "                        var obj = Ext.decode(result.responseText);",
                    "                        if (obj.success != \"true\")",
                    "                        {",
                    "                            showMessage('ERROR OCURRED !!!',obj.message);",
                    "                        }",
                    "                        else",
                    "                        {",
                    "                            showMessage('INFO','Saved successfully ');",
                    "",
                    "",
                    "                        }",
                    "                    },",
                    "                    failure: function(result, request) {",
                    "                        wait.hide();",
                    "                        var obj = Ext.decode(result.responseText);",
                    "",
                    "                        msg(\"FAILURE\",\"Cannot be saved successfully\");",
                    "                        return;",
                    "                    }",
                    "                });",
                    "",
                    "",
                    "",
                    "",
                    "",
                    "",
                    ""
                ],
                "name": "click",
                "scope": "me"
            },
            "configAlternates": {
                "fn": "string",
                "name": "string",
                "scope": "string",
                "designer|controlQuery": "string",
                "designer|params": "typedarray",
                "designer|targetType": "view",
                "implHandler": "code"
            },
            "name": "onBtnLoanRepaymentClick",
            "designerId": "a89909be-634a-4780-9f29-a97d86e51de1"
        }
    ]
}