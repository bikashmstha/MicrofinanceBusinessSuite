/*
 * File: app/controller/SundryTransaction.js
 *
 * This file was generated by Sencha Architect version 2.2.3.
 * http://www.sencha.com/products/architect/
 *
 * This file requires use of the Ext JS 4.1.x library, under independent license.
 * License of Sencha Architect does not include license for Ext JS 4.1.x. For more
 * details see http://www.sencha.com/license or contact license@sencha.com.
 *
 * This file will be auto-generated each and everytime you save your project.
 *
 * Do NOT hand edit this file.
 */

Ext.define('MyApp.controller.SundryTransaction', {
    extend: 'Ext.app.Controller',

    models: [
        'SundryTransactions'
    ],
    stores: [
        'SundryTransactions',
        'SundryAccount',
        'Paidto'
    ],
    views: [
        'SundryTransaction'
    ],

    onBtnSaveSTClick: function(button, e, eOpts) {

        this.save("I");
        /*

        var  txtSundryAmountST=Ext.ComponentQuery.query('#txtSundryAmountST')[0].getValue();
        if(txtSundryAmountST.getValue() === "")
        {
        msg("WARNING","Please fill Sundry Amount");
        return;
        }

        var panST=Ext.ComponentQuery.query('#txtPanST')[0];
        if(panST.getValue() === "")
        {
        msg("WARNING","Please fill Pan");
        return;
        }

        var acctTypST=Ext.ComponentQuery.query('#txtAcctTypST')[0];
        if(acctTypST.getValue() === "")
        {
        msg("WARNING","Please fill Acct Type");
        return;
        }

        var sundryDateST=Ext.ComponentQuery.query('#txtSundryDateST')[0];
        if(sundryDateST.getValue() === "")
        {
        msg("WARNING","Please fill sundry Date");
        return;
        }

        var sundrySeqNoST=Ext.ComponentQuery.query('#txtSundrySeqNoST')[0];
        if(sundrySeqNoST.getValue() === "")
        {
        msg("WARNING","Please fill sundry Seq No ");
        return;
        }

        var transferDateST=Ext.ComponentQuery.query('#txtTransferDateST')[0];
        if(transferDateST.getValue() === "")
        {
        msg("WARNING","Please fill Transfer Date ");
        return;
        }

        var transferSeqNoST=Ext.ComponentQuery.query('#txtTransferSeqNoST')[0];
        if(transferSeqNoST.getValue() === "")
        {
        msg("WARNING","Please fill TransferSeq No  ");
        return;
        }

        var transferAmountST=Ext.ComponentQuery.query('#txtTransferAmountST')[0];
        if(transferAmountST.getValue() === "")
        {
        msg("WARNING","Please fill Transfer Amount  ");
        return;
        }

        var paidToST=Ext.ComponentQuery.query('#txtPaidToST')[0];
        if(paidToST.getValue() === "-------select------")
        {
        msg("WARNING","Please select paid To   ");
        return;
        }

        */

        var paidToST=Ext.ComponentQuery.query('#txtPaidToST')[0];
        if(paidToST.getValue() === "")
        {
            msg("WARNING","Please select paid To   ");
            return;
        }


    },

    onBtnEditSTClick: function(button, e, eOpts) {
        var transferSeqNoST= Ext.ComponentQuery.query('#txtTransferSeqNoST')[0];



        Ext.ComponentQuery.query('#lblMessageAD')[0].show(true);
        Ext.ComponentQuery.query('#imgMessage')[0].show(true);


        if(transferSeqNoST.disable(true))
        {
            transferSeqNoST.enable(true);
        } 

        if(transferSeqNoST.getValue() === "" || transferSeqNoST.getValue() === null)
        {
            msg("WARNING","Please fill Transfer Seq No");
            Ext.ComponentQuery.query('#btnEditST')[0].setText('Update');
            Ext.ComponentQuery.query('#btnSaveST')[0].disable(true);
            Ext.ComponentQuery.query('#btnVerifyST')[0].disable(true);




            return;
        }
        else
        {
            this.save("I");
        }


    },

    onBtnCancelSTClick: function(button, e, eOpts) {
        Ext.ComponentQuery.query('#imgMessage')[0].hide(true);
        Ext.ComponentQuery.query('#lblMessageAD')[0].hide(true);
        Ext.ComponentQuery.query('#hdnActionST')[0].setValue('');

        Ext.ComponentQuery.query('#txtPanST')[0].setValue('');
        Ext.ComponentQuery.query('#txtTradeNameST')[0].setValue('');
        Ext.ComponentQuery.query('#txtSundryDateST')[0].setValue('');
        Ext.ComponentQuery.query('#txtSundrySeqNoST')[0].setValue('');
        Ext.ComponentQuery.query('#txtTaxyearST')[0].setValue('');
        Ext.ComponentQuery.query('#txtFilingPeriodST')[0].setValue('');
        Ext.ComponentQuery.query('#txtPeriodST')[0].setValue('');
        Ext.ComponentQuery.query('#txtSundryAmountST')[0].setValue('');
        Ext.ComponentQuery.query('#txtTransferredAmountST')[0].setValue('');
        Ext.ComponentQuery.query('#txtTransferDateST')[0].setValue('');
        Ext.ComponentQuery.query('#txtTransferSeqNoST')[0].setValue('');
        Ext.ComponentQuery.query('#txtTransferSeqNoST')[0].disable(true);


        Ext.ComponentQuery.query('#txtTransferAmountST')[0].setValue('');
        Ext.ComponentQuery.query('#txtPaidToST')[0].setValue('-------select------');

        Ext.ComponentQuery.query('#btnSaveST')[0].enable(true);
        Ext.ComponentQuery.query('#btnEditST')[0].enable(true);
        Ext.ComponentQuery.query('#btnDeleteST')[0].enable(true);
        Ext.ComponentQuery.query('#btnSubmitST')[0].enable(true);
        Ext.ComponentQuery.query('#btnVerifyST')[0].disable(true);
        Ext.ComponentQuery.query('#btnPrintST')[0].disable(true);

        Ext.ComponentQuery.query('#btnEditST')[0].setText('Edit');



        Ext.ComponentQuery.query('#txtPanST')[0].setReadOnly(false);
        Ext.ComponentQuery.query('#txtTradeNameST')[0].setReadOnly(true);
        Ext.ComponentQuery.query('#txtSundryDateST')[0].setReadOnly(false);
        Ext.ComponentQuery.query('#txtSundrySeqNoST')[0].setReadOnly(false);
        Ext.ComponentQuery.query('#txtTaxyearST')[0].setReadOnly(true);
        Ext.ComponentQuery.query('#txtFilingPeriodST')[0].setReadOnly(true);
        Ext.ComponentQuery.query('#txtPeriodST')[0].setReadOnly(true);
        Ext.ComponentQuery.query('#txtSundryAmountST')[0].setReadOnly(true);
        Ext.ComponentQuery.query('#txtTransferredAmountST')[0].setReadOnly(true);
        Ext.ComponentQuery.query('#txtTransferDateST')[0].setReadOnly(false);
        Ext.ComponentQuery.query('#txtTransferSeqNoST')[0].setReadOnly(true);
        Ext.ComponentQuery.query('#txtTransferAmountST')[0].setReadOnly(false);
        Ext.ComponentQuery.query('#txtPaidToST')[0].setReadOnly(false);

















        var storeSA=Ext.ComponentQuery.query('#grdST')[0].getStore();
        storeSA.removeAll();
















    },

    onBtnSubmitSTClick: function(button, e, eOpts) {

        var me = this;


        var  txtSundryAmountST=Ext.ComponentQuery.query('#txtSundryAmountST')[0].getValue();
        var  txtTransferredAmountST=Ext.ComponentQuery.query('#txtTransferredAmountST')[0].getValue();


        var panST=Ext.ComponentQuery.query('#txtPanST')[0];
        var acctTypST=Ext.ComponentQuery.query('#txtAcctTypST')[0];
        var sundryDateST=Ext.ComponentQuery.query('#txtSundryDateST')[0];
        var sundrySeqNoST=Ext.ComponentQuery.query('#txtSundrySeqNoST')[0];
        var transferDateST=Ext.ComponentQuery.query('#txtTransferDateST')[0];
        var transferSeqNoST=Ext.ComponentQuery.query('#txtTransferSeqNoST')[0];
        var transferAmountST=Ext.ComponentQuery.query('#txtTransferAmountST')[0];
        var paidToST=Ext.ComponentQuery.query('#txtPaidToST')[0];
        var hdnActionST=Ext.ComponentQuery.query('#hdnActionST')[0];
        var hdnStatusST=Ext.ComponentQuery.query('#hdnStatusST')[0];
        var hdnUserId=Ext.ComponentQuery.query('#UserId')[0];
        var txtOffcodeST=Ext.ComponentQuery.query('#txtOffcodeST')[0];



        if(txtOffcodeST.getValue() === "")
        {
            msg("WARNING","Please Reload page again !!!");
            return;
        }
        if(panST.getValue() === "")
        {
            msg("WARNING","Please fill PAN !!!");
            return;
        }


        if(acctTypST.getValue() === "")
        {
            msg("WARNING","Please Reload page again !!!");
            return;
        }

        if(sundryDateST.getValue() === "")
        {
            msg("WARNING","Please fill sundry Date !!!");
            return;
        }


        if(sundrySeqNoST.getValue() === "")
        {
            msg("WARNING","Please fill sundry Seq No !!! ");
            return;
        }


        if(transferDateST.getValue() === "")
        {
            msg("WARNING","Please fill Transfer Date !!!");
            return;
        }


        //if(transferSeqNoST.getValue() === "")
        //{
        //msg("WARNING","Please fill Transfer_Amount and select  Paid_To");
        //return;
        //}


        if(transferAmountST.getValue() === "")
        {
            msg("WARNING","Please fill Transfer_Amount !!! ");
            return;
        }


        if(paidToST.getValue()==="" || paidToST.getValue()===null)
        {
            msg("WARNING","Please select  Paid_To !!!");
            return;
        }










        Ext.Msg.confirm('Confirm Action', 'एकपटक Submit गरिसकेपछि अर्को पटक विवरण फेरि परिवर्तन गर्न पइने छैन्। \n के तपाई Submit गर्न चाहनुहन्छ ?', function(btn) {
            if(btn == 'yes'){

                me.save("F");
                var btnSaveST=Ext.ComponentQuery.query('#btnSaveST')[0];
                btnSaveST.disable(true);

                var btnEditST=Ext.ComponentQuery.query('#btnEditST')[0];
                btnEditST.disable(true);

                //var btnSubmitST=Ext.ComponentQuery.query('#btnSubmitST')[0];
                // btnSubmitST.disable(true);




                return true;
            }
        }, this);
    },

    onBtnDeleteSTClick: function(button, e, eOpts) {

        var me = this;


        var  txtSundryAmountST=Ext.ComponentQuery.query('#txtSundryAmountST')[0].getValue();
        var  txtTransferredAmountST=Ext.ComponentQuery.query('#txtTransferredAmountST')[0].getValue();


        var panST=Ext.ComponentQuery.query('#txtPanST')[0];
        var acctTypST=Ext.ComponentQuery.query('#txtAcctTypST')[0];
        var sundryDateST=Ext.ComponentQuery.query('#txtSundryDateST')[0];
        var sundrySeqNoST=Ext.ComponentQuery.query('#txtSundrySeqNoST')[0];
        var transferDateST=Ext.ComponentQuery.query('#txtTransferDateST')[0];
        var transferSeqNoST=Ext.ComponentQuery.query('#txtTransferSeqNoST')[0];
        var transferAmountST=Ext.ComponentQuery.query('#txtTransferAmountST')[0];
        var paidToST=Ext.ComponentQuery.query('#txtPaidToST')[0];
        var hdnActionST=Ext.ComponentQuery.query('#hdnActionST')[0];
        var hdnStatusST=Ext.ComponentQuery.query('#hdnStatusST')[0];
        var hdnUserId=Ext.ComponentQuery.query('#UserId')[0];
        var txtOffcodeST=Ext.ComponentQuery.query('#txtOffcodeST')[0];



        if(txtOffcodeST.getValue() === "")
        {
            msg("WARNING","Please Reload page again !!!");
            return;
        }
        if(panST.getValue() === "")
        {
            msg("WARNING","Please fill PAN !!!");
            return;
        }


        if(acctTypST.getValue() === "")
        {
            msg("WARNING","Please Reload page again !!!");
            return;
        }

        if(sundryDateST.getValue() === "")
        {
            msg("WARNING","Please fill sundry Date !!!");
            return;
        }


        if(sundrySeqNoST.getValue() === "")
        {
            msg("WARNING","Please fill sundry Seq No !!! ");
            return;
        }


        if(transferDateST.getValue() === "")
        {
            msg("WARNING","Please fill Transfer Date !!!");
            return;
        }


        //if(transferSeqNoST.getValue() === "")
        //{
        //msg("WARNING","Please fill Transfer_Amount and select  Paid_To");
        //return;
        //}


        if(transferAmountST.getValue() === "")
        {
            msg("WARNING","Please fill Transfer_Amount !!! ");
            return;
        }


        if(paidToST.getValue()==="" || paidToST.getValue()===null)
        {
            msg("WARNING","Please select  Paid_To !!!");
            return;
        }






        Ext.Msg.confirm('Confirm Action', 'एकपटक DELETE गरिसकेपछि अर्को पटक विवरण उपलव्द हुने छैन्। \n के तपाई DELETE गर्न चाहनुहन्छ ?', function(btn) {
            if(btn == 'yes'){

                me.save("D");
                var btnSaveST=Ext.ComponentQuery.query('#btnSaveST')[0];
                btnSaveST.disable(true);

                var btnEditST=Ext.ComponentQuery.query('#btnEditST')[0];
                btnEditST.disable(true);

                var btnSubmitST=Ext.ComponentQuery.query('#btnSubmitST')[0];
                btnSubmitST.disable(true);

                // var btnDeleteST=Ext.ComponentQuery.query('#btnDeleteST')[0];
                // btnDeleteST.disable(true);

                var btnVerifyST=Ext.ComponentQuery.query('#btnVerifyST')[0];
                btnVerifyST.disable(true);

                return true;
            }
        }, this);
    },

    onBtnVerifySTClick: function(button, e, eOpts) {

        var me = this;

        Ext.Msg.confirm('Confirm Action', 'एकपटक Verify गरिसकेपछि अर्को पटक विवरण फेरि परिवर्तन गर्न पइने छैन्। \n के तपाई Verify गर्न चाहनुहन्छ ?', function(btn) {
            if(btn == 'yes'){

                me.save("V");
                var btnSaveST=Ext.ComponentQuery.query('#btnSaveST')[0];
                btnSaveST.disable(true);

                var btnEditST=Ext.ComponentQuery.query('#btnEditST')[0];
                btnEditST.disable(true);

                var btnDeleteST=Ext.ComponentQuery.query('#btnDeleteST')[0];
                btnDeleteST.disable(true);

                var btnSubmitST=Ext.ComponentQuery.query('#btnSubmitST')[0];
                btnSubmitST.disable(true);

                //var btnVerifyST=Ext.ComponentQuery.query('#btnVerifyST')[0];
                // btnVerifyST.disable(true);


                return true;
            }
        }, this);
    },

    onSundryTransactionAfterRender: function(component, eOpts) {
        //if(Ext.ComponentQuery.query('#txtOffcodeST')[0].getValue()==="")
        //{
        //msg("WARNING","Please Reload your page again");
        //}

        Ext.ComponentQuery.query('#btnPrintST')[0].disable(true);
        Ext.ComponentQuery.query('#lblMessageAD')[0].hide(true);
        Ext.ComponentQuery.query('#imgMessage')[0].hide(true);
        //Ext.ComponentQuery.query('#btnEditST')[0].disable(true);
        Ext.ComponentQuery.query('#btnVerifyST')[0].disable(true);

        var offCode = Ext.get('offCode').dom.innerHTML;
        Ext.ComponentQuery.query('#txtOffcodeST')[0].setValue(offCode);
        Ext.ComponentQuery.query("#txtAcctTypST")[0].setValue('00');




        var strSundryAccount=Ext.getStore('SundryAccount');
        strSundryAccount.removeAll();





        GetNepaliDate(function(nepaliDate){
            Ext.ComponentQuery.query('#txtTransferDateST')[0].setValue(nepaliDate);

        });





    },

    onTxtPanSTBlur: function(component, e, eOpts) {
        if(Ext.ComponentQuery.query('#txtPanST')[0]==="" || Ext.ComponentQuery.query('#txtPanST')[0]===null)
        {
            msg("WARNING","Please fill PAN");
        }

        this.checkValidatePan();

        /*



        //this.clearControls("Pan");

        //var isValid = false;
        var panno=Ext.ComponentQuery.query('#txtPanST')[0].getValue();
        var txtAcctTypST=Ext.ComponentQuery.query('#txtAcctTypST')[0].getValue();   
        var txtTradeNameST=Ext.ComponentQuery.query('#txtTradeNameST')[0];


        if(txtPanRebate.getValue() === "")
        {
            //  msg("WARNING","Please Enter PAN !!!");
            return;
        }


        LoadTaxpayerInfoWithValidPan(panno,txtAcctTypST,function(data){


            var rec = data.root.Taxpayer;
            var addr = rec.BusinessAddress.Address;
            var office = rec.Office;
            console.log(office.OfficeCode);

            //console.log('rec new',rec);

            txtTradeNameST.setValue(rec.Name);


            //txtRebateOfficeCode.setValue(office.OfficeCode);
            //txtRebateOfficeCode.setReadOnly(true);

            // hdnRebateregistrationDate.setValue(rec.RegistrationDate);


        });


        */
    },

    onTxtPanSTKeypress: function(textfield, e, eOpts) {
        if(e.keyCode === 13)
        {
            this.checkValidatePan();  
            Ext.ComponentQuery.query('#btnEditST')[0].enable(true);

        }

    },

    onTxtTransferAmountSTBlur: function(component, e, eOpts) {


        var transferAmountST=Ext.ComponentQuery.query('#txtTransferAmountST')[0];


        /*
        if(transferAmountST.getValue() === "")
        {
        msg("WARNING","Please fill Transfer_Amount-Test ");
        return;
        }
        */

        var  txtTransferredAmountST=Ext.ComponentQuery.query('#txtTransferredAmountST')[0].getValue();

        var  txtTransferAmountST=Ext.ComponentQuery.query('#txtTransferAmountST')[0].getValue();
        var  a=txtSundryAmountST-txtTransferredAmountST;
        if(txtTransferAmountST > a)
        {
            msg("WARNING","CHECK TransferAmount ");
            return;
        }
    },

    onTxtTransferDateSTBlur: function(component, e, eOpts) {
        return validateFutureDate(field.getValue(),"Y",function(){ field.focus();});

        //return validateFutureDate(field.getValue(),"Y");


    },

    save: function(status) {
        var me=this;
        var  txtSundryAmountST=Ext.ComponentQuery.query('#txtSundryAmountST')[0].getValue();
        var  txtTransferredAmountST=Ext.ComponentQuery.query('#txtTransferredAmountST')[0].getValue();


        var panST=Ext.ComponentQuery.query('#txtPanST')[0];
        var acctTypST=Ext.ComponentQuery.query('#txtAcctTypST')[0];
        var sundryDateST=Ext.ComponentQuery.query('#txtSundryDateST')[0];
        var sundrySeqNoST=Ext.ComponentQuery.query('#txtSundrySeqNoST')[0];
        var transferDateST=Ext.ComponentQuery.query('#txtTransferDateST')[0];
        var transferSeqNoST=Ext.ComponentQuery.query('#txtTransferSeqNoST')[0];
        var transferAmountST=Ext.ComponentQuery.query('#txtTransferAmountST')[0];
        var paidToST=Ext.ComponentQuery.query('#txtPaidToST')[0];
        var hdnActionST=Ext.ComponentQuery.query('#hdnActionST')[0];
        var hdnStatusST=Ext.ComponentQuery.query('#hdnStatusST')[0];
        var hdnUserId=Ext.ComponentQuery.query('#UserId')[0];
        var txtOffcodeST=Ext.ComponentQuery.query('#txtOffcodeST')[0];



        if(txtOffcodeST.getValue() === "")
        {
            msg("WARNING","Please Reload page again !!!");
            return;
        }
        if(panST.getValue() === "")
        {
            msg("WARNING","Please fill PAN !!!");
            return;
        }


        if(acctTypST.getValue() === "")
        {
            msg("WARNING","Please Reload page again !!!");
            return;
        }

        if(sundryDateST.getValue() === "")
        {
            msg("WARNING","Please fill sundry Date !!!");
            return;
        }


        if(sundrySeqNoST.getValue() === "")
        {
            msg("WARNING","Please fill sundry Seq No !!! ");
            return;
        }


        if(transferDateST.getValue() === "")
        {
            msg("WARNING","Please fill Transfer Date !!!");
            return;
        }


        //if(transferSeqNoST.getValue() === "")
        //{
        //msg("WARNING","Please fill Transfer_Amount and select  Paid_To");
        //return;
        //}


        if(transferAmountST.getValue() === "")
        {
            msg("WARNING","Please fill Transfer_Amount !!! ");
            return;
        }


        if(paidToST.getValue()==="" || paidToST.getValue()===null)
        {
            msg("WARNING","Please select  Paid_To !!!");
            return;
        }




        var  txtTransferAmountST=Ext.ComponentQuery.query('#txtTransferAmountST')[0].getValue();
        var  a=txtSundryAmountST-txtTransferredAmountST;
        if(txtTransferAmountST > a)
        {
            msg("WARNING","CHECK TransferAmount !!! ");
            return;
        }



        var sunTransactions="";
        sunTransactions={
            Pan:panST.getValue(),   
            AcctType:acctTypST.getValue(),
            EffDate:sundryDateST.getValue(),
            SeqNo:sundrySeqNoST.getValue() === ""?null:sundrySeqNoST.getValue(),
            TranDate:transferDateST.getValue(),
            StDate:transferDateST.getValue(),
            TseqNo:transferSeqNoST.getValue() === ""?null:transferSeqNoST.getValue(),
            TransferAmount:transferAmountST.getValue() === ""?null:transferAmountST.getValue(),
            TransferTo:paidToST.getValue(),
            Status:status,
            UserId:"Suresh",    
            Action:hdnActionST.getValue()

        };



        Ext.Ajax.request({

            url:'../Handlers/VAT/SundryTransaction/SundryTransactionsHandler.ashx?method=SaveSundrytransactions',
            params:{sunTran:JSON.stringify(sunTransactions)},

            success:function(result, request){
                Ext.Msg.show({
                    title:'Success',
                    msg:'Successfully Saved',
                    buttons:Ext.MessageBox.OK,
                    icon:Ext.MessageBox.INFO
                });

                me.clearControls();

                /*
                Ext.ComponentQuery.query('#txtSundryAmountST')[0].setValue('');
                Ext.ComponentQuery.query('#txtTransferredAmountST')[0].setValue('');
                Ext.ComponentQuery.query('#txtPanST')[0].setValue('');
                // Ext.ComponentQuery.query('#txtAcctTypST')[0].setValue('');
                Ext.ComponentQuery.query('#txtSundryDateST')[0].setValue('');
                Ext.ComponentQuery.query('#txtSundrySeqNoST')[0].setValue('');
                Ext.ComponentQuery.query('#txtTransferDateST')[0].setValue('');
                Ext.ComponentQuery.query('#txtTransferSeqNoST')[0].setValue('');

                Ext.ComponentQuery.query('#txtTransferAmountST')[0].setValue('');
                Ext.ComponentQuery.query('#txtPaidToST')[0].setValue('-------select------');
                Ext.ComponentQuery.query('#txtTaxyearST')[0].setValue('');
                Ext.ComponentQuery.query('#txtFilingPeriodST')[0].setValue('');
                Ext.ComponentQuery.query('#txtPeriodST')[0].setValue('');
                Ext.ComponentQuery.query('#hdnActionST')[0].setValue('');
                Ext.ComponentQuery.query('#hdnStatusST')[0].setValue('');
                Ext.ComponentQuery.query('#UserId')[0].setValue('');
                Ext.ComponentQuery.query('#txtTradeNameST')[0].setValue('');
                */
                Ext.ComponentQuery.query('#imgMessage')[0].hide(true);
                Ext.ComponentQuery.query('#lblMessageAD')[0].hide(true);
                Ext.ComponentQuery.query('#btnSaveST')[0].enable(true);

                Ext.ComponentQuery.query('#txtTransferSeqNoST')[0].disable(true);


                GetNepaliDate(function(nepaliDate){
                    Ext.ComponentQuery.query('#txtTransferDateST')[0].setValue(nepaliDate);
                });




                var storeSTs=Ext.ComponentQuery.query('#grdST')[0];
                storeSTs.removeAll();


            },

            failure:function(result, request){
                msg('ERROR OCURRED !!!', 'Error');                 
            }


        });





    },

    checkValidatePan: function() {


        var panno = Ext.ComponentQuery.query('#txtPanST')[0].getValue();
        var accType = Ext.ComponentQuery.query('#txtAcctTypST')[0].getValue(); 
        var offCode = Ext.ComponentQuery.query('#txtOffcodeST')[0].getValue();
        //alert(offCode);
        var txtTradeNameST = Ext.ComponentQuery.query('#txtTradeNameST')[0];


        LoadTaxpayerInfoWithValidPan(panno,accType,function(data){


            var rec = data.root.Taxpayer;
            var addr = rec.BusinessAddress.Address;
            var office = rec.Office;
            console.log(office.OfficeCode);

            if(rec.AcctStatus === "D")
            {
                msg("WARNING","PAN is Deactivated !!!");
                return;
            }


            if(offCode != office.OfficeCode)
            {
                msg("WARNING","PAN is not Registered in this office !!!");

                return;
            }

            txtTradeNameST.setValue(rec.Name);

        });























        /*
        ValidatePan(panno,txtAcctTypST,function(data)
        {

        });
        */
        /*

        ValidatePan(panno,txtAcctTypST,function(data)
        {
        console.log("Checking",data);
        if(data.message==='')
        {
        //return true;
    }
    else
    {       

        txtAcctTypST.focus(true,100);
        msg("INFO",data.message);
        Ext.ComponentQuery.query('#txtSundryDateST')[0].ReadOnly(true);
        //txtSundrySeqNoST

        return;


    }
    });

    */



    },

    clearControls: function() {
        Ext.ComponentQuery.query('#imgMessage')[0].hide(true);
        Ext.ComponentQuery.query('#lblMessageAD')[0].hide(true);
        Ext.ComponentQuery.query('#hdnActionST')[0].setValue('');

        Ext.ComponentQuery.query('#txtPanST')[0].setValue('');
        Ext.ComponentQuery.query('#txtTradeNameST')[0].setValue('');
        Ext.ComponentQuery.query('#txtSundryDateST')[0].setValue('');
        Ext.ComponentQuery.query('#txtSundrySeqNoST')[0].setValue('');
        Ext.ComponentQuery.query('#txtSundrySeqNoST')[0].enable(true);
        Ext.ComponentQuery.query('#txtTaxyearST')[0].setValue('');
        Ext.ComponentQuery.query('#txtFilingPeriodST')[0].setValue('');
        Ext.ComponentQuery.query('#txtPeriodST')[0].setValue('');
        Ext.ComponentQuery.query('#txtSundryAmountST')[0].setValue('');
        Ext.ComponentQuery.query('#txtTransferredAmountST')[0].setValue('');
        Ext.ComponentQuery.query('#txtTransferDateST')[0].setValue('');
        Ext.ComponentQuery.query('#txtTransferSeqNoST')[0].setValue('');
        Ext.ComponentQuery.query('#txtTransferAmountST')[0].setValue('');
        Ext.ComponentQuery.query('#txtPaidToST')[0].setValue('-------select------');
        Ext.ComponentQuery.query('#txtTransferSeqNoST')[0].disable(true);

        Ext.ComponentQuery.query('#btnEditST')[0].setText('Edit');

        Ext.ComponentQuery.query('#btnEditST')[0].enable(true);



        var storeSTs=Ext.ComponentQuery.query('#grdST')[0];
        storeSTs.removeAll();
    },

    readOnly: function() {
        Ext.ComponentQuery.query('#txtPanST')[0].setReadOnly(true);
        Ext.ComponentQuery.query('#txtTradeNameST')[0].setReadOnly(true);
        Ext.ComponentQuery.query('#txtSundryDateST')[0].setReadOnly(true);
        Ext.ComponentQuery.query('#txtSundrySeqNoST')[0].setReadOnly(true);
        Ext.ComponentQuery.query('#txtTaxyearST')[0].setReadOnly(true);
        Ext.ComponentQuery.query('#txtFilingPeriodST')[0].setReadOnly(true);
        Ext.ComponentQuery.query('#txtPeriodST')[0].setReadOnly(true);
        Ext.ComponentQuery.query('#txtSundryAmountST')[0].setReadOnly(true);
        Ext.ComponentQuery.query('#txtTransferredAmountST')[0].setReadOnly(true);
        Ext.ComponentQuery.query('#txtTransferDateST')[0].setReadOnly(true);
        Ext.ComponentQuery.query('#txtTransferSeqNoST')[0].setReadOnly(true);
        Ext.ComponentQuery.query('#txtTransferAmountST')[0].setReadOnly(true);
        Ext.ComponentQuery.query('#txtPaidToST')[0].setReadOnly(true);


    },

    init: function(application) {
        this.control({
            "#btnSaveST": {
                click: this.onBtnSaveSTClick
            },
            "#btnEditST": {
                click: this.onBtnEditSTClick
            },
            "#btnCancelST": {
                click: this.onBtnCancelSTClick
            },
            "#btnSubmitST": {
                click: this.onBtnSubmitSTClick
            },
            "#btnDeleteST": {
                click: this.onBtnDeleteSTClick
            },
            "#btnVerifyST": {
                click: this.onBtnVerifySTClick
            },
            "#SundryTransaction": {
                afterrender: this.onSundryTransactionAfterRender
            },
            "#txtPanST": {
                blur: this.onTxtPanSTBlur,
                keypress: this.onTxtPanSTKeypress
            },
            "#txtTransferAmountST": {
                blur: this.onTxtTransferAmountSTBlur
            },
            "#txtTransferDateST": {
                blur: this.onTxtTransferDateSTBlur
            }
        });
    }

});
