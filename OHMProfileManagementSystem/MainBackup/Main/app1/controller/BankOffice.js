/*
 * File: app/controller/BankOffice.js
 *
 * This file was generated by Sencha Architect version 2.1.0.
 * http://www.sencha.com/products/architect/
 *
 * This file requires use of the Ext JS 4.1.x library, under independent license.
 * License of Sencha Architect does not include license for Ext JS 4.1.x. For more
 * details see http://www.sencha.com/license or contact license@sencha.com.
 *
 * This file will be auto-generated each and everytime you save your project.
 *
 * Do NOT hand edit this file.
 */

Ext.define('MyApp.controller.BankOffice', {
    extend: 'Ext.app.Controller',

    stores: [
        'Office',
        'StrBank',
        'Branch'
    ],

    onBtnSaveBankOfficeClick: function(button, e, options) {



        var cboOffice=Ext.ComponentQuery.query('#cboOffice')[0];
        var cboBank=Ext.ComponentQuery.query('#cboBank')[0];
        var cboBranch=Ext.ComponentQuery.query('#cboBranch')[0];
        var hdnDate=Ext.ComponentQuery.query('#hdnDate')[0].getValue();

        if(cboOffice.getValue()==='' || cboOffice.getValue()===null)
        {
            msg('WARNING','Please select Office Name !!!');
            return;
        }

        else if(cboBank.getValue()==='' || cboBank.getValue()===null)
        {
            msg('WARNING','Please select Bank Name !!!');
            return;
        }

        else if(cboBranch.getValue()==='' || cboBranch.getValue()===null)
        {
            msg('WARNING','Please select Branch Name !!!');
            return;
        }

        var offBank="";

        offBank={


            OfficeCode:cboOffice.getValue()===""?null:cboOffice.getValue(),
            BankCode:cboBank.getValue(), 
            BrnCode:cboBranch.getValue(), 
            FromDate:hdnDate, 
            OBFromDate:"", 
            ToDate:"", 
            Status:'Y', 
            Action:"" 

        };




        Ext.Ajax.request({

            url:'../Handlers/Common/OfficeBanksHandler.ashx?method=SaveOfficeBanks',

            params:{officeBanks:JSON.stringify(offBank)},
            success:function(result, request)
            {

                var obj = Ext.decode(result.responseText);  
                msg(obj.success === "true" ?"SUCCESS":"FAILURE",obj.message);








                if(obj.success === "false") return;

            },

            failure:function(result, request){
                msg('ERROR OCURRED !!!', 'Error');                 
            }


        });









    },

    onBtnCancelBOClick: function(button, e, options) {
        this.clearControls();
    },

    clearControls: function() {
        var cboOffice=Ext.ComponentQuery.query('#cboOffice')[0];
        cboOffice.setValue('');

        var cboBank=Ext.ComponentQuery.query('#cboBank')[0];
        cboBank.setValue('');
        var cboBranch=Ext.ComponentQuery.query('#cboBranch')[0];
        cboBranch.setValue('');

    },

    init: function(application) {
        this.control({
            "#btnSaveBankOffice": {
                click: this.onBtnSaveBankOfficeClick
            },
            "#btnCancelBO": {
                click: this.onBtnCancelBOClick
            }
        });
    }

});
