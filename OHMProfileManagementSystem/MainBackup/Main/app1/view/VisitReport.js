/*
 * File: app/view/VisitReport.js
 *
 * This file was generated by Sencha Architect version 2.2.3.
 * http://www.sencha.com/products/architect/
 *
 * This file requires use of the Ext JS 4.1.x library, under independent license.
 * License of Sencha Architect does not include license for Ext JS 4.1.x. For more
 * details see http://www.sencha.com/license or contact license@sencha.com.
 *
 * This file will be auto-generated each and everytime you save your project.
 *
 * Do NOT hand edit this file.
 */

Ext.define('MyApp.view.VisitReport', {
    extend: 'Ext.panel.Panel',

    title: 'Visit Report',

    initComponent: function() {
        var me = this;

        Ext.applyIf(me, {
            items: [
                {
                    xtype: 'form',
                    frame: true,
                    itemId: 'frmVisitReport',
                    autoScroll: true,
                    bodyPadding: 10,
                    items: [
                        {
                            xtype: 'container',
                            itemId: 'cntVisitReportHeader',
                            padding: 10,
                            items: [
                                {
                                    xtype: 'label',
                                    margin: '0 0 0 300',
                                    style: 'font-size:18px;',
                                    text: 'भ्रमण रिपोर्ट'
                                },
                                {
                                    xtype: 'hiddenfield',
                                    itemId: 'hdnVRAction',
                                    fieldLabel: 'Label'
                                },
                                {
                                    xtype: 'hiddenfield',
                                    itemId: 'hdnAVReportAction',
                                    fieldLabel: 'Label'
                                },
                                {
                                    xtype: 'hiddenfield',
                                    itemId: 'hdnAVITYieldAction',
                                    fieldLabel: 'Label'
                                },
                                {
                                    xtype: 'hiddenfield',
                                    itemId: 'hdnAVVATYieldAction',
                                    fieldLabel: 'Label'
                                },
                                {
                                    xtype: 'hiddenfield',
                                    itemId: 'hdnAVEXYieldAction',
                                    fieldLabel: 'Label'
                                },
                                {
                                    xtype: 'hiddenfield',
                                    itemId: 'hdnAVIT',
                                    fieldLabel: 'Label'
                                },
                                {
                                    xtype: 'hiddenfield',
                                    itemId: 'hdnAVVat',
                                    fieldLabel: 'Label'
                                },
                                {
                                    xtype: 'hiddenfield',
                                    itemId: 'hdnAVEx',
                                    fieldLabel: 'Label'
                                },
                                {
                                    xtype: 'hiddenfield',
                                    itemId: 'hdnVSOfficeCode',
                                    fieldLabel: 'Label'
                                },
                                {
                                    xtype: 'hiddenfield',
                                    itemId: 'hdnVSEntDate',
                                    fieldLabel: 'Label'
                                }
                            ]
                        },
                        {
                            xtype: 'container',
                            margin: 5,
                            layout: {
                                columns: 2,
                                type: 'table'
                            },
                            items: [
                                {
                                    xtype: 'textfield',
                                    itemId: 'txtVRPan',
                                    fieldLabel: 'प्यान',
                                    enforceMaxLength: true,
                                    maxLength: 9,
                                    minLength: 9,
                                    size: 12
                                },
                                {
                                    xtype: 'textfield',
                                    itemId: 'txtVRSelectionDate',
                                    margin: '0 0 0 50',
                                    fieldLabel: 'छनोट मिति',
                                    emptyText: 'YYYY.MM.DD',
                                    enforceMaxLength: true,
                                    maxLength: 10,
                                    minLength: 10,
                                    size: 12
                                },
                                {
                                    xtype: 'combobox',
                                    colspan: 2,
                                    itemId: 'ddlVRVisitType',
                                    width: 500,
                                    fieldLabel: 'भ्रमण किसिम',
                                    displayField: 'VisitDescNep',
                                    store: 'VisitTypeStore',
                                    valueField: 'VisitTypeId'
                                }
                            ]
                        },
                        {
                            xtype: 'container',
                            itemId: 'visitOfficers',
                            margin: 5,
                            padding: 5,
                            style: 'border: 2px solid #D3E1F1;',
                            items: [
                                {
                                    xtype: 'gridpanel',
                                    height: 150,
                                    itemId: 'grdAVOfficer',
                                    autoScroll: true,
                                    title: 'कर अधिकृतअरू',
                                    store: 'VisitOfficerStore',
                                    dockedItems: [
                                        {
                                            xtype: 'toolbar',
                                            dock: 'top',
                                            items: [
                                                {
                                                    xtype: 'button',
                                                    itemId: 'btnAVOfficerAdd',
                                                    padding: 5,
                                                    iconCls: 'icon-add',
                                                    text: 'Add'
                                                }
                                            ]
                                        }
                                    ],
                                    plugins: [
                                        Ext.create('Ext.grid.plugin.RowEditing', {
                                            pluginId: 'plugInGrdAVOfficer',
                                            listeners: {
                                                validateedit: {
                                                    fn: me.onGridroweditingpluginValidateedit1,
                                                    scope: me
                                                },
                                                canceledit: {
                                                    fn: me.onGridroweditingpluginCanceledit1,
                                                    scope: me
                                                }
                                            }
                                        })
                                    ],
                                    columns: [
                                        {
                                            xtype: 'gridcolumn',
                                            hidden: true,
                                            dataIndex: 'PAN',
                                            text: 'PAN'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            hidden: true,
                                            dataIndex: 'SelectionDate',
                                            text: 'SelectionDate',
                                            editor: {
                                                xtype: 'textfield',
                                                itemId: 'txtAVOfficerSelectionDate'
                                            }
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            width: 300,
                                            dataIndex: 'OfficerName',
                                            text: 'अधिकृतको नाम',
                                            editor: {
                                                xtype: 'textfield',
                                                itemId: 'txtOfficerName',
                                                maxLength: 120,
                                                size: 50
                                            }
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            width: 200,
                                            dataIndex: 'OfficerCode',
                                            text: 'अधिकृतको कोड',
                                            editor: {
                                                xtype: 'textfield',
                                                itemId: 'txtOfficeCode',
                                                enforceMaxLength: true,
                                                maxLength: 12,
                                                size: 15
                                            }
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            hidden: true,
                                            dataIndex: 'Action',
                                            text: 'Action'
                                        },
                                        {
                                            xtype: 'actioncolumn',
                                            items: [
                                                {
                                                    handler: function(view, rowIndex, colIndex, item, e) {
                                                        var grd = Ext.ComponentQuery.query("#grdAVOfficer")[0];
                                                        var store = Ext.getStore('VisitOfficerStore');
                                                        var row = store.getAt(rowIndex).data;


                                                        Ext.Msg.confirm('Confirm','के तपाई साचै डाटा हटाउन चाहनुहुन्छ?', function(btn) {
                                                            if(btn == 'yes'){

                                                                if(row.Action === "E")
                                                                {    
                                                                    //alert("Deleting...");
                                                                    row.Action = "D";
                                                                    grd.bindStore(store);         
                                                                    store.filter(function(item){
                                                                        return item.get("Action")!= 'D';
                                                                    });
                                                                }
                                                                else
                                                                {

                                                                    store.removeAt(rowIndex);
                                                                }
                                                                return true;
                                                            }
                                                        }, this);

                                                    },
                                                    icon: '../ITS/resources/images/icons/cancel.png'
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            xtype: 'container',
                            margin: 5,
                            layout: {
                                columns: 4,
                                type: 'table'
                            },
                            items: [
                                {
                                    xtype: 'textfield',
                                    itemId: 'txtVRVisitDate',
                                    fieldLabel: 'भ्रमण शुरू मिति',
                                    readOnly: true,
                                    emptyText: 'YYYY.MM.DD',
                                    enforceMaxLength: true,
                                    maxLength: 10,
                                    size: 12
                                },
                                {
                                    xtype: 'textfield',
                                    itemId: 'txtVRCloseDate',
                                    margin: '0 0 0 20',
                                    fieldLabel: 'भ्रमण सकिएको मिति',
                                    labelWidth: 120,
                                    emptyText: 'YYYY.MM.DD',
                                    enforceMaxLength: true,
                                    maxLength: 10,
                                    size: 12
                                },
                                {
                                    xtype: 'textfield',
                                    colspan: 2,
                                    itemId: 'txtVRCancelDate',
                                    margin: '0 0 0 20',
                                    fieldLabel: 'छनोटबाट हटाएको मिति',
                                    labelWidth: 120,
                                    readOnly: true,
                                    emptyText: 'YYYY.MM.DD',
                                    enforceMaxLength: true,
                                    maxLength: 10,
                                    size: 12
                                }
                            ]
                        },
                        {
                            xtype: 'container',
                            layout: {
                                columns: 4,
                                type: 'table'
                            },
                            items: [
                                {
                                    xtype: 'textfield',
                                    itemId: 'txtVRPeriodFrom',
                                    fieldLabel: 'परिक्षण अवधि',
                                    emptyText: 'YYYY.MM.DD',
                                    enforceMaxLength: true,
                                    maxLength: 10,
                                    size: 12
                                },
                                {
                                    xtype: 'textfield',
                                    itemId: 'txtVRPeriodTo',
                                    margin: '0 0 0 20',
                                    fieldLabel: 'देखि',
                                    labelWidth: 50,
                                    emptyText: 'YYYY.MM.DD',
                                    enforceMaxLength: true,
                                    maxLength: 10,
                                    size: 12
                                },
                                {
                                    xtype: 'textfield',
                                    itemId: 'txtVRNextVisitDate',
                                    margin: '0 0 0 20',
                                    fieldLabel: 'अर्को भ्रमण मिति',
                                    emptyText: 'YYYY.MM.DD',
                                    enforceMaxLength: true,
                                    maxLength: 10,
                                    size: 12
                                },
                                {
                                    xtype: 'textfield',
                                    itemId: 'txtVRNoOfEmployee',
                                    margin: '0 0 0 20',
                                    fieldLabel: 'कर्मछारी संख्या',
                                    enforceMaxLength: true,
                                    maxLength: 6,
                                    size: 6
                                },
                                {
                                    xtype: 'radiogroup',
                                    itemId: 'rdbComputerEntry',
                                    width: 200,
                                    fieldLabel: 'कमप्यूटर ईन्ट्रि',
                                    items: [
                                        {
                                            xtype: 'radiofield',
                                            itemId: 'rdbComputerEntryYes',
                                            width: 30,
                                            labelWidth: 30,
                                            name: 'CompEntry',
                                            boxLabel: 'हो'
                                        },
                                        {
                                            xtype: 'radiofield',
                                            itemId: 'rdbComputerEntryNo',
                                            name: 'CompEntry',
                                            boxLabel: 'होइन'
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            xtype: 'container',
                            itemId: 'Yield',
                            padding: '10 0 0 0',
                            layout: {
                                columns: 4,
                                type: 'table'
                            },
                            items: [
                                {
                                    xtype: 'fieldset',
                                    frame: true,
                                    layout: {
                                        columns: 2,
                                        type: 'table'
                                    },
                                    title: 'Income Tax',
                                    items: [
                                        {
                                            xtype: 'label',
                                            text: 'प्रारम्भिक'
                                        },
                                        {
                                            xtype: 'label',
                                            text: 'अन्तिम'
                                        },
                                        {
                                            xtype: 'numberfield',
                                            itemId: 'txtVRITPrimaryMAAmount',
                                            fieldLabel: 'निर्धारित कर रकम',
                                            enforceMaxLength: true,
                                            maxLength: 14,
                                            size: 14,
                                            hideTrigger: true,
                                            keyNavEnabled: false,
                                            mouseWheelEnabled: false,
                                            allowDecimals: false,
                                            minValue: 0
                                        },
                                        {
                                            xtype: 'numberfield',
                                            itemId: 'txtVRITFinalMAAmount',
                                            fieldLabel: 'Label',
                                            hideLabel: true,
                                            enforceMaxLength: true,
                                            maxLength: 14,
                                            size: 14,
                                            hideTrigger: true,
                                            keyNavEnabled: false,
                                            mouseWheelEnabled: false,
                                            allowDecimals: false,
                                            minValue: 0
                                        },
                                        {
                                            xtype: 'numberfield',
                                            itemId: 'txtVRITPrimaryInterest',
                                            fieldLabel: 'ब्याज',
                                            enforceMaxLength: true,
                                            maxLength: 14,
                                            size: 14,
                                            hideTrigger: true,
                                            keyNavEnabled: false,
                                            mouseWheelEnabled: false,
                                            allowDecimals: false,
                                            minValue: 0
                                        },
                                        {
                                            xtype: 'numberfield',
                                            itemId: 'txtVRITFinalInterest',
                                            fieldLabel: 'Label',
                                            hideLabel: true,
                                            enforceMaxLength: true,
                                            maxLength: 14,
                                            size: 14,
                                            hideTrigger: true,
                                            keyNavEnabled: false,
                                            mouseWheelEnabled: false,
                                            allowDecimals: false,
                                            minValue: 0
                                        },
                                        {
                                            xtype: 'numberfield',
                                            itemId: 'txtVRITPrimaryADCharge',
                                            fieldLabel: 'थप दस्तुर',
                                            enforceMaxLength: true,
                                            maxLength: 14,
                                            size: 14,
                                            hideTrigger: true,
                                            keyNavEnabled: false,
                                            mouseWheelEnabled: false,
                                            allowDecimals: false,
                                            minValue: 0
                                        },
                                        {
                                            xtype: 'numberfield',
                                            itemId: 'txtVRITFinalADCharge',
                                            fieldLabel: 'Label',
                                            hideLabel: true,
                                            enforceMaxLength: true,
                                            maxLength: 14,
                                            size: 14,
                                            hideTrigger: true,
                                            keyNavEnabled: false,
                                            mouseWheelEnabled: false,
                                            allowDecimals: false,
                                            minValue: 0
                                        },
                                        {
                                            xtype: 'numberfield',
                                            itemId: 'txtVRITPrimaryPenalty',
                                            fieldLabel: 'जरिवाना',
                                            enforceMaxLength: true,
                                            maxLength: 14,
                                            size: 14,
                                            hideTrigger: true,
                                            mouseWheelEnabled: false,
                                            allowDecimals: false,
                                            minValue: 0
                                        },
                                        {
                                            xtype: 'numberfield',
                                            itemId: 'txtVRITFinalPenalty',
                                            fieldLabel: 'Label',
                                            hideLabel: true,
                                            enforceMaxLength: true,
                                            maxLength: 14,
                                            size: 14,
                                            hideTrigger: true,
                                            keyNavEnabled: false,
                                            mouseWheelEnabled: false,
                                            allowDecimals: false,
                                            minValue: 0
                                        }
                                    ]
                                },
                                {
                                    xtype: 'fieldset',
                                    layout: {
                                        columns: 2,
                                        type: 'table'
                                    },
                                    title: 'Vat',
                                    items: [
                                        {
                                            xtype: 'label',
                                            text: 'प्रारम्भिक'
                                        },
                                        {
                                            xtype: 'label',
                                            text: 'अन्तिम'
                                        },
                                        {
                                            xtype: 'numberfield',
                                            itemId: 'txtVRVATPrimaryMAAmount',
                                            fieldLabel: 'निर्धारित कर रकम',
                                            hideLabel: true,
                                            enforceMaxLength: true,
                                            maxLength: 14,
                                            size: 14,
                                            hideTrigger: true,
                                            keyNavEnabled: false,
                                            mouseWheelEnabled: false,
                                            allowDecimals: false,
                                            minValue: 0
                                        },
                                        {
                                            xtype: 'numberfield',
                                            itemId: 'txtVRVATFinalMAAmount',
                                            fieldLabel: 'Label',
                                            hideLabel: true,
                                            enforceMaxLength: true,
                                            maxLength: 14,
                                            size: 14,
                                            hideTrigger: true,
                                            keyNavEnabled: false,
                                            mouseWheelEnabled: false,
                                            allowDecimals: false,
                                            minValue: 0
                                        },
                                        {
                                            xtype: 'numberfield',
                                            itemId: 'txtVRVATPrimaryInterest',
                                            fieldLabel: 'ब्याज',
                                            hideLabel: true,
                                            enforceMaxLength: true,
                                            maxLength: 14,
                                            size: 14,
                                            hideTrigger: true,
                                            keyNavEnabled: false,
                                            mouseWheelEnabled: false,
                                            allowDecimals: false,
                                            minValue: 0
                                        },
                                        {
                                            xtype: 'numberfield',
                                            itemId: 'txtVRVATFinalInterest',
                                            fieldLabel: 'Label',
                                            hideLabel: true,
                                            enforceMaxLength: true,
                                            maxLength: 14,
                                            size: 14,
                                            hideTrigger: true,
                                            keyNavEnabled: false,
                                            mouseWheelEnabled: false,
                                            allowDecimals: false,
                                            minValue: 0
                                        },
                                        {
                                            xtype: 'numberfield',
                                            itemId: 'txtVRVATPrimaryADCharge',
                                            fieldLabel: 'थप दस्तुर',
                                            hideLabel: true,
                                            enforceMaxLength: true,
                                            maxLength: 14,
                                            size: 14,
                                            hideTrigger: true,
                                            keyNavEnabled: false,
                                            mouseWheelEnabled: false,
                                            allowDecimals: false,
                                            minValue: 0
                                        },
                                        {
                                            xtype: 'numberfield',
                                            itemId: 'txtVRVATFinalADCharge',
                                            fieldLabel: 'Label',
                                            hideLabel: true,
                                            enforceMaxLength: true,
                                            maxLength: 14,
                                            size: 14,
                                            hideTrigger: true,
                                            keyNavEnabled: false,
                                            mouseWheelEnabled: false,
                                            allowDecimals: false,
                                            minValue: 0
                                        },
                                        {
                                            xtype: 'numberfield',
                                            itemId: 'txtVRVATPrimaryPenalty',
                                            fieldLabel: 'जरिवाना',
                                            hideLabel: true,
                                            enforceMaxLength: true,
                                            maxLength: 14,
                                            size: 14,
                                            hideTrigger: true,
                                            mouseWheelEnabled: false,
                                            allowDecimals: false,
                                            minValue: 0
                                        },
                                        {
                                            xtype: 'numberfield',
                                            itemId: 'txtVRVATFinalPenalty',
                                            fieldLabel: 'Label',
                                            hideLabel: true,
                                            enforceMaxLength: true,
                                            maxLength: 14,
                                            size: 14,
                                            hideTrigger: true,
                                            keyNavEnabled: false,
                                            mouseWheelEnabled: false,
                                            allowDecimals: false,
                                            minValue: 0
                                        }
                                    ]
                                },
                                {
                                    xtype: 'fieldset',
                                    layout: {
                                        columns: 2,
                                        type: 'table'
                                    },
                                    title: 'Excise',
                                    items: [
                                        {
                                            xtype: 'label',
                                            text: 'प्रारम्भिक'
                                        },
                                        {
                                            xtype: 'label',
                                            text: 'अन्तिम'
                                        },
                                        {
                                            xtype: 'numberfield',
                                            itemId: 'txtVREXPrimaryMAAmount',
                                            fieldLabel: 'निर्धारित कर रकम',
                                            hideLabel: true,
                                            enforceMaxLength: true,
                                            maxLength: 14,
                                            size: 14,
                                            hideTrigger: true,
                                            keyNavEnabled: false,
                                            mouseWheelEnabled: false,
                                            allowDecimals: false,
                                            minValue: 0
                                        },
                                        {
                                            xtype: 'numberfield',
                                            itemId: 'txtVREXFinalMAAmount',
                                            fieldLabel: 'Label',
                                            hideLabel: true,
                                            enforceMaxLength: true,
                                            maxLength: 14,
                                            size: 14,
                                            hideTrigger: true,
                                            keyNavEnabled: false,
                                            mouseWheelEnabled: false,
                                            allowDecimals: false,
                                            minValue: 0
                                        },
                                        {
                                            xtype: 'numberfield',
                                            itemId: 'txtVREXPrimaryInterest',
                                            fieldLabel: 'ब्याज',
                                            hideLabel: true,
                                            enforceMaxLength: true,
                                            maxLength: 14,
                                            size: 14,
                                            hideTrigger: true,
                                            keyNavEnabled: false,
                                            mouseWheelEnabled: false,
                                            allowDecimals: false,
                                            minValue: 0
                                        },
                                        {
                                            xtype: 'numberfield',
                                            itemId: 'txtVREXFinalInterest',
                                            fieldLabel: 'Label',
                                            hideLabel: true,
                                            enforceMaxLength: true,
                                            maxLength: 14,
                                            size: 14,
                                            hideTrigger: true,
                                            keyNavEnabled: false,
                                            mouseWheelEnabled: false,
                                            allowDecimals: false,
                                            minValue: 0
                                        },
                                        {
                                            xtype: 'numberfield',
                                            itemId: 'txtVREXPrimaryADCharge',
                                            fieldLabel: 'थप दस्तुर',
                                            hideLabel: true,
                                            enforceMaxLength: true,
                                            maxLength: 14,
                                            size: 14,
                                            hideTrigger: true,
                                            keyNavEnabled: false,
                                            mouseWheelEnabled: false,
                                            allowDecimals: false,
                                            minValue: 0
                                        },
                                        {
                                            xtype: 'numberfield',
                                            itemId: 'txtVREXFinalADCharge',
                                            fieldLabel: 'Label',
                                            hideLabel: true,
                                            enforceMaxLength: true,
                                            maxLength: 14,
                                            size: 14,
                                            hideTrigger: true,
                                            keyNavEnabled: false,
                                            mouseWheelEnabled: false,
                                            allowDecimals: false,
                                            minValue: 0
                                        },
                                        {
                                            xtype: 'numberfield',
                                            itemId: 'txtVREXPrimaryPenalty',
                                            fieldLabel: 'जरिवाना',
                                            hideLabel: true,
                                            enforceMaxLength: true,
                                            maxLength: 14,
                                            size: 14,
                                            hideTrigger: true,
                                            mouseWheelEnabled: false,
                                            allowDecimals: false,
                                            minValue: 0
                                        },
                                        {
                                            xtype: 'numberfield',
                                            itemId: 'txtVREXFinalPenalty',
                                            fieldLabel: 'Label',
                                            hideLabel: true,
                                            enforceMaxLength: true,
                                            maxLength: 14,
                                            size: 14,
                                            hideTrigger: true,
                                            keyNavEnabled: false,
                                            mouseWheelEnabled: false,
                                            allowDecimals: false,
                                            minValue: 0
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            xtype: 'container',
                            itemId: 'Risks',
                            margin: 5,
                            padding: 5,
                            items: [
                                {
                                    xtype: 'gridpanel',
                                    height: 150,
                                    itemId: 'grdRisks',
                                    autoScroll: true,
                                    title: 'जोखिमका प्रकार',
                                    store: 'AVRepRiskStore',
                                    dockedItems: [
                                        {
                                            xtype: 'toolbar',
                                            dock: 'top',
                                            items: [
                                                {
                                                    xtype: 'button',
                                                    itemId: 'btnAVRiskAdd',
                                                    iconCls: 'icon-add',
                                                    text: 'Add'
                                                }
                                            ]
                                        }
                                    ],
                                    columns: [
                                        {
                                            xtype: 'gridcolumn',
                                            hidden: true,
                                            dataIndex: 'PAN',
                                            text: 'PAN'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            hidden: true,
                                            dataIndex: 'SelectionDate',
                                            text: 'SelectionDate'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            renderer: function(value, metaData, record, rowIndex, colIndex, store, view) {



                                                var grid = Ext.ComponentQuery.query('#grdRisks')[0];

                                                var items = Ext.getStore('RiskTypeStore').data.items;
                                                var temp='';


                                                for(var i=0;i<items.length;i++)
                                                {        
                                                    if(items[i].data.RiskTypeId == value)
                                                    {           
                                                        temp=items[i].data.RiskDescNep;
                                                        break;
                                                    }        
                                                }


                                                return temp;

                                            },
                                            minWidth: 300,
                                            width: 300,
                                            dataIndex: 'RiskTypeId',
                                            text: 'RiskTypeId',
                                            editor: {
                                                xtype: 'combobox',
                                                itemId: 'ddlVRRiskType',
                                                emptyText: 'Select',
                                                displayField: 'RiskDescNep',
                                                queryMode: 'local',
                                                store: 'RiskTypeStore',
                                                valueField: 'RiskTypeId'
                                            }
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            width: 300,
                                            dataIndex: 'Remarks',
                                            text: 'Remarks',
                                            editor: {
                                                xtype: 'textfield',
                                                itemId: 'txtVRRiskRemarks',
                                                size: 100
                                            }
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            hidden: true,
                                            dataIndex: 'Action',
                                            text: 'Action'
                                        },
                                        {
                                            xtype: 'actioncolumn',
                                            items: [
                                                {
                                                    handler: function(view, rowIndex, colIndex, item, e) {
                                                        var grd = Ext.ComponentQuery.query("#grdRisks")[0];
                                                        var store = Ext.getStore('AVRepRiskStore');
                                                        var row = store.getAt(rowIndex).data;


                                                        Ext.Msg.confirm('Confirm','के तपाई साचै डाटा हटाउन चाहनुहुन्छ?', function(btn) {
                                                            if(btn == 'yes'){

                                                                if(row.Action === "E")
                                                                {    
                                                                    //alert("Deleting...");
                                                                    row.Action = "D";
                                                                    grd.bindStore(store);         
                                                                    store.filter(function(item){
                                                                        return item.get("Action")!= 'D';
                                                                    });
                                                                }
                                                                else
                                                                {

                                                                    store.removeAt(rowIndex);
                                                                }
                                                                return true;
                                                            }
                                                        }, this);

                                                    },
                                                    icon: '../ITS/resources/images/icons/cancel.png'
                                                }
                                            ]
                                        }
                                    ],
                                    plugins: [
                                        Ext.create('Ext.grid.plugin.RowEditing', {
                                            pluginId: 'plugInGrdAVRisk',
                                            listeners: {
                                                validateedit: {
                                                    fn: me.onGridroweditingpluginValidateedit,
                                                    scope: me
                                                },
                                                canceledit: {
                                                    fn: me.onGridroweditingpluginCanceledit,
                                                    scope: me
                                                }
                                            }
                                        })
                                    ]
                                }
                            ]
                        },
                        {
                            xtype: 'container',
                            itemId: 'Mistakes',
                            margin: 5,
                            padding: 5,
                            items: [
                                {
                                    xtype: 'gridpanel',
                                    height: 150,
                                    itemId: 'grdMistakes',
                                    autoScroll: true,
                                    title: 'गल्तीका प्रकार',
                                    store: 'AVRepMistakeStore',
                                    dockedItems: [
                                        {
                                            xtype: 'toolbar',
                                            dock: 'top',
                                            items: [
                                                {
                                                    xtype: 'button',
                                                    itemId: 'btnAVMistakeAdd',
                                                    iconCls: 'icon-add',
                                                    text: 'Add'
                                                }
                                            ]
                                        }
                                    ],
                                    columns: [
                                        {
                                            xtype: 'gridcolumn',
                                            hidden: true,
                                            dataIndex: 'PAN',
                                            text: 'PAN'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            hidden: true,
                                            dataIndex: 'SelectionDate',
                                            text: 'SelectionDate'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            renderer: function(value, metaData, record, rowIndex, colIndex, store, view) {



                                                var grid = Ext.ComponentQuery.query('#grdMistakes')[0];

                                                var items = Ext.getStore('MistakeTypeStore').data.items;
                                                var temp='';


                                                for(var i=0;i<items.length;i++)
                                                {        
                                                    if(items[i].data.MistakeTypeId == value)
                                                    {           
                                                        temp=items[i].data.MistakeDescNep;
                                                        break;
                                                    }        
                                                }


                                                return temp;

                                            },
                                            width: 300,
                                            dataIndex: 'MistakeTypeId',
                                            text: 'MistakeTypeId',
                                            editor: {
                                                xtype: 'combobox',
                                                itemId: 'ddlVRMistakeType',
                                                emptyText: 'Select ...',
                                                displayField: 'MistakeDescNep',
                                                queryMode: 'local',
                                                store: 'MistakeTypeStore',
                                                valueField: 'MistakeTypeId'
                                            }
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            width: 300,
                                            dataIndex: 'Remarks',
                                            text: 'Remarks',
                                            editor: {
                                                xtype: 'textfield',
                                                itemId: 'txtVRMistakeRemarks'
                                            }
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            hidden: true,
                                            dataIndex: 'Action',
                                            text: 'Action'
                                        },
                                        {
                                            xtype: 'actioncolumn',
                                            items: [
                                                {
                                                    handler: function(view, rowIndex, colIndex, item, e) {
                                                        var grd = Ext.ComponentQuery.query("#grdMistakes")[0];
                                                        var store = Ext.getStore('AVRepMistakeStore');
                                                        var row = store.getAt(rowIndex).data;


                                                        Ext.Msg.confirm('Confirm','के तपाई साचै डाटा हटाउन चाहनुहुन्छ?', function(btn) {
                                                            if(btn == 'yes'){

                                                                if(row.Action === "E")
                                                                {    
                                                                    //alert("Deleting...");
                                                                    row.Action = "D";
                                                                    grd.bindStore(store);         
                                                                    store.filter(function(item){
                                                                        return item.get("Action")!= 'D';
                                                                    });
                                                                }
                                                                else
                                                                {

                                                                    store.removeAt(rowIndex);
                                                                }
                                                                return true;
                                                            }
                                                        }, this);

                                                    },
                                                    icon: '../ITS/resources/images/icons/cancel.png'
                                                }
                                            ]
                                        }
                                    ],
                                    plugins: [
                                        Ext.create('Ext.grid.plugin.RowEditing', {
                                            pluginId: 'plugInGrdAVMistake',
                                            listeners: {
                                                validateedit: {
                                                    fn: me.onGridroweditingpluginValidateedit2,
                                                    scope: me
                                                },
                                                canceledit: {
                                                    fn: me.onGridroweditingpluginCanceledit2,
                                                    scope: me
                                                }
                                            }
                                        })
                                    ]
                                }
                            ]
                        },
                        {
                            xtype: 'container',
                            margin: 5,
                            padding: 5,
                            items: [
                                {
                                    xtype: 'gridpanel',
                                    height: 150,
                                    itemId: 'grdLinkedOrg',
                                    autoScroll: true,
                                    title: 'सम्बन्धित फर्महरू',
                                    store: 'AVRepLInkedOrg',
                                    dockedItems: [
                                        {
                                            xtype: 'toolbar',
                                            dock: 'top',
                                            items: [
                                                {
                                                    xtype: 'button',
                                                    itemId: 'btnAVLinkedOrg',
                                                    iconCls: 'icon-add',
                                                    text: 'Add'
                                                }
                                            ]
                                        }
                                    ],
                                    columns: [
                                        {
                                            xtype: 'gridcolumn',
                                            hidden: true,
                                            dataIndex: 'PAN',
                                            text: 'PAN'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            hidden: true,
                                            dataIndex: 'SelectionDate',
                                            text: 'SelectionDate'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            width: 150,
                                            dataIndex: 'LinkedPan',
                                            text: 'LinkedPan',
                                            editor: {
                                                xtype: 'textfield',
                                                itemId: 'txtVRLinkedPan',
                                                enforceMaxLength: true,
                                                maxLength: 9,
                                                size: 12
                                            }
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            width: 450,
                                            dataIndex: 'Remarks',
                                            text: 'Remarks',
                                            editor: {
                                                xtype: 'textfield',
                                                itemId: 'txtVRLinkedOrgRemarks',
                                                enforceMaxLength: true,
                                                maxLength: 60,
                                                size: 70
                                            }
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            hidden: true,
                                            dataIndex: 'Action',
                                            text: 'Action'
                                        },
                                        {
                                            xtype: 'actioncolumn',
                                            items: [
                                                {
                                                    handler: function(view, rowIndex, colIndex, item, e) {
                                                        var grd = Ext.ComponentQuery.query("#grdLinkedOrg")[0];
                                                        var store = Ext.getStore('AVRepLInkedOrg');
                                                        var row = store.getAt(rowIndex).data;


                                                        Ext.Msg.confirm('Confirm','के तपाई साचै डाटा हटाउन चाहनुहुन्छ?', function(btn) {
                                                            if(btn == 'yes'){

                                                                if(row.Action === "E")
                                                                {    
                                                                    //alert("Deleting...");
                                                                    row.Action = "D";
                                                                    grd.bindStore(store);         
                                                                    store.filter(function(item){
                                                                        return item.get("Action")!= 'D';
                                                                    });
                                                                }
                                                                else
                                                                {

                                                                    store.removeAt(rowIndex);
                                                                }
                                                                return true;
                                                            }
                                                        }, this);

                                                    },
                                                    icon: '../ITS/resources/images/icons/cancel.png'
                                                }
                                            ]
                                        }
                                    ],
                                    plugins: [
                                        Ext.create('Ext.grid.plugin.RowEditing', {
                                            pluginId: 'plugInGrdAVLinkedOrg',
                                            listeners: {
                                                validateedit: {
                                                    fn: me.onGridroweditingpluginValidateedit3,
                                                    scope: me
                                                },
                                                canceledit: {
                                                    fn: me.onGridroweditingpluginCanceledit3,
                                                    scope: me
                                                }
                                            }
                                        })
                                    ]
                                }
                            ]
                        },
                        {
                            xtype: 'container',
                            margin: 5,
                            padding: 5,
                            items: [
                                {
                                    xtype: 'textareafield',
                                    itemId: 'txtVRRemarks',
                                    maxWidth: 600,
                                    minWidth: 500,
                                    width: 600,
                                    fieldLabel: 'कैफियत',
                                    maxLength: 4000
                                }
                            ]
                        },
                        {
                            xtype: 'container',
                            margin: '0 0 0 400',
                            items: [
                                {
                                    xtype: 'button',
                                    itemId: 'btnVRSave',
                                    padding: 5,
                                    iconCls: 'icon-save',
                                    text: 'Save'
                                },
                                {
                                    xtype: 'button',
                                    itemId: 'btnVRSubmit',
                                    padding: 5,
                                    iconCls: 'icon-ok',
                                    text: 'Submit'
                                },
                                {
                                    xtype: 'button',
                                    itemId: 'btnVRCancel',
                                    padding: 5,
                                    iconCls: 'icon-cancel',
                                    text: 'Cancel'
                                }
                            ]
                        }
                    ]
                }
            ]
        });

        me.callParent(arguments);
    },

    onGridroweditingpluginValidateedit1: function(editor, e, eOpts) {
        var officerSelDate = Ext.ComponentQuery.query('#txtAVOfficerSelectionDate')[0];
        var officerName=Ext.ComponentQuery.query('#txtOfficerName')[0];
        var btnOfficerAdd=Ext.ComponentQuery.query('#btnAVOfficerAdd')[0];
        var message = "";
        e.cancel=false;

        if(officerSelDate.getValue()==='')
        {
            message+='<BR>* तपाईले अफिसर छनोट मिति अनिवार्य रूपमा भर्नु पर्नेछ।';
        }
        if(officerName.getValue()==='')
        {
            message+='<BR>* तपाईले अफिसरको नाम अनिवार्य रूपमा भर्नु पर्नेछ।';
        }

        if(message!=='')
        {
            msg('INFO',message);
            e.cancel=true;

        }
        else
        {
            var items = Ext.getStore('VisitOfficerStore').data.items;
            //if(!e.record.data.Action)
            //{
            items[e.rowIdx].data.Action='A';
            //}


            btnOfficerAdd.enable(true);
        }

    },

    onGridroweditingpluginCanceledit1: function(editor, e, eOpts) {
        var btnOfficerAdd=Ext.ComponentQuery.query('#btnAVOfficerAdd')[0];
        console.log('Grid: ',grid);
        if(Ext.getStore('VisitOfficerStore').data.items[grid.rowIdx].data.Action=='A')
        {
            grid.store.removeAt(grid.rowIdx);
        }
        btnOfficerAdd.enable(true);


    },

    onGridroweditingpluginValidateedit: function(editor, e, eOpts) {
        var ddlRiskType = Ext.ComponentQuery.query('#ddlVRRiskType')[0];
        var btnAVRiskAdd=Ext.ComponentQuery.query('#btnAVRiskAdd')[0];
        var message = "";
        e.cancel=false;

        if(ddlRiskType.getValue()==='')
        {
            message+='<BR>* तपाईले जोखिमको प्रकार अनिवार्य रूपमा भर्नु पर्नेछ।';
        }


        if(message!=='')
        {
            msg('INFO',message);
            e.cancel=true;

        }
        else
        {
            var items = Ext.getStore('AVRepRiskStore').data.items;
            //if(!e.record.data.Action)
            //{
            items[e.rowIdx].data.Action='A';
            //}
            btnAVRiskAdd.enable(true);
        }

    },

    onGridroweditingpluginCanceledit: function(editor, e, eOpts) {
        var btnRiskAdd=Ext.ComponentQuery.query('#btnAVRiskAdd')[0];
        grid.store.removeAt(grid.rowIdx);
        btnRiskAdd.enable(true);

    },

    onGridroweditingpluginValidateedit2: function(editor, e, eOpts) {
        var ddlMistakeType = Ext.ComponentQuery.query('#ddlVRMistakeType')[0];
        var btnAVMistakeAdd=Ext.ComponentQuery.query('#btnAVMistakeAdd')[0];
        var message = "";
        e.cancel=false;

        if(ddlMistakeType.getValue()==='')
        {
            message+='<BR>* तपाईले जोखिमको प्रकार अनिवार्य रूपमा भर्नु पर्नेछ।';
        }


        if(message!=='')
        {
            msg('INFO',message);
            e.cancel=true;

        }
        else
        {
            console.log(e);
            console.log(e.record.data.Action);
            var items = Ext.getStore('AVRepMistakeStore').data.items;
            //if(!e.record.data.Action)
            //{
            items[e.rowIdx].data.Action='A';
            //}

            btnAVMistakeAdd.enable(true);
        }



    },

    onGridroweditingpluginCanceledit2: function(editor, e, eOpts) {
        var btnMistakeAdd=Ext.ComponentQuery.query('#btnAVMistakeAdd')[0];
        grid.store.removeAt(grid.rowIdx);
        btnMistakeAdd.enable(true);

    },

    onGridroweditingpluginValidateedit3: function(editor, e, eOpts) {
        var txtVRLinkedPan = Ext.ComponentQuery.query('#txtVRLinkedPan')[0];
        var btnAVLOAdd=Ext.ComponentQuery.query('#btnAVLinkedOrg')[0];
        var message = "";
        e.cancel=false;

        if(txtVRLinkedPan.getValue()==='')
        {
            message+='<BR>* तपाईले जोखिमको प्रकार अनिवार्य रूपमा भर्नु पर्नेछ।';
        }

        var isValid=ValidatePan(txtVRLinkedPan,null,null);
        console.log(isValid);

        if(message!=='')
        {
            msg('INFO',message);
            e.cancel=true;

        }
        else
        {
            var items = Ext.getStore('AVRepLInkedOrg').data.items;
            //if(!e.record.data.Action)
            //{
            items[e.rowIdx].data.Action='A';
            //}
            btnAVLOAdd.enable(true);
        }

    },

    onGridroweditingpluginCanceledit3: function(editor, e, eOpts) {
        var btnLOAdd=Ext.ComponentQuery.query('#btnAVLinkedOrg')[0];
        grid.store.removeAt(grid.rowIdx);
        btnLOAdd.enable(true);

    }

});