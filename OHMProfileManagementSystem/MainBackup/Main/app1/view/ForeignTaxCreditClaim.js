/*
 * File: app/view/ForeignTaxCreditClaim.js
 *
 * This file was generated by Sencha Architect version 2.1.0.
 * http://www.sencha.com/products/architect/
 *
 * This file requires use of the Ext JS 4.0.x library, under independent license.
 * License of Sencha Architect does not include license for Ext JS 4.0.x. For more
 * details see http://www.sencha.com/license or contact license@sencha.com.
 *
 * This file will be auto-generated each and everytime you save your project.
 *
 * Do NOT hand edit this file.
 */

Ext.define('MyApp.view.ForeignTaxCreditClaim', {
    extend: 'Ext.panel.Panel',

    frame: true,
    height: 1000,
    id: '',
    itemId: 'frm_EstimatedReturns',
    style: 'font-size:20px;\r\n\r\n\r\ntext-align:center;',
    autoScroll: false,
    layout: {
        align: 'stretch',
        type: 'vbox'
    },
    bodyPadding: 10,
    title: 'विदेशमा तिरेको कर मिलान दावीको विवरण राख्ने(अनुसूची -१२)',

    initComponent: function() {
        var me = this;

        Ext.applyIf(me, {
            items: [
                {
                    xtype: 'form',
                    flex: 1,
                    frame: true,
                    height: 950,
                    itemId: 'frm_ForeignTaxCreditClaim',
                    margin: 5,
                    autoScroll: true,
                    bodyPadding: 10,
                    items: [
                        {
                            xtype: 'container',
                            frame: true,
                            height: 125,
                            itemId: 'cntHeaderForeignTaxCreditClaim',
                            margin: '0 0 5 0',
                            layout: {
                                align: 'stretch',
                                type: 'vbox'
                            },
                            items: [
                                {
                                    xtype: 'label',
                                    flex: 1,
                                    height: 50,
                                    margin: '2 0 0 70',
                                    style: 'font-size:20px;\r\n\r\n\r\ntext-align:center;',
                                    text: 'विदेशमा तिरेको कर मिलान दावीको विवरण राख्ने(अनुसूची -१२)'
                                },
                                {
                                    xtype: 'container',
                                    flex: 1,
                                    height: 30,
                                    maxHeight: 30,
                                    layout: {
                                        type: 'table'
                                    },
                                    items: [
                                        {
                                            xtype: 'displayfield',
                                            height: 25,
                                            hidden: false,
                                            id: '',
                                            itemId: 'hdnlblForeignTaxCreditClaimAction',
                                            maxHeight: 25,
                                            width: 196,
                                            fieldStyle: '{color:red;}',
                                            fieldLabel: '',
                                            hideLabel: false
                                        }
                                    ]
                                },
                                {
                                    xtype: 'displayfield',
                                    flex: 1,
                                    height: 25,
                                    hidden: true,
                                    itemId: 'dispForeignTaxCreditClaim_submissionNo',
                                    maxHeight: 25,
                                    width: 245,
                                    fieldLabel: 'सब्मिशन नं',
                                    labelWidth: 150
                                },
                                {
                                    xtype: 'container',
                                    height: 25,
                                    layout: {
                                        align: 'stretch',
                                        type: 'hbox'
                                    },
                                    items: [
                                        {
                                            xtype: 'displayfield',
                                            itemId: 'ForeignTaxCreditClaim_IROName',
                                            width: 440,
                                            fieldLabel: 'आन्तरिक राजस्व कार्यालयको नाम',
                                            labelSeparator: ' ',
                                            labelWidth: 180
                                        },
                                        {
                                            xtype: 'textfield',
                                            disabled: true,
                                            hidden: false,
                                            itemId: 'txtFTCC_ASSESSMENTNO',
                                            margin: '',
                                            fieldLabel: 'ऐसिसमेनट नं',
                                            labelWidth: 80,
                                            enableKeyEvents: true,
                                            maxLength: 12,
                                            minLength: 12,
                                            size: 12
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            xtype: 'form',
                            frame: true,
                            height: 360,
                            margin: '0 0 5 0',
                            layout: {
                                columns: 6,
                                type: 'table'
                            },
                            bodyPadding: 10,
                            collapseFirst: false,
                            collapsible: false,
                            title: '१ करदाता सम्बन्धी विवरण',
                            titleCollapse: false,
                            items: [
                                {
                                    xtype: 'container',
                                    cls: 'extTbl',
                                    height: 350,
                                    layout: {
                                        columns: 6,
                                        type: 'table'
                                    },
                                    items: [
                                        {
                                            xtype: 'textfield',
                                            colspan: 3,
                                            itemId: 'txtFTCC_PanNo',
                                            margin: '5px 0 0 0',
                                            fieldLabel: 'स्था . ले . नं .*',
                                            labelWidth: 80,
                                            allowBlank: false,
                                            emptyText: '',
                                            enableKeyEvents: true,
                                            enforceMaxLength: true,
                                            maskRe: /[0-9]/,
                                            maxLength: 9,
                                            minLength: 9,
                                            size: 9
                                        },
                                        {
                                            xtype: 'combobox',
                                            itemId: 'ddlFTCCActType',
                                            margin: '5 0 0 20',
                                            fieldLabel: 'खाताको किसिम*',
                                            allowBlank: false,
                                            emptyText: '---छान्नुहोस्.---',
                                            displayField: 'IncomeTaxAcctTypeName',
                                            forceSelection: true,
                                            queryMode: 'local',
                                            store: 'IncomeTaxAcctType',
                                            typeAhead: true,
                                            valueField: 'IncomeTaxAcctTypeID'
                                        },
                                        {
                                            xtype: 'textfield',
                                            colspan: 6,
                                            itemId: 'txtFTCC_Name',
                                            margin: '5 0 0 7',
                                            readOnly: true,
                                            fieldLabel: 'नाम ',
                                            labelWidth: 30,
                                            size: 60
                                        },
                                        {
                                            xtype: 'label',
                                            colspan: 1,
                                            margin: '5px 0 0 0',
                                            style: 'margin-right:45px;',
                                            text: 'ठेगाना '
                                        },
                                        {
                                            xtype: 'label',
                                            margin: '5px 0 0 0',
                                            style: 'margin-right:30px;',
                                            text: 'घर नं .'
                                        },
                                        {
                                            xtype: 'label',
                                            margin: '5px 0 0 0',
                                            style: 'margin-right:30px;',
                                            text: 'वार्ड नं .'
                                        },
                                        {
                                            xtype: 'label',
                                            margin: '5px 0 0 0',
                                            style: 'margin-right:30px;',
                                            text: 'गांउ / टोल र बाटोको नाम'
                                        },
                                        {
                                            xtype: 'radiogroup',
                                            itemId: 'FTCC_VM',
                                            margin: '5px 0 0 0',
                                            width: 200,
                                            fieldLabel: '',
                                            columns: 2,
                                            items: [
                                                {
                                                    xtype: 'radiofield',
                                                    itemId: 'rdl_FTCC_Metro_Mun',
                                                    readOnly: true,
                                                    boxLabel: 'म. न. पा.'
                                                },
                                                {
                                                    xtype: 'radiofield',
                                                    itemId: 'rdl_FTCC_Sub_Metro_Mun',
                                                    readOnly: true,
                                                    boxLabel: 'उ. म. न. पा.'
                                                },
                                                {
                                                    xtype: 'radiofield',
                                                    itemId: 'rdl_FTCC_Mun',
                                                    readOnly: true,
                                                    boxLabel: 'न. पा.'
                                                },
                                                {
                                                    xtype: 'radiofield',
                                                    itemId: 'rdl_FTCC_VDC',
                                                    readOnly: true,
                                                    boxLabel: 'गा. वि. स.'
                                                }
                                            ]
                                        },
                                        {
                                            xtype: 'label',
                                            margin: '5px 0 0 0',
                                            style: 'margin-right:50px;',
                                            text: 'जिल्ला'
                                        },
                                        {
                                            xtype: 'textfield',
                                            colspan: 2,
                                            itemId: 'txtFTCC_HouseNo',
                                            margin: '5 0 0 90',
                                            width: 50,
                                            readOnly: true
                                        },
                                        {
                                            xtype: 'textfield',
                                            itemId: 'txtFTCC_WardNo',
                                            margin: '',
                                            width: 50,
                                            readOnly: true
                                        },
                                        {
                                            xtype: 'textfield',
                                            itemId: 'txtFTCC_ToleName',
                                            margin: '',
                                            width: 140,
                                            readOnly: true
                                        },
                                        {
                                            xtype: 'textfield',
                                            itemId: 'txtFTCC_VDCName',
                                            margin: '',
                                            width: 200,
                                            readOnly: true
                                        },
                                        {
                                            xtype: 'textfield',
                                            itemId: 'txtFTCC_DistrictName',
                                            margin: '',
                                            width: 100,
                                            size: 100
                                        },
                                        {
                                            xtype: 'textfield',
                                            colspan: 2,
                                            itemId: 'txtFTCC_Phone',
                                            margin: '5px 0 0 0',
                                            width: 150,
                                            readOnly: true,
                                            fieldLabel: 'फोन ',
                                            labelWidth: 60,
                                            enforceMaxLength: false
                                        },
                                        {
                                            xtype: 'textfield',
                                            colspan: 2,
                                            itemId: 'txtFTCC_Mobile',
                                            margin: '5px 0 0 0',
                                            width: 207,
                                            readOnly: true,
                                            fieldLabel: 'मोबाइल ',
                                            labelWidth: 62
                                        },
                                        {
                                            xtype: 'textfield',
                                            colspan: 2,
                                            itemId: 'txtFTCC_Email',
                                            margin: '5px 0 0 0',
                                            width: 340,
                                            readOnly: true,
                                            fieldLabel: 'इमेल ',
                                            labelWidth: 60
                                        },
                                        {
                                            xtype: 'combobox',
                                            colspan: 3,
                                            itemId: 'txtFTCC_FiscalYear',
                                            margin: '20 0 0 0',
                                            fieldLabel: 'आय बर्ष*',
                                            labelWidth: 55,
                                            emptyText: '---छान्नुहोस्.---',
                                            displayField: 'fiscalYear',
                                            forceSelection: true,
                                            store: 'FiscalYear',
                                            typeAhead: true,
                                            valueField: 'fiscalYear'
                                        },
                                        {
                                            xtype: 'label',
                                            colspan: 4,
                                            hidden: true,
                                            width: 400,
                                            text: '( भर्ने उदाहरण २०६२.६३ )'
                                        },
                                        {
                                            xtype: 'textfield',
                                            colspan: 3,
                                            itemId: 'txtFTCC_ClainDate',
                                            margin: '5 0 0 0',
                                            fieldLabel: 'दावी मिति*',
                                            labelWidth: 60,
                                            allowBlank: false,
                                            emptyText: 'YYYY.MM.DD',
                                            maskRe: /[0-9.]/,
                                            size: 10,
                                            listeners: {
                                                blur: {
                                                    fn: me.onTxtFTCC_ClainDateBlur,
                                                    scope: me
                                                }
                                            }
                                        },
                                        {
                                            xtype: 'displayfield',
                                            colspan: 6,
                                            itemId: 'FTCC_TpOfficeType',
                                            width: 400,
                                            fieldLabel: 'करदाताको स्थिति '
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            xtype: 'form',
                            frame: true,
                            height: 350,
                            margin: '0 0 0 0',
                            layout: {
                                align: 'stretch',
                                type: 'vbox'
                            },
                            bodyPadding: 10,
                            collapseFirst: false,
                            collapsible: false,
                            title: '२  विदेशमा तिरेको कर मिलान दावीको विवरण',
                            titleCollapse: false,
                            items: [
                                {
                                    xtype: 'container',
                                    flex: 1,
                                    layout: {
                                        align: 'stretch',
                                        type: 'vbox'
                                    },
                                    items: [
                                        {
                                            xtype: 'toolbar',
                                            items: [
                                                {
                                                    xtype: 'button',
                                                    itemId: 'btn_AddFTCCDetail',
                                                    iconCls: 'icon-add',
                                                    text: 'Add'
                                                }
                                            ]
                                        },
                                        {
                                            xtype: 'toolbar',
                                            autoScroll: false,
                                            items: [
                                                {
                                                    xtype: 'tbspacer',
                                                    width: 16
                                                },
                                                {
                                                    xtype: 'label',
                                                    cls: 'LblCenter',
                                                    width: 10,
                                                    text: '१'
                                                },
                                                {
                                                    xtype: 'tbseparator'
                                                },
                                                {
                                                    xtype: 'label',
                                                    cls: 'LblCenter',
                                                    width: 142,
                                                    text: '२'
                                                },
                                                {
                                                    xtype: 'tbseparator'
                                                },
                                                {
                                                    xtype: 'label',
                                                    cls: 'LblCenter',
                                                    width: 250,
                                                    text: '३'
                                                },
                                                {
                                                    xtype: 'tbseparator'
                                                },
                                                {
                                                    xtype: 'label',
                                                    cls: 'LblCenter',
                                                    width: 150,
                                                    text: '४'
                                                },
                                                {
                                                    xtype: 'tbseparator'
                                                },
                                                {
                                                    xtype: 'label',
                                                    cls: 'LblCenter',
                                                    width: 137,
                                                    text: '५'
                                                },
                                                {
                                                    xtype: 'tbseparator'
                                                },
                                                {
                                                    xtype: 'label',
                                                    cls: 'LblCenter',
                                                    width: 139,
                                                    text: '६'
                                                },
                                                {
                                                    xtype: 'tbseparator'
                                                }
                                            ]
                                        },
                                        {
                                            xtype: 'gridpanel',
                                            flex: 1,
                                            itemId: 'grdForeignTaxCreditClaimDetail',
                                            title: '',
                                            store: 'DCTBForeignTaxDetails',
                                            columns: [
                                                {
                                                    xtype: 'rownumberer',
                                                    width: 35,
                                                    text: 'क्र.स.'
                                                },
                                                {
                                                    xtype: 'gridcolumn',
                                                    hidden: true,
                                                    dataIndex: 'AssessmentNo',
                                                    text: 'AssessmentNo'
                                                },
                                                {
                                                    xtype: 'gridcolumn',
                                                    width: 150,
                                                    dataIndex: 'CountryCode',
                                                    text: 'आय स्रोतको मुलुक',
                                                    editor: {
                                                        xtype: 'combobox',
                                                        itemId: 'ddlFTCCCountryCode',
                                                        width: 150,
                                                        displayField: 'CountryName',
                                                        store: 'CountryStore',
                                                        valueField: 'CountryCode'
                                                    }
                                                },
                                                {
                                                    xtype: 'gridcolumn',
                                                    width: 265,
                                                    dataIndex: 'FtcRemPreviousFy',
                                                    text: 'गत आयबर्ष सम्मको मिलान गर्न बांकी विदेशमा तिरेको कर ',
                                                    editor: {
                                                        xtype: 'textfield',
                                                        validator: function(value) {
                                                            return /^[0-9]{0,254}\.{0,1}[0-9]{0,2}$/.test(value)? true : 'कृपया दुईदशमलव विन्दु सम्म भर्नुहोस्!!!';
                                                        },
                                                        itemId: 'txtFtcRemPreviousFy',
                                                        enableKeyEvents: true,
                                                        maskRe: /[0-9.]/
                                                    }
                                                },
                                                {
                                                    xtype: 'gridcolumn',
                                                    width: 165,
                                                    dataIndex: 'FtcPaidCurrentFy',
                                                    text: 'यस आयबर्षमा विदेशमा तिरेको कर ',
                                                    editor: {
                                                        xtype: 'textfield',
                                                        validator: function(value) {
                                                            return /^[0-9]{0,254}\.{0,1}[0-9]{0,2}$/.test(value)? true : 'कृपया दुईदशमलव विन्दु सम्म भर्नुहोस्!!!';
                                                        },
                                                        itemId: 'txtFtcPaidCurrentFy',
                                                        enableKeyEvents: true,
                                                        maskRe: /[0-9.]/
                                                    }
                                                },
                                                {
                                                    xtype: 'gridcolumn',
                                                    width: 145,
                                                    dataIndex: 'FtcUsedCurrentFy',
                                                    text: 'यस आयबर्षमा विदेशी कर दावी',
                                                    editor: {
                                                        xtype: 'textfield',
                                                        validator: function(value) {
                                                            return /^[0-9]{0,254}\.{0,1}[0-9]{0,2}$/.test(value)? true : 'कृपया दुईदशमलव विन्दु सम्म भर्नुहोस्!!!';
                                                        },
                                                        itemId: 'txtFtcUsedCurrentFy',
                                                        enableKeyEvents: true,
                                                        maskRe: /[0-9.]/
                                                    }
                                                },
                                                {
                                                    xtype: 'gridcolumn',
                                                    hidden: true,
                                                    dataIndex: 'RecordStatus',
                                                    text: 'RecordStatus'
                                                },
                                                {
                                                    xtype: 'gridcolumn',
                                                    hidden: true,
                                                    dataIndex: 'Terminal',
                                                    text: 'Terminal'
                                                },
                                                {
                                                    xtype: 'gridcolumn',
                                                    hidden: true,
                                                    dataIndex: 'TranDate',
                                                    text: 'TranDate'
                                                },
                                                {
                                                    xtype: 'gridcolumn',
                                                    hidden: true,
                                                    dataIndex: 'UserName',
                                                    text: 'UserName'
                                                },
                                                {
                                                    xtype: 'gridcolumn',
                                                    hidden: true,
                                                    dataIndex: 'Action',
                                                    text: 'Action'
                                                },
                                                {
                                                    xtype: 'actioncolumn',
                                                    items: [
                                                        {
                                                            handler: function(view, rowIndex, colIndex, item, e) {
                                                                /*
                                                                var store = Ext.getStore('DCTBForeignTaxDetails');
                                                                var grd = Ext.ComponentQuery.query('#grdForeignTaxCreditClaimDetail')[0];
                                                                var row = store.getAt(rowIndex).data;

                                                                Ext.Msg.confirm('Confirm Action', 'Do you want to Remove ?', function(btn) {
                                                                if(btn == 'yes'){
                                                                if(row.Action === "E")
                                                                {    
                                                                row.Action = "D";
                                                                grd.bindStore(store);         
                                                                store.filter(function(item){
                                                                return item.get("Action")!= 'D';
                                                                });
                                                                }
                                                                else
                                                                {

                                                                store.removeAt(rowIndex);
                                                                }


                                                                return true;
                                                                }
                                                                }, this);  


                                                                Ext.MessageBox.confirm('Alert',"Are you sure want to remove it from Details list? ",function(btn){
                                                                if(btn==='yes')
                                                                {

                                                                var TotalSumFtcRemPreviousFyAmt = Ext.ComponentQuery.query('#txtSumFtcRemPreviousFy')[0];
                                                                var TotalSumFtcPaidCurrentFyAmt = Ext.ComponentQuery.query('#txtSumFtcPaidCurrentFy')[0];
                                                                var TotalSumFtcUsedCurrentFyAmt = Ext.ComponentQuery.query('#txtSumFtcUsedCurrentFy')[0];
                                                                var str = Ext.getStore('DCTBForeignTaxDetails');
                                                                var record = str.data.items[rowIndex].data; 

                                                                if(record.Action === "A"||record.Action === "E")
                                                                {

                                                                TotalSumFtcRemPreviousFyAmt.setValue(Number(TotalSumFtcRemPreviousFyAmt.getValue())- Number(record.FtcRemPreviousFy));
                                                                TotalSumFtcPaidCurrentFyAmt.setValue(Number(TotalSumFtcPaidCurrentFyAmt.getValue())- Number(record.FtcPaidCurrentFy));
                                                                TotalSumFtcUsedCurrentFyAmt.setValue(Number(TotalSumFtcUsedCurrentFyAmt.getValue())- Number(record.FtcUsedCurrentFy));

                                                                str.removeAt(rowIndex);

                                                                }
                                                                else
                                                                { 

                                                                record.Action="D";
                                                                str.filter(function(item){
                                                                return item.get('Action')!='D';

                                                                });
                                                                }
                                                                Ext.ComponentQuery.query('#grdForeignTaxCreditClaimDetail')[0].bindStore(str);

                                                                }

                                                                });
                                                                */

                                                                var store = Ext.getStore('DCTBForeignTaxDetails');
                                                                var grd =  Ext.ComponentQuery.query('#grdForeignTaxCreditClaimDetail')[0];
                                                                var row = store.getAt(rowIndex).data;

                                                                var finAmount1 = Ext.ComponentQuery.query('#txtSumFtcRemPreviousFy')[0];
                                                                var finAmount2 = Ext.ComponentQuery.query('#txtSumFtcPaidCurrentFy')[0];
                                                                var finAmount3 = Ext.ComponentQuery.query('#txtSumFtcUsedCurrentFy')[0];

                                                                var totAmount1 = (row.FtcRemPreviousFy === "")?0:row.FtcRemPreviousFy;
                                                                var totAmount2 = (row.FtcPaidCurrentFy === "")?0:row.FtcPaidCurrentFy;
                                                                var totAmount3 = (row.FtcUsedCurrentFy === "")?0:row.FtcUsedCurrentFy;
                                                                var overallTot1 = "";
                                                                var overallTot2 = "";
                                                                var overallTot3 = "";

                                                                Ext.Msg.confirm('Confirm Action', 'Do you want to Remove ?', function(btn) {
                                                                    if(btn == 'yes'){

                                                                        overallTot1 = parseFloat(finAmount1.getValue())- parseFloat(totAmount1);        
                                                                        finAmount1.setValue(overallTot1);
                                                                        overallTot2 = parseFloat(finAmount2.getValue())- parseFloat(totAmount2);        
                                                                        finAmount2.setValue(overallTot2);
                                                                        overallTot3 = parseFloat(finAmount3.getValue())- parseFloat(totAmount3);        
                                                                        finAmount3.setValue(overallTot3);

                                                                        if(row.Action === "E")
                                                                        {    
                                                                            row.Action = "D";
                                                                            grd.bindStore(store);         
                                                                            store.filter(function(item){
                                                                                return item.get("Action")!= 'D';
                                                                            });
                                                                        }
                                                                        else
                                                                        {
                                                                            store.removeAt(rowIndex);
                                                                        }

                                                                        return true;
                                                                    }
                                                                }, this);





















                                                            },
                                                            icon: '../ITS/resources/images/icons/cancel.png',
                                                            iconCls: ''
                                                        }
                                                    ]
                                                }
                                            ],
                                            plugins: [
                                                Ext.create('Ext.grid.plugin.RowEditing', {
                                                    ptype: 'rowediting',
                                                    pluginId: 'plugingrdForeignTaxCreditClaimDetail',
                                                    listeners: {
                                                        canceledit: {
                                                            fn: me.onGridroweditingpluginCanceledit,
                                                            scope: me
                                                        },
                                                        edit: {
                                                            fn: me.onGridroweditingpluginEdit,
                                                            scope: me
                                                        },
                                                        validateedit: {
                                                            fn: me.onGridroweditingpluginValidateedit,
                                                            scope: me
                                                        }
                                                    }
                                                })
                                            ]
                                        },
                                        {
                                            xtype: 'toolbar',
                                            items: [
                                                {
                                                    xtype: 'label',
                                                    width: 200,
                                                    text: 'जम्मा रकम :'
                                                },
                                                {
                                                    xtype: 'textfield',
                                                    itemId: 'txtSumFtcRemPreviousFy',
                                                    width: 200,
                                                    readOnly: true,
                                                    fieldLabel: 'जम्मा '
                                                },
                                                {
                                                    xtype: 'textfield',
                                                    itemId: 'txtSumFtcPaidCurrentFy',
                                                    width: 200,
                                                    readOnly: true,
                                                    fieldLabel: 'जम्मा '
                                                },
                                                {
                                                    xtype: 'textfield',
                                                    itemId: 'txtSumFtcUsedCurrentFy',
                                                    width: 200,
                                                    readOnly: true,
                                                    fieldLabel: 'जम्मा '
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            xtype: 'container',
                            frame: true,
                            itemId: 'cntFTCC_button',
                            style: 'text-align:right;',
                            items: [
                                {
                                    xtype: 'button',
                                    itemId: 'btnFTCC_Save',
                                    margin: '10 5',
                                    iconCls: 'icon-save',
                                    text: 'Save'
                                },
                                {
                                    xtype: 'button',
                                    itemId: 'btnFTCC_submit',
                                    margin: '10 5',
                                    iconCls: 'icon-ok',
                                    text: 'Submit'
                                },
                                {
                                    xtype: 'button',
                                    itemId: 'btnFTCC_Edit',
                                    margin: '10 5',
                                    iconCls: 'icon-edit',
                                    text: 'Edit'
                                },
                                {
                                    xtype: 'button',
                                    hidden: true,
                                    itemId: 'btnFTCC_Print',
                                    margin: '10 5',
                                    iconCls: 'icon-print',
                                    text: 'Print'
                                },
                                {
                                    xtype: 'button',
                                    hidden: true,
                                    itemId: 'btnFTCC_Verify',
                                    margin: '10 5',
                                    text: 'Verify'
                                },
                                {
                                    xtype: 'button',
                                    itemId: 'btnFTCC_Delete',
                                    margin: '10 5',
                                    iconCls: 'icon-delete',
                                    text: 'Delete'
                                },
                                {
                                    xtype: 'button',
                                    itemId: 'btnFTCC_Cancel',
                                    margin: '10 5',
                                    iconCls: 'icon-cancel',
                                    text: 'Cancel'
                                }
                            ]
                        },
                        {
                            xtype: 'hiddenfield',
                            itemId: 'hdnFTCC_Office_Code',
                            fieldLabel: ''
                        },
                        {
                            xtype: 'hiddenfield',
                            itemId: 'hdnFTCC_Action',
                            fieldLabel: 'Label'
                        },
                        {
                            xtype: 'hiddenfield',
                            anchor: '100%',
                            itemId: 'hdnFTCCTranNo',
                            fieldLabel: 'Label'
                        },
                        {
                            xtype: 'hiddenfield',
                            anchor: '100%',
                            itemId: 'ForeignTaxCreditClaimLoginOffice',
                            fieldLabel: 'Label'
                        }
                    ],
                    listeners: {
                        afterrender: {
                            fn: me.onFrm_ForeignTaxCreditClaimAfterRender,
                            scope: me
                        }
                    }
                }
            ]
        });

        me.callParent(arguments);
    },

    onTxtFTCC_ClainDateBlur: function(field, options) {
        return validateFutureDate(field.getValue(),"Y",function(){field.focus();});
    },

    onGridroweditingpluginCanceledit: function(grid, options) {
        /*
        grid.store.removeAt(grid.rowIdx);
        var btn_AddFTCCDetail= Ext.ComponentQuery.query('#btn_AddFTCCDetail')[0];
        btn_AddFTCCDetail.enable(true);


        var TotalSumFtcRemPreviousFyAmt = Ext.ComponentQuery.query('#txtSumFtcRemPreviousFy')[0];
        var TotalSumFtcPaidCurrentFyAmt = Ext.ComponentQuery.query('#txtSumFtcPaidCurrentFy')[0];
        var TotalSumFtcUsedCurrentFyAmt = Ext.ComponentQuery.query('#txtSumFtcUsedCurrentFy')[0];

        var str = Ext.getStore('DCTBForeignTaxDetails');
        var record = str.data.items[e.rowIdx].data;
        if(record.Action === "A"||record.Action === "E")
        {
        TotalSumFtcRemPreviousFyAmt.setValue(Number(TotalSumFtcRemPreviousFyAmt.getValue())- Number(record.FtcRemPreviousFy));
        TotalSumFtcPaidCurrentFyAmt.setValue(Number(TotalSumFtcPaidCurrentFyAmt.getValue())- Number(record.FtcPaidCurrentFy));
        TotalSumFtcUsedCurrentFyAmt.setValue(Number(TotalSumFtcUsedCurrentFyAmt.getValue())- Number(record.FtcUsedCurrentFy));
        var TempSumFtcRemPreviousFyAmtGrandTotal = 0;
        var TempSumFtcPaidCurrentFyAmtGrandTotal = 0;
        var TempSumFtcUsedCurrentFyAmtGrandTotal = 0;

        if(TotalSumFtcRemPreviousFyAmt.getValue()!== '')
        {
        TempSumFtcRemPreviousFyAmtGrandTotal = TotalSumFtcRemPreviousFyAmt.getValue();       
        }

        if(TotalSumFtcPaidCurrentFyAmt.getValue()!== '')
        {
        TempSumFtcPaidCurrentFyAmtGrandTotal = TotalSumFtcPaidCurrentFyAmt.getValue();       
        }
        if(TotalSumFtcUsedCurrentFyAmt.getValue()!== '')
        {
        TempSumFtcUsedCurrentFyAmtGrandTotal = TotalSumFtcUsedCurrentFyAmt.getValue();       
        }

        TotalSumFtcRemPreviousFyAmt.setValue(TempSumFtcRemPreviousFyAmtGrandTotal.toFixed(2));
        TotalSumFtcPaidCurrentFyAmt.setValue(TempSumFtcPaidCurrentFyAmtGrandTotal.toFixed(2));
        TotalSumFtcUsedCurrentFyAmt.setValue(TempSumFtcUsedCurrentFyAmtGrandTotal.toFixed(2));
        }

        Ext.getStore('DCTBForeignTaxDetails').removeAt(e.rowIdx);

        var ddlFTCCCountryCode = Ext.ComponentQuery.query("#ddlFTCCCountryCode")[0];
        var fpVal = ddlFTCCCountryCode.getValue();

        if(fpVal === null)
        {
        grid.store.removeAt(grid.rowIdx);
        }
        */

        //grid.store.removeAt(grid.rowIdx);
        var btn_AddFTCCDetail= Ext.ComponentQuery.query('#btn_AddFTCCDetail')[0];
        btn_AddFTCCDetail.enable(true);











    },

    onGridroweditingpluginEdit: function(editor, e, options) {
        editor.newValues.FtcRemPreviousFy = editor.newValues.FtcRemPreviousFy === ""?null:editor.newValues.FtcRemPreviousFy;
        editor.newValues.MedicalExpAmt = editor.newValues.FtcPaidCurrentFy === ""?null:editor.newValues.FtcPaidCurrentFy;
        editor.newValues.MedicalExpAmt = editor.newValues.FtcUsedCurrentFy === ""?null:editor.newValues.FtcUsedCurrentFy;
    },

    onGridroweditingpluginValidateedit: function(editor, e, options) {
        var count=0;
        var message="";
        var valid=true;
        var me = this;
        var errorMsg = "";

        var btn_AddFTCCDetail = Ext.ComponentQuery.query('#btn_AddFTCCDetail')[0];

        var ddlFTCCCountryCode   = Ext.ComponentQuery.query('#ddlFTCCCountryCode')[0].getValue();
        var txtFtcRemPreviousFy = Ext.ComponentQuery.query('#txtFtcRemPreviousFy')[0].getValue();
        var txtFtcPaidCurrentFy = Ext.ComponentQuery.query('#txtFtcPaidCurrentFy')[0].getValue();
        var txtFtcUsedCurrentFy = Ext.ComponentQuery.query('#txtFtcUsedCurrentFy')[0].getValue();


        if(ddlFTCCCountryCode === "" || ddlFTCCCountryCode === null)
        {

            count++;
            errorMsg = errorMsg +'<br/>'+ count + ") कृपया आय स्रोतको मुलुक छान्नुहोस् !!! ";
            btn_AddFTCCDetail.disable(true);

        }

        if(txtFtcRemPreviousFy === "" || txtFtcRemPreviousFy === null)
        {

            count++;
            errorMsg = errorMsg +'<br/>'+ count + ") कृपया गत आयबर्ष सम्मको मिलान गर्न बांकी विदेशमा तिरेको कर भर्नुहोस् !!! ";
            btn_AddFTCCDetail.disable(true);

        }

        if(txtFtcPaidCurrentFy === "" || txtFtcPaidCurrentFy === null)
        {

            count++;
            errorMsg = errorMsg +'<br/>'+ count + ")  कृपया यस आयबर्षमा विदेशमा तिरेको कर भर्नुहोस् !!!";
            btn_AddFTCCDetail.disable(true);

        }


        if(txtFtcUsedCurrentFy === "" || txtFtcUsedCurrentFy === null)
        {

            count++;
            errorMsg = errorMsg +'<br/>'+ count + ")कृपया यस आयबर्षमा विदेशी कर दावी भर्नुहोस् !!! ";
            btn_AddFTCCDetail.disable(true);

        }
        else
        {
            btn_AddFTCCDetail.enable(true);
        }


        if(count >0)
        {
            msg("WARNING",errorMsg);
            return false;
        }

    },

    onFrm_ForeignTaxCreditClaimAfterRender: function(abstractcomponent, options) {
        var offCode=Ext.get('offCode').dom.innerHTML;
        Ext.ComponentQuery.query('#ForeignTaxCreditClaimLoginOffice')[0].setValue(offCode);
    }

});