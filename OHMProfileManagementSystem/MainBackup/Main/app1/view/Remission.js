/*
 * File: app/view/Remission.js
 *
 * This file was generated by Sencha Architect version 2.2.3.
 * http://www.sencha.com/products/architect/
 *
 * This file requires use of the Ext JS 4.1.x library, under independent license.
 * License of Sencha Architect does not include license for Ext JS 4.1.x. For more
 * details see http://www.sencha.com/license or contact license@sencha.com.
 *
 * This file will be auto-generated each and everytime you save your project.
 *
 * Do NOT hand edit this file.
 */

Ext.define('MyApp.view.Remission', {
    extend: 'Ext.panel.Panel',

    frame: true,
    height: 1000,
    id: '',
    itemId: 'pnlRemission',
    layout: {
        align: 'stretch',
        type: 'vbox'
    },
    bodyPadding: 10,
    title: 'Remission',

    initComponent: function() {
        var me = this;

        Ext.applyIf(me, {
            items: [
                {
                    xtype: 'form',
                    flex: 1,
                    frame: true,
                    height: 950,
                    itemId: 'frm_Remission',
                    margin: 5,
                    autoScroll: true,
                    bodyPadding: 10,
                    items: [
                        {
                            xtype: 'container',
                            frame: true,
                            height: 110,
                            itemId: 'cntHeaderRemission',
                            margin: '0 0 5 0',
                            layout: {
                                align: 'stretch',
                                type: 'vbox'
                            },
                            items: [
                                {
                                    xtype: 'container',
                                    flex: 1,
                                    height: 30,
                                    maxHeight: 30,
                                    layout: {
                                        type: 'table'
                                    },
                                    items: [
                                        {
                                            xtype: 'displayfield',
                                            height: 25,
                                            itemId: 'hdnlblRemissionAction',
                                            maxHeight: 25,
                                            width: 196,
                                            fieldLabel: '',
                                            fieldStyle: '{color:red;}'
                                        }
                                    ]
                                },
                                {
                                    xtype: 'label',
                                    flex: 1,
                                    height: 40,
                                    margin: '10 0 0 10',
                                    maxHeight: 40,
                                    minHeight: 40,
                                    style: 'font-size:20px;\r\n\r\n\r\ntext-align:center;',
                                    text: ' कर मिनाहा विवरण(कर मिनाहाको लागि कर अधिकृतले भर्ने)'
                                },
                                {
                                    xtype: 'container',
                                    height: 25,
                                    layout: {
                                        align: 'stretch',
                                        type: 'hbox'
                                    },
                                    items: [
                                        {
                                            xtype: 'displayfield',
                                            flex: 1,
                                            itemId: 'Remission_IROName',
                                            width: 400,
                                            fieldLabel: 'आन्तरिक राजस्व कार्यालयको नाम',
                                            labelSeparator: ' ',
                                            labelWidth: 180
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            xtype: 'form',
                            frame: true,
                            height: 350,
                            margin: '0 0 5 0',
                            layout: {
                                columns: 6,
                                type: 'table'
                            },
                            bodyPadding: 10,
                            collapseFirst: false,
                            title: '१ करदाता सम्बन्धी विवरण',
                            items: [
                                {
                                    xtype: 'container',
                                    cls: 'extTbl',
                                    layout: {
                                        columns: 6,
                                        type: 'table'
                                    },
                                    items: [
                                        {
                                            xtype: 'textfield',
                                            colspan: 3,
                                            itemId: 'txtRemission_PanNo',
                                            margin: '5px 0 0 0',
                                            fieldLabel: 'स्था . ले . नं . ',
                                            labelWidth: 80,
                                            allowBlank: false,
                                            emptyText: '',
                                            enableKeyEvents: true,
                                            enforceMaxLength: true,
                                            maskRe: /[0-9]/,
                                            maxLength: 9,
                                            minLength: 9,
                                            size: 9
                                        },
                                        {
                                            xtype: 'textfield',
                                            colspan: 3,
                                            itemId: 'txtRemission_AccType',
                                            margin: '5px 0 0 0',
                                            width: 150,
                                            fieldLabel: 'खाताको किसिम',
                                            readOnly: true,
                                            allowBlank: false,
                                            enforceMaxLength: true,
                                            maxLength: 2,
                                            minLength: 2,
                                            size: 2
                                        },
                                        {
                                            xtype: 'textfield',
                                            colspan: 6,
                                            itemId: 'txtRemission_Name',
                                            margin: '5px 0 0 0',
                                            width: 720,
                                            fieldLabel: 'नाम ',
                                            labelWidth: 80,
                                            readOnly: true
                                        },
                                        {
                                            xtype: 'label',
                                            colspan: 1,
                                            margin: '5px 0 0 0',
                                            style: 'margin-right:45px;',
                                            text: 'ठेगाना '
                                        },
                                        {
                                            xtype: 'label',
                                            margin: '5px 0 0 0',
                                            style: 'margin-right:30px;',
                                            text: 'घर नं .'
                                        },
                                        {
                                            xtype: 'label',
                                            margin: '5px 0 0 0',
                                            style: 'margin-right:30px;',
                                            text: 'वार्ड नं .'
                                        },
                                        {
                                            xtype: 'label',
                                            margin: '5px 0 0 0',
                                            style: 'margin-right:30px;',
                                            text: 'गांउ / टोल र बाटोको नाम'
                                        },
                                        {
                                            xtype: 'radiogroup',
                                            itemId: 'Remission_VDC',
                                            margin: '5px 0 0 0',
                                            width: 200,
                                            fieldLabel: '',
                                            columns: 2,
                                            items: [
                                                {
                                                    xtype: 'radiofield',
                                                    itemId: 'rdl_Remission_Metro_Mun',
                                                    readOnly: true,
                                                    boxLabel: 'म. न. पा.'
                                                },
                                                {
                                                    xtype: 'radiofield',
                                                    itemId: 'rdl_Remission_Sub_Metro_Mun',
                                                    readOnly: true,
                                                    boxLabel: 'उ. म. न. पा.'
                                                },
                                                {
                                                    xtype: 'radiofield',
                                                    itemId: 'rdl_Remission_Mun',
                                                    readOnly: true,
                                                    boxLabel: 'न. पा.'
                                                },
                                                {
                                                    xtype: 'radiofield',
                                                    itemId: 'rdl_Remission_VDC',
                                                    readOnly: true,
                                                    boxLabel: 'गा. वि. स.'
                                                }
                                            ]
                                        },
                                        {
                                            xtype: 'label',
                                            margin: '5px 0 0 0',
                                            style: 'margin-right:50px;',
                                            text: 'जिल्ला'
                                        },
                                        {
                                            xtype: 'textfield',
                                            colspan: 2,
                                            itemId: 'txtRemission_HouseNo',
                                            margin: '5 0 0 90',
                                            width: 50,
                                            readOnly: true
                                        },
                                        {
                                            xtype: 'textfield',
                                            itemId: 'txtRemission_WardNo',
                                            margin: '',
                                            width: 50,
                                            readOnly: true
                                        },
                                        {
                                            xtype: 'textfield',
                                            itemId: 'txtRemission_ToleName',
                                            margin: '',
                                            width: 140,
                                            readOnly: true
                                        },
                                        {
                                            xtype: 'textfield',
                                            itemId: 'txtRemission_VDCName',
                                            margin: '',
                                            width: 200,
                                            readOnly: true
                                        },
                                        {
                                            xtype: 'textfield',
                                            itemId: 'txtRemission_DistrictName',
                                            margin: '',
                                            width: 100,
                                            readOnly: true
                                        },
                                        {
                                            xtype: 'textfield',
                                            colspan: 2,
                                            itemId: 'txtRemission_Phone',
                                            margin: '5px 0 0 0',
                                            width: 150,
                                            fieldLabel: 'फोन ',
                                            labelWidth: 60,
                                            readOnly: true,
                                            enforceMaxLength: false
                                        },
                                        {
                                            xtype: 'textfield',
                                            colspan: 2,
                                            itemId: 'txtRemission_Mobile',
                                            margin: '5px 0 0 0',
                                            width: 207,
                                            fieldLabel: 'मोबाइल ',
                                            labelWidth: 62,
                                            readOnly: true
                                        },
                                        {
                                            xtype: 'textfield',
                                            colspan: 2,
                                            itemId: 'txtRemission_Email',
                                            margin: '5px 0 0 0',
                                            width: 340,
                                            fieldLabel: 'इमेल ',
                                            labelWidth: 60,
                                            readOnly: true
                                        },
                                        {
                                            xtype: 'displayfield',
                                            colspan: 6,
                                            itemId: 'Remission_TpOfficeType',
                                            width: 400,
                                            fieldLabel: 'करदाताको स्थिति '
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            xtype: 'form',
                            frame: true,
                            margin: '0 0 5 0',
                            layout: {
                                columns: 3,
                                type: 'table'
                            },
                            bodyPadding: 10,
                            collapseFirst: false,
                            title: '२ मिनाहा सम्वन्धी विवरण',
                            items: [
                                {
                                    xtype: 'container',
                                    colspan: 3,
                                    cls: 'extTbl',
                                    style: 'text-align:right;'
                                },
                                {
                                    xtype: 'textfield',
                                    colspan: 4,
                                    disabled: true,
                                    itemId: 'txtRemissionNumber',
                                    margin: '4px 0 0 0',
                                    fieldLabel: '१ मिनाहा न.',
                                    labelSeparator: ' ',
                                    labelWidth: 140,
                                    msgTarget: 'side',
                                    enableKeyEvents: true,
                                    enforceMaxLength: true,
                                    maskRe: /[0-9.]/,
                                    maxLength: 10,
                                    vtypeText: 'asdasd'
                                },
                                {
                                    xtype: 'textfield',
                                    colspan: 4,
                                    itemId: 'txtRemissionDate',
                                    margin: '4px 0 0 0',
                                    fieldLabel: '२ मिनाहा मिति',
                                    labelSeparator: ' ',
                                    labelWidth: 140,
                                    emptyText: 'YYYY.MM.DD',
                                    enforceMaxLength: true,
                                    maskRe: /[0-9.]/,
                                    maxLength: 10,
                                    minLength: 10,
                                    size: 10,
                                    listeners: {
                                        blur: {
                                            fn: me.onTxtRemissionDateBlur,
                                            scope: me
                                        }
                                    }
                                },
                                {
                                    xtype: 'textareafield',
                                    colspan: 4,
                                    itemId: 'txtRemissionReason',
                                    margin: '4px 0 0 0',
                                    fieldLabel: '३ मिनाहा गरेको कारण',
                                    labelWidth: 140,
                                    enforceMaxLength: true,
                                    maxLength: 300
                                },
                                {
                                    xtype: 'textareafield',
                                    itemId: 'txtRemissionAuthority',
                                    margin: '4px 0 0 0',
                                    fieldLabel: '४ मिनाहा गर्ने अख्तियारी',
                                    labelWidth: 140,
                                    enforceMaxLength: true,
                                    maxLength: 300
                                }
                            ]
                        },
                        {
                            xtype: 'form',
                            frame: true,
                            height: 350,
                            margin: '0 0 5 0',
                            layout: {
                                align: 'stretch',
                                type: 'vbox'
                            },
                            bodyPadding: 10,
                            collapseFirst: false,
                            title: '३ मिनाहाको विवरण',
                            items: [
                                {
                                    xtype: 'container',
                                    height: 20,
                                    padding: '',
                                    layout: {
                                        align: 'stretch',
                                        padding: '',
                                        type: 'hbox'
                                    },
                                    items: [
                                        {
                                            xtype: 'label',
                                            width: 50,
                                            text: ''
                                        },
                                        {
                                            xtype: 'label',
                                            margins: '',
                                            style: 'text-align:center;',
                                            width: 110,
                                            text: '१'
                                        },
                                        {
                                            xtype: 'label',
                                            style: 'text-align:center;',
                                            width: 110,
                                            text: '२'
                                        },
                                        {
                                            xtype: 'label',
                                            hidden: true,
                                            style: 'text-align:center;',
                                            width: 120,
                                            text: '३'
                                        },
                                        {
                                            xtype: 'label',
                                            style: 'text-align:center;',
                                            width: 300,
                                            text: '३'
                                        },
                                        {
                                            xtype: 'label',
                                            style: 'text-align:center;',
                                            width: 100,
                                            text: '४'
                                        }
                                    ]
                                },
                                {
                                    xtype: 'gridpanel',
                                    flex: 1,
                                    itemId: 'grdRemissionDetails',
                                    title: '',
                                    store: 'RemissionDetails',
                                    columns: [
                                        {
                                            xtype: 'rownumberer',
                                            width: 50,
                                            text: 'क्र . सं'
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            draggable: false,
                                            width: 110,
                                            sortable: false,
                                            dataIndex: 'FiscalYear',
                                            hideable: false,
                                            text: 'आय बर्ष',
                                            editor: {
                                                xtype: 'combobox',
                                                itemId: 'ddlRemissionFiscalYear',
                                                emptyText: '---छान्नुहोस् ---',
                                                displayField: 'fiscalYear',
                                                forceSelection: true,
                                                store: 'FiscalYear',
                                                typeAhead: true,
                                                valueField: 'fiscalYear'
                                            }
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            draggable: false,
                                            width: 300,
                                            sortable: false,
                                            dataIndex: 'RemissionOn',
                                            hideable: false,
                                            text: 'मिनाहा गरेको कारण(कर,शुल्क,व्याज,जरिवाना)',
                                            editor: {
                                                xtype: 'combobox',
                                                itemId: 'ddlRemissionOn',
                                                emptyText: '---छान्नुहोस् ---',
                                                displayField: 'RemissionOnName',
                                                forceSelection: true,
                                                queryMode: 'local',
                                                store: 'RemissionOn',
                                                typeAhead: true,
                                                valueField: 'RemissionOnID'
                                            }
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            draggable: false,
                                            width: 100,
                                            sortable: false,
                                            dataIndex: 'RemissionAmount',
                                            hideable: false,
                                            text: 'मिनाहा रकम',
                                            editor: {
                                                xtype: 'textfield',
                                                validator: function(value) {
                                                    return /^[0-9]{0,254}\.{0,1}[0-9]{0,2}$/.test(value)? true : 'कृपया दुईदशमलव विन्दु सम्म भर्नुहोस्!!!';
                                                },
                                                itemId: 'txtRemissionAmount',
                                                enforceMaxLength: true,
                                                maskRe: /[0-9.]/,
                                                maxLength: 17
                                            }
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            draggable: false,
                                            width: 100,
                                            sortable: false,
                                            dataIndex: 'RemissionDate',
                                            hideable: false,
                                            text: 'लागु हुने मिति',
                                            editor: {
                                                xtype: 'textfield',
                                                itemId: 'txtRemissionDate',
                                                emptyText: 'YYYY.MM.DD',
                                                maskRe: /[0-9.]/,
                                                listeners: {
                                                    blur: {
                                                        fn: me.onTxtRemissionDateBlur1,
                                                        scope: me
                                                    }
                                                }
                                            }
                                        },
                                        {
                                            xtype: 'gridcolumn',
                                            hidden: true,
                                            dataIndex: 'Action',
                                            text: 'Action'
                                        },
                                        {
                                            xtype: 'actioncolumn',
                                            align: 'center',
                                            items: [
                                                {
                                                    handler: function(view, rowIndex, colIndex, item, e) {
                                                        var hdnRemAct = Ext.ComponentQuery.query('#hdnRemAct')[0];
                                                        var hdnAction = Ext.ComponentQuery.query('#hdnRemission_Action')[0];
                                                        if(hdnRemAct.lastValue === "T" || hdnAction.lastValue === "D")
                                                        {
                                                            return false;
                                                        }
                                                        else
                                                        {
                                                            return true;
                                                        }



                                                        var store = Ext.getStore('RemissionDetails');
                                                        var grd =  Ext.ComponentQuery.query('#grdRemissionDetails')[0];
                                                        var row = store.getAt(rowIndex).data;

                                                        var finAmount = Ext.ComponentQuery.query('#txtTotalRemissionAmount')[0];
                                                        var totAmount = (row.RemissionAmount === "")?0:row.RemissionAmount;
                                                        var overallTot = "";

                                                        Ext.Msg.confirm('Confirm Action', 'Do you want to Remove ?', function(btn) {
                                                            if(btn == 'yes'){

                                                                overallTot = parseFloat(finAmount.getValue())- parseFloat(totAmount);        
                                                                finAmount.setValue(overallTot);

                                                                if(row.Action === "E")
                                                                {    
                                                                    row.Action = "D";
                                                                    grd.bindStore(store);         
                                                                    store.filter(function(item){
                                                                        return item.get("Action")!= 'D';
                                                                    });
                                                                }
                                                                else
                                                                {
                                                                    store.removeAt(rowIndex);
                                                                }

                                                                return true;
                                                            }
                                                        }, this);



                                                    },
                                                    icon: '../ITS/resources/images/icons/cancel.png'
                                                }
                                            ]
                                        }
                                    ],
                                    dockedItems: [
                                        {
                                            xtype: 'toolbar',
                                            dock: 'top',
                                            items: [
                                                {
                                                    xtype: 'button',
                                                    itemId: 'btnAddtxtRemissionDetail',
                                                    iconCls: 'icon-add',
                                                    text: 'Add'
                                                }
                                            ]
                                        },
                                        {
                                            xtype: 'toolbar',
                                            dock: 'bottom',
                                            items: [
                                                {
                                                    xtype: 'textfield',
                                                    margins: '',
                                                    itemId: 'txtTotalRemissionAmount',
                                                    margin: '0 0 0 180',
                                                    width: 200,
                                                    fieldLabel: 'जम्मा मिनाहा रू.',
                                                    labelWidth: 90,
                                                    readOnly: true
                                                }
                                            ]
                                        }
                                    ],
                                    plugins: [
                                        Ext.create('Ext.grid.plugin.RowEditing', {
                                            pluginId: 'plugIngrdRemissionDetails',
                                            listeners: {
                                                canceledit: {
                                                    fn: me.onGridroweditingpluginCanceledit,
                                                    scope: me
                                                },
                                                edit: {
                                                    fn: me.onGridroweditingpluginEdit,
                                                    scope: me
                                                },
                                                validateedit: {
                                                    fn: me.onGridroweditingpluginValidateedit,
                                                    scope: me
                                                },
                                                beforeedit: {
                                                    fn: me.onGridroweditingpluginBeforeEdit,
                                                    scope: me
                                                }
                                            }
                                        })
                                    ],
                                    listeners: {
                                        beforerender: {
                                            fn: me.onGrdRemissionDetailsBeforeRender,
                                            scope: me
                                        },
                                        afterrender: {
                                            fn: me.onGrdRemissionDetailsAfterRender,
                                            scope: me
                                        }
                                    }
                                }
                            ]
                        },
                        {
                            xtype: 'form',
                            frame: true,
                            margin: '0 0 5 0',
                            layout: {
                                columns: 3,
                                type: 'table'
                            },
                            bodyPadding: 10,
                            collapseFirst: false,
                            title: '४ कार्यालय प्रयोजनकोलागि',
                            items: [
                                {
                                    xtype: 'container',
                                    colspan: 3,
                                    cls: 'extTbl',
                                    style: 'text-align:right;'
                                },
                                {
                                    xtype: 'label',
                                    margin: '0 20px 0 0',
                                    text: '१ '
                                },
                                {
                                    xtype: 'textfield',
                                    colspan: 2,
                                    itemId: 'txtRemissionOfficerName',
                                    margin: '4px 0 0 0',
                                    width: 800,
                                    fieldLabel: 'आदेश दिने अधिकृतको नाम',
                                    labelSeparator: ' ',
                                    labelWidth: 600,
                                    msgTarget: 'side',
                                    enforceMaxLength: true,
                                    maxLength: 120,
                                    vtypeText: 'asdasd'
                                },
                                {
                                    xtype: 'label',
                                    margin: '0 20px 0 0',
                                    text: '२'
                                },
                                {
                                    xtype: 'textfield',
                                    colspan: 2,
                                    itemId: 'txtRemissionOfficerCode',
                                    margin: '4px 0 0 0',
                                    width: 800,
                                    fieldLabel: 'आदेश दिने अधिकृतको कोड',
                                    labelSeparator: ' ',
                                    labelWidth: 600,
                                    enforceMaxLength: true,
                                    maxLength: 5
                                },
                                {
                                    xtype: 'label',
                                    margin: '0 20px 0 0',
                                    text: '३'
                                },
                                {
                                    xtype: 'textfield',
                                    colspan: 2,
                                    itemId: 'txtRemissionOrderDate',
                                    margin: '4px 0 0 0',
                                    width: 800,
                                    fieldLabel: 'आदेश मिति',
                                    labelSeparator: ' ',
                                    labelWidth: 600,
                                    emptyText: 'YYYY.MM.DD',
                                    enforceMaxLength: true,
                                    maskRe: /[0-9.]/,
                                    maxLength: 10,
                                    minLength: 10,
                                    listeners: {
                                        blur: {
                                            fn: me.onTxtRemissionOrderDateBlur,
                                            scope: me
                                        }
                                    }
                                }
                            ]
                        },
                        {
                            xtype: 'container',
                            frame: true,
                            itemId: 'cntEst_Ret_button',
                            style: 'text-align:right;',
                            items: [
                                {
                                    xtype: 'button',
                                    itemId: 'btn_Remission_Save',
                                    margin: '10 5',
                                    iconCls: 'icon-save',
                                    text: 'Save'
                                },
                                {
                                    xtype: 'button',
                                    itemId: 'btn_Remission_Edit',
                                    margin: '10 5',
                                    iconCls: 'icon-edit',
                                    text: 'Edit'
                                },
                                {
                                    xtype: 'button',
                                    itemId: 'btn_Remission_Delete',
                                    margin: '10 5',
                                    iconCls: 'icon-delete',
                                    text: 'Delete'
                                },
                                {
                                    xtype: 'button',
                                    itemId: 'btn_Remission_submit',
                                    margin: '10 5',
                                    iconCls: 'icon-ok',
                                    text: 'Submit'
                                },
                                {
                                    xtype: 'button',
                                    itemId: 'btn_Remission_Cancel',
                                    margin: '10 5',
                                    iconCls: 'icon-cancel',
                                    text: 'Cancel'
                                },
                                {
                                    xtype: 'button',
                                    disabled: true,
                                    itemId: 'btn_Remission_Back',
                                    iconCls: 'icon-back',
                                    text: 'Back'
                                }
                            ]
                        },
                        {
                            xtype: 'hiddenfield',
                            itemId: 'hdn_Remission_Office_Code',
                            fieldLabel: ''
                        },
                        {
                            xtype: 'hiddenfield',
                            itemId: 'hdnRemission_Action',
                            fieldLabel: 'Label'
                        },
                        {
                            xtype: 'hiddenfield',
                            anchor: '100%',
                            itemId: 'hdnRemissionTranNo',
                            fieldLabel: 'Label'
                        },
                        {
                            xtype: 'hiddenfield',
                            anchor: '100%',
                            itemId: 'hdnRemissionFilingDate',
                            fieldLabel: 'Label'
                        },
                        {
                            xtype: 'hiddenfield',
                            anchor: '100%',
                            itemId: 'RemissionLoginOffcode',
                            fieldLabel: 'Label'
                        },
                        {
                            xtype: 'hiddenfield',
                            anchor: '100%',
                            itemId: 'hdnRemAct',
                            fieldLabel: 'Label'
                        }
                    ]
                }
            ]
        });

        me.callParent(arguments);
    },

    onTxtRemissionDateBlur: function(component, e, eOpts) {
        return validateFutureDate(field.getValue(),"Y",function(){field.focus();});
    },

    onTxtRemissionDateBlur1: function(component, e, eOpts) {
        return validateFutureDate(field.getValue(),"N",function(){field.focus();});
    },

    onGridroweditingpluginCanceledit: function(editor, e, eOpts) {
        /*
        var btnAddtxtRemissionDetail= Ext.ComponentQuery.query('#btnAddtxtRemissionDetail')[0];
        btnAddtxtRemissionDetail.enable(true);


        var ddlRemissionFiscalYear = Ext.ComponentQuery.query("#ddlRemissionFiscalYear")[0];
        var fpVal = ddlRemissionFiscalYear.getValue();

        if(fpVal === null)
        {
        grid.store.removeAt(grid.rowIdx);
        }
        */
        //grid.store.removeAt(grid.rowIdx);
        var btnAddtxtRemissionDetail= Ext.ComponentQuery.query('#btnAddtxtRemissionDetail')[0];
        btnAddtxtRemissionDetail.enable(true);
    },

    onGridroweditingpluginEdit: function(editor, e, eOpts) {
        editor.newValues.RemissionAmount = editor.newValues.RemissionAmount === ""?null:editor.newValues.RemissionAmount;
    },

    onGridroweditingpluginValidateedit: function(editor, e, eOpts) {
        var count = 0;
        var message = "";
        var valid = true;
        var me = this;
        var errorMsg = "";

        // आय वर्ष  मिनहा गरेको कारण(कर,शुल्क,ब्याज)  मिनहा रकम  लागु हुने मिति

        var btnAddtxtRemissionDetail = Ext.ComponentQuery.query('#btnAddtxtRemissionDetail')[0];
        var ddlRemissionFiscalYear   = Ext.ComponentQuery.query('#ddlRemissionFiscalYear')[0].getValue();
        var ddlRemissionOn = Ext.ComponentQuery.query('#ddlRemissionOn')[0].getValue();
        var txtRemissionAmount = Ext.ComponentQuery.query('#txtRemissionAmount')[0].getValue();
        var txtRemissionDate = Ext.ComponentQuery.query('#txtRemissionDate')[0].getValue();


        if(ddlRemissionFiscalYear === "" || ddlRemissionFiscalYear === null)
        {

            count++;
            errorMsg = errorMsg +'<br/>'+ count + ") कृपया आय बर्ष छान्नुहोस् !!! ";
            btnAddtxtRemissionDetail.disable(true);

        }

        if(ddlRemissionOn === "" || ddlRemissionOn === null)
        {

            count++;
            errorMsg = errorMsg +'<br/>'+ count + ") कृपया  मिनाहा गरेको कारण(कर,शुल्क,ब्याज,जरिवाना) छान्नुहोस् !!!";
            btnAddtxtRemissionDetail.disable(true);

        }


        if(txtRemissionAmount === "" || txtRemissionAmount === "")
        {

            count++;
            errorMsg = errorMsg +'<br/>'+ count + ") कृपया मिनाहा रकम भर्नुहोस् !!!";
            btnAddtxtRemissionDetail.disable(true);

        }



        if(txtRemissionDate  === "" || txtRemissionDate  === null)
        {

            count++;
            errorMsg = errorMsg +'<br/>'+ count + ") कृपया लागु हुने मिति भर्नुहोस् !!! ";
            btnAddtxtRemissionDetail.disable(true);

        }
        else
        {
            btnAddtxtRemissionDetail.enable(true);
        }


        if(count >0)
        {
            msg("WARNING",errorMsg);
            return false;
        }

    },

    onGridroweditingpluginBeforeEdit: function(editor, e, eOpts) {
        var hdnRemAct = Ext.ComponentQuery.query('#hdnRemAct')[0];
        var hdnAction = Ext.ComponentQuery.query('#hdnRemission_Action')[0];
        if(hdnRemAct.lastValue === "T" || hdnAction.lastValue === "D")
        {
            return false;
        }
        else
        {
            return true;
        }
    },

    onGrdRemissionDetailsBeforeRender: function(component, eOpts) {
        var grid = Ext.ComponentQuery.query('#grdRemissionDetails')[0];


        grid.columns[1].renderer = function(value, metaData, record, rowIndex, colIndex, store, view) {
            var temp="";    

            var items = Ext.getStore('FiscalYear').data.items;

            for(var i=0;i<items.length;i++)
            {        
                if(items[i].data.fiscalYear == value)
                {           
                    temp=items[i].data.fiscalYear;
                    break;
                }        
            }

            return temp;



        };


        grid.columns[2].renderer = function(value, metaData, record, rowIndex, colIndex, store, view) {
            var temp="";    

            var items = Ext.getStore('RemissionOn').data.items;

            for(var i=0;i<items.length;i++)
            {        
                if(items[i].data.RemissionOnID == value)
                {           
                    temp=items[i].data.RemissionOnName;
                    break;
                }        
            }

            return temp;



        };
    },

    onGrdRemissionDetailsAfterRender: function(component, eOpts) {

        /*


        var Total = Ext.ComponentQuery.query('#txtTotalRemissionAmount')[0];
        Ext.ComponentQuery.query('#grdRemissionDetails')[0].getPlugin('plugIngrdRemissionDetails').on('canceledit',function(e){ 

        var TotalAmt = Ext.ComponentQuery.query('#txtTotalRemissionAmount')[0];
        var str = Ext.getStore('RemissionDetails');
        var record = str.data.items[e.rowIdx].data;
        if(record.Action==="A"||record.Action==="E")
        {
        TotalAmt.setValue(Number(TotalAmt.getValue())- Number(record.RemissionAmount));



        var TempGrandTotal=0;
        if(TotalAmt.getValue()!=='')
        {
        TempGrandTotal = TotalAmt.getValue();       
        }



        Total.setValue(TempGrandTotal.toFixed(2));
        }

        Ext.getStore('RemissionDetails').removeAt(e.rowIdx);
        });
        */

        /*
        Ext.ComponentQuery.query('#grdRemissionDetails')[0].on('beforeedit',function(editor,e){



        if(editor.record.data.Action==='')
        {
        Ext.MessageBox.alert('Warning',"You Can not edit this record");
        return false;
        }

        return true;

        });
        */
        /*

        Ext.ComponentQuery.query('#grdRemissionDetails')[0].on('validateedit',function(editor,e){

        //RemissionDetails
        var Total = Ext.ComponentQuery.query('#txtTotalRemissionAmount')[0];
        var TotalAmt = Total.getValue()!==''?Total.getValue():0;
        var index = e.rowIdx;
        var items = e.store.data.items;
        var newRecord = editor.context.newValues;
        var count = 0;
        var message = "";
        if(newRecord.RemissionAmount !== '')
        {

            if(isNaN(newRecord.RemissionAmount))
            {
                count++;
                message = message + count +")"+" मिनहा रकम गलत भयो!!!.<br/>" ;  
            }
            else
            {
                TotalAmt = Number(TotalAmt) + Number(newRecord.RemissionAmount);
                Total.setValue(TotalAmt);


            }
        }
        else
        {
            count++;
            message = message + count +")"+" कृपया मिनहा रकम भर्नुहोस्!!!<br/>" ;   

        }
        e.cancel = count>0;

        if(e.cancel)
        {
            Ext.MessageBox.alert('Warning',message);
        }
        else
        {
            items[index].data.Action = newRecord.Action === ''?'':'E';

        }

        //TotalAmt.setValue(Number(TotalAmt.getValue())- Number(record.RemissionAmount));

        //Total.setValue(Number(TotalAmt.getValue())- Number(record.RemissionAmount));


    });

    */
    },

    onTxtRemissionOrderDateBlur: function(component, e, eOpts) {
        return validateFutureDate(field.getValue(),"Y",function(){field.focus();});
    }

});